/*
** Copyright © 2017 Apple Inc.
** All rights reserved.
*/

function _itsdlogHasClientLogger(e){return window.its&&its.client&&its.client[e]&&typeof its.client[e]=="function"}function _itsdlogHasConsoleLogger(e){return window.console&&console[e]}function _itsdlogFunnel(e,t,n){t||(t="log");
if(_itsdlogHasClientLogger(t))return its.client[t](e,n);
if(_itsdlogHasConsoleLogger(t)&&!n)return console[t](e)}function itsdlog(e){return _itsdlogFunnel(e,"log")}function itsdinfo(e){return _itsdlogFunnel(e,"info")}function itsddebug(e){return _itsdlogFunnel(e,"debug")}function itsdslog(e,t){return _itsdlogFunnel(e,t,!0)}function itsdalert(e){return alert(e)}function bind(e,t){typeof t=="string"&&(t=e[t]);
var n=Array.prototype.slice,r=n.call(arguments,2);
return r.length>0?t.bind.apply(t,[e].concat(r)):t.bind(e)}function bindAsEventListener(e,t){typeof t=="string"&&(t=e[t]);
var n=Array.prototype.slice,r=n.call(arguments,2);
return function(i){return t.apply(e,[i].concat(r))}}function defer(e,t,n){return n||(n=0),setTimeout(bind(e,t),n)}function defined(e){return typeof window[e]!="undefined"}function getGlobalConst(e){return defined(e)?window[e]:null}function definedValue(e,t){return typeof e!="undefined"&&e!=null?e:t}function classNameForObject(e){if(e===null)return"null";
var t=typeof e;
if(t=="undefined")return"undefined";
if(t=="string"||e instanceof String)return"String";
if(t=="number"||e instanceof Number)return"Number";
if(e.constructor===Array)return"Array";
if(t=="object"||t=="function"){if(e.klassName)return e.klassName;
var n=e.toString();
n=="[object Object]"&&(n=e.constructor.toString());
if(n.indexOf("function ")===0)return n.replace("function ","").split("(")[0].toString();
if(n.indexOf("[object ")===0)return n.replace("[object ","").replace("]","");
if(n.indexOf("[object]")===0)return"object"}return"unknown"}function newElement(e,t,n){var e=document.createElement(e);
return t&&(typeof t=="string"?e.innerHTML=t:e.appendChild(t)),n&&(e.className=n),e}function ITSEvent(e,t){this.eventName=e,this.eventSource=t}function isDomNode(e){return typeof e=="object"&&e.nodeType===1&&e.cloneNode}function clone(e,t,n){var r=null;
if(e==null||typeof e!="object")r=e;
!r&&isDomNode(e)&&(r=e.cloneNode(t),n&&(e.id=its.x.uniquifyId(e.id)));
if(!r&&e instanceof Object){var i={};
for(var s in e)e.hasOwnProperty(s)&&(i[s]=t?clone(e[s]):e[s]);
r=i}if(!r&&e instanceof Array){var i=[];
e.each(function(e){i.push(t?clone(e):e)}),r=i}if(!r&&e instanceof Date){var i=new Date;
i.setTime(e.getTime()),r=i}if(!r&&e)throw new Error("Clone failed.");
return r}function ITSLogger(e){e||(e=ITSLogger.Defaults.loggerName),this._loggerName=e,ITSLogger.loggers||(ITSLogger.loggers={}),ITSLogger.loggers[e]=this}function ITSMetricsPageInfo(e,t,n,r){this.pageName=e,this.pageNameExtrasForBuyMetrics=t,this.channelName=n,this.location=r}function ITSPageMetricsUtil(){}function ITSLocationMetricsUtil(){}function ITSMetricsClickHandler(){}function Validation(e){this.initValidation(e)}function startLoadingButtonIndicator(e){var t=e.parentNode,n=t.querySelector("div.daisy-spinner");
n&&(e.style.color="rgba(0,0,0,0.5)",t.style.position="relative",n.style.display="block")}function birthMonthChange(){var e=document.getElementById("birthMonthPopup"),t=document.getElementById("birthDayPopup"),n=t.options[t.selectedIndex].innerHTML,r=[31,31,29,31,30,31,30,31,31,30,31,30,31][e.selectedIndex],i=t.options.length;
t.options.length=r+1;
for(var s=30;
s<=r;
s++)t.options[s]=t.options[1].cloneNode(),t.options[s].innerHTML=s,t.options[s].value=s-1;
n>r&&(t.selectedIndex=0)}function didChangeCreditCardType(e){e.shouldChangeOnBlur=!0;
if(e.nodeName!=="SELECT"){var t=e.paymentWasAutoSelected;
didBlurCreditCardType(e,t)}e.paymentWasAutoSelected=!1,document.querySelector("#carm-container")&&(e.id==="CBXX"?switchToCarmDetails():e.id==="NONE"?switchToNonePaymentType():switchToCreditCardDetails())}function didBlurCreditCardType(e,t){if(e.shouldChangeOnBlur){e.shouldChangeOnBlur=!1;
var n,r,i;
e.nodeName=="SELECT"?(n=e.selectedIndex,r=e.options[n],i=r.value,i=="WONoSelectionString"&&(i="NONE")):(r=e,i=e.getAttribute("input-value"));
var s=document.getElementById("MHCCEditorGeneric");
if(t!==!0){var o=s.querySelectorAll("input[type=text].clearoncardchange, input[type=password].clearoncardchange");
for(var u=0;
u<o.length;
u++)o[u].value="";
var a=s.querySelectorAll("select.clearoncardchange");
for(var u=0;
u<a.length;
u++)a[u]!=e&&(a[u].selectedIndex=0)}s.className=i,r.hasClassName("show-cvm")&&s.addClassName("show-cvm"),r.hasClassName("debit")&&s.addClassName("debit"),r.hasClassName("creditcard")&&s.addClassName("creditcard"),r.hasClassName("payservice")&&s.addClassName("payservice"),r.hasClassName("prepayservice")&&s.addClassName("prepayservice");
var f=document.querySelector("#nucaptcha");
f&&(i=="NONE"||i=="PEAS"?(f.removeClassName("hidden"),f.addClassName("visible")):(f.removeClassName("visible"),f.addClassName("hidden")))}}function switchToCarmDetails(){document.activeElement&&"INPUT"===document.activeElement.nodeName&&document.activeElement.blur(),document.querySelector("#credit-card-details").setAttribute("style","display: none"),document.querySelector("#credit-card-expiration").setAttribute("style","display: none"),["#expirationMonthField","#expirationYearField"].forEach(function(e){document.querySelector(e).removeClassName("required")});
var e=document.querySelector("#carm-container");
e&&e.setAttribute("style","display: block")}function switchToCreditCardDetails(){document.activeElement&&"INPUT"===document.activeElement.nodeName&&document.activeElement.blur();
var e=document.querySelector("#carm-container");
e&&(e.setAttribute("style","display:none"),document.querySelector("#optin-type")&&(document.querySelector("#optin-type").value="")),["#expirationMonthField","#expirationYearField"].forEach(function(e){document.querySelector(e).addClassName("required")}),["#div-mobile-phone-number"].forEach(function(e){document.querySelector(e).removeClassName("required")}),document.querySelector("#credit-card-details").setAttribute("style","display: block"),document.querySelector("#credit-card-expiration").setAttribute("style","display: block")}function switchToNonePaymentType(){document.activeElement&&"INPUT"===document.activeElement.nodeName&&document.activeElement.blur(),document.querySelector("#credit-card-details").setAttribute("style","display: none"),document.querySelector("#credit-card-expiration").setAttribute("style","display: none"),["#expirationMonthField","#expirationYearField","#div-mobile-phone-number"].forEach(function(e){document.querySelector(e).removeClassName("required")});
var e=document.querySelector("#carm-container");
e&&(e.setAttribute("style","display:none"),document.querySelector("#optin-type")&&(document.querySelector("#optin-type").value=""))}function disableButtons(){var e=document.querySelectorAll("input[type=submit].disabled");
e.length>0&&e.each(function(e){e.disabled=!0})}function ccNumberEdit(){var e=document.querySelector("#creditCardNumberField");
e&&(e.addEventListener("keydown",function(t){if(t.srcElement==e)try{t.keyCode!=13&&e.hasClassName("masked")&&(e.value="",e.removeClassName("masked"))}catch(n){}},!0),e.addEventListener("focus",function(t){e.select()},!0))}function taxIdEdit(){var e=document.querySelector("#taxId");
e&&(e.addEventListener("keydown",function(t){if(t.srcElement==e)try{t.keyCode!=13&&e.hasClassName("masked")&&(e.value="",e.removeClassName("masked"))}catch(n){}},!0),e.addEventListener("focus",function(t){e.select()},!0))}function FinMailManager(e,t,n,r,i){this._directActionUrl=e,this._message=t,this._sendButtonLabel=n,this._cancelButtonLabel=r,this._errorMessage=i}function isValidEmail(e){var t=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
return t.test(e)}function K2BuyButton(e,t,n){this.enabled=!0,this.selected=!1,this.highlighted=!1,this.position={x:0,y:0},this.size={width:0,height:0},this.model=n,this.isCMA=document.body.hasClassName("has-cma")&&n.parentByClassName("button-bar"),this.isFatBinary=n.hasClassName("fat-binary")&&!document.body.hasClassName("course"),this.lockup=this.model.parentByClassName("lockup"),this.buttonTitle=this.model.getAttribute("item-title");
try{this.adjacentList=this.lockup&&!this.model.parentByClassName("app-genius-box")?this.lockup.querySelector("ul"):null}catch(r){this.adjacentList=null,its.client.log(r)}this.type=e||K2BuyButtonTypeDefault,this.alignment=t||K2BuyButtonAlignmentLeft,this.createLayer(),this.titles=[],this.widths=[],this.firstSizing=!0,this.readyForDisplay=!1,this.firstTouch=!0;
if(this.type!=K2BuyButtonTypeNonPurchasable){if(defined("iTunes")&&iTunes.addEventListener)try{iTunes.addEventListener("closeButtons",bind(this,"closeButtonsEvent"),!1)}catch(r){its.client.log(r)}this.layer.addEventListener(K2StartEvent,this,!1),this.layer.addEventListener("webkitTransitionEnd",this,!1),this.layer.addEventListener("mouseup",this,!1),this.layer.addEventListener("click",this,!1)}this.isCMA&&(this.cmaLink=n.nextElementSibling,this.cmaLink.style.display="none")}function PKScrollView(e,t){this.layer=e,this.hostingLayer=t,this.size=new PKSize,this.contentOffset=new PKPoint,this.adjustedContentSize=new PKSize,this.contentSize=new PKSize,this.tracking=!1,this.dragging=!1,this.horizontalScrollEnabled=!0,this.verticalScrollEnabled=!0,this.decelerating=!1,this.decelerationTimer=null,this.pagingEnabled=!1,this.bounces=!0,this.showsHorizontalScrollIndicator=!0,this.showsVerticalScrollIndicator=!0,this.layer.addEventListener("webkitTransitionEnd",this,!1),this.hostingLayer.addEventListener("webkitTransitionEnd",this,!1),this.layer.addEventListener(PKStartEvent,this,!1),this.horizontalScrollIndicator=new PKScrollIndicator(PKScrollIndicatorTypeHorizontal),this.verticalScrollIndicator=new PKScrollIndicator(PKScrollIndicatorTypeVertical),this.layer.appendChild(this.horizontalScrollIndicator.layer),this.layer.appendChild(this.verticalScrollIndicator.layer),this.layer.hasAttribute("horizontalScrollEnabled")&&(this.horizontalScrollEnabled=this.layer.getAttribute("horizontalScrollEnabled")!="false"),this.layer.hasAttribute("verticalScrollEnabled")&&(this.verticalScrollEnabled=this.layer.getAttribute("verticalScrollEnabled")!="false"),this.layer.hasAttribute("showsVerticalScrollIndicator")&&(this.showsVerticalScrollIndicator=this.layer.getAttribute("showsVerticalScrollIndicator")!="false"),this.layer.hasAttribute("showsHorizontalScrollIndicator")&&(this.showsHorizontalScrollIndicator=this.layer.getAttribute("showsHorizontalScrollIndicator")!="false"),this.layer.hasAttribute("pagingEnabled")&&(this.pagingEnabled=this.layer.getAttribute("verticalScrollEnabled")=="true"),this.layer.hasAttribute("bounces")&&(this.bounces=this.layer.getAttribute("bounces")!="false"),this.scrollIndicatorInsets={left:this.layer.hasAttribute("indicatorInsetLeft")?parseInt(this.layer.getAttribute("indicatorInsetLeft")):0,right:this.layer.hasAttribute("indicatorInsetRight")?parseInt(this.layer.getAttribute("indicatorInsetRight")):0,top:this.layer.hasAttribute("indicatorInsetTop")?parseInt(this.layer.getAttribute("indicatorInsetTop")):0,bottom:this.layer.hasAttribute("indicatorInsetBottom")?parseInt(this.layer.getAttribute("indicatorInsetBottom")):0},this.adjustContentSize(),this.setContentOffsetWithAnimation(new PKPoint(0,0),!1)}function PKScrollIndicator(e){this.type=e,this.position=new PKPoint,this.createLayer(),this.visible=!1,this.width=PKScrollIndicatorThickness,this.height=PKScrollIndicatorThickness,this.setPosition(new PKPoint(-PKScrollIndicatorThickness,-PKScrollIndicatorThickness)),this.positionBeforeHide=this.position,this.lastPositionUpdateInHide=!1,this.setVisible(!1)}function PKPoint(e,t){this.x=e!=null&&!isNaN(e)?e:0,this.y=t!=null&&!isNaN(t)?t:0}function PKSize(e,t){this.width=e!=null&&!isNaN(e)?e:0,this.height=t!=null&&!isNaN(t)?t:0}function Autoclear(e){this.configureBlock(e)}window.its||(window.its={}),its.isDefined=function(t){return typeof t!="undefined"},its.isDefinedNonNull=function(t){return its.isDefined(t)&&t!=null},window.EXCEPTION_LOGGER_NAME="ITSExceptionHandler",window._itsOnErrorCallback=function(t,n,r){if(t&&t instanceof Event){var i=t.target;
i&&(t="Error attempting to load a script: id="+i.id+" src="+i.src+" type="+i.type+", contents:"+i.innerHTML)}var s={message:t,url:n,lineNumber:r},o=window._attemptedDelayedShowEarlyExceptionComposedMessage;
o?s=window._attemptedDelayedShowEarlyExceptionServerDataDict:o=window._itsComposeErrorMessage(t,n,r,window.EXCEPTION_LOGGER_NAME),window._earlyOnerrorException||(window._earlyOnerrorException={message:t,url:n,lineNumber:r}),window._itsOnErrorCallbackRobust?window._itsOnErrorCallbackRobust(o,s):window._itsOnErrorCallbackFailsafe(o,s),window._tryShowingErrorIndicator(o)},window._itsOnErrorCallbackRobust=function(t,n){try{window.ITSLogger&&ITSLogger.isLoaded?ITSLogger.named(window.EXCEPTION_LOGGER_NAME).error(t,n,!0,null):window.ITSLogger?ITSLogger.queueMessage(window.EXCEPTION_LOGGER_NAME,ITSLogger.ERROR,t,!0,null,n):window._itsOnErrorCallbackFailsafe(t,n)}catch(r){window._itsOnErrorCallbackFailsafe("Exception in exception logging: "+r.toString()+", url:"+r.sourceURL+", lineNumber:"+r.line)}},window._itsOnErrorCallbackFailsafe=function(t,n){if(window._attemptedDelayedShowEarlyExceptionComposedMessage==null)window._attemptedDelayedShowEarlyExceptionComposedMessage=t,window._attemptedDelayedShowEarlyExceptionServerDataDict=n,window.setTimeout(window._itsOnErrorCallback,1e3);
else{var r=null;
its.isDefined(iTunes)&&iTunes.loggingEnabled&&iTunes.log?r=function(e){iTunes.log(e)}:console&&console.log&&(r=function(e){console.log(e)}),r&&t&&r(t)}},window._itsComposeErrorMessage=function(t,n,r,i){var s="",o="unknown (might be html-embedded script?)",u="unknown";
its.isDefinedNonNull(n)&&n!=""&&n!="undefined"&&(o=n),its.isDefinedNonNull(r)&&r!=""&&(u=r),i&&(s=i+":");
var a=s+'{message:"'+t+'", url:"'+o+'", lineNumber:"'+u+'"}';
return a},window._tryShowingErrorIndicator=function(t){var n=10;
window._attemptedShowErrorIndicator==null&&(window._attemptedShowErrorIndicator=0),window._attemptedShowErrorIndicator<n&&(window.ITSLogger&&ITSLogger.showErrorIndicator?(window._attemptedShowErrorIndicator=n+1,ITSLogger.showErrorIndicator(t)):window._attemptedShowErrorIndicator<n&&(window._attemptedShowErrorIndicator++,window.setTimeout(function(){window._tryShowingErrorIndicator(t)},1e3)))},window.onerror=window._itsOnErrorCallback,window.earlyLoadITSLogger={},window.ITSLogger||(window.ITSLogger=window.earlyLoadITSLogger),ITSLogger.DEBUG=1,ITSLogger.INFO=2,ITSLogger.WARN=3,ITSLogger.ERROR=4,ITSLogger.STATS=5,ITSLogger.timeAtLoad=(new Date).getTime(),ITSLogger.queueMessage=function(t,n,r,i,s){arguments.length>=3&&(ITSLogger._queuedMessages||(ITSLogger._queuedMessages=[]),ITSLogger._queuedMessages.push({loggerName:t,loggingThreshold:n,message:r,serverDataDict:s,mirrorToServer:i}))},ITSLogger.possiblyWaitForQueueMessages=function(){var t=its.property&&its.property("itsLoggerQueueProcessingInterval");
t=t?t:1e3,ITSLogger._queuedMessages&&ITSLogger._queuedMessages.length&&t>0&&ITSLogger._delayedProcessQueuedMessages(t)},ITSLogger._processQueuedMessages=function(){ITSLogger.possiblyWaitForQueueMessages()},ITSLogger._delayedProcessQueuedMessages=function(t){window.setTimeout(ITSLogger._processQueuedMessages,t)},ITSStopwatch=function ITSStopwatch(e){this.reset(),e||(e="default"),this._name=e,this._hasLoggedToServer=!1,ITSStopwatch.stopwatches||(ITSStopwatch.stopwatches={}),ITSStopwatch.stopwatches[e]=this},ITSStopwatch.named=function(t){var n=null;
return t||(t="default"),ITSStopwatch.stopwatches&&(n=ITSStopwatch.stopwatches[t]),n||(n=new ITSStopwatch(t)),n},ITSStopwatch.currentTime=function(){return(new Date).getTime()},ITSStopwatch.prototype={start:function(t){return this._stopTime!=-1?this._startTime+=ITSStopwatch.currentTime()-this._stopTime:this._startTime=t?t:ITSStopwatch.currentTime(),this._startTime},stop:function(){this._stopTime=ITSStopwatch.currentTime();
var t=this.elapsedTime(),n=this.splitTimes(),r=null;
for(var i in n)r=n[i],r._stopTime==-1&&(r._stopTime=this._stopTime);
return t},reset:function(){this._startTime=-1,this._stopTime=-1,this._elapsedTimes={}},elapsedTime:function(t){t||(t=this._stopTime!=-1?this._stopTime:ITSStopwatch.currentTime());
var n=t-this._startTime;
return n<0&&(this._negativeElapsedTime=!0,this._negativeElapsedTimeStartTime=this._startTime,this._negativeElapsedTimeStopTime=t,this.logToConsole("error","Negative elapsedTime calculated: "+n+" (endTime was: "+t+" startTime was: "+this._startTime)),n},name:function(){return this._name},startSplitTimeNamed:function(t){t||(t="default");
var n=this.name()+"_"+t,r=ITSStopwatch.named(n);
return r.reset(),r.start()},stopSplitTimeNamed:function(t,n){t||(t="default");
var r=this.name()+"_"+t,i=ITSStopwatch.named(r),s=i.stop();
return n&&this.logPrettyInfoToConsole(t,s),s},splitTimes:function(){var t={},n=null;
for(var r in ITSStopwatch.stopwatches)r.indexOf(this.name()+"_")===0&&(n=r.substr((this.name()+"_").length),t[n]=ITSStopwatch.stopwatches[r]);
return t},splitTimeNamed:function(t){var n=this.name()+"_"+t;
return ITSStopwatch.named(n)},markElapsedTimeNamed:function(t,n){t||(t="default");
var r=this.elapsedTime(ITSStopwatch.currentTime());
return this._elapsedTimes[t]=r,n&&this.logPrettyInfoToConsole(t,r),r},markedElapsedTimes:function(){return this._elapsedTimes},markedElapsedTimeNamed:function(t){return this._elapsedTimes[t]},logToConsole:function(t,n){window.ITSLogger&&ITSLogger.isLoaded?ITSLogger.named(this.name())[t](n):console&&console.log&&localStorage.getItem("ITSStopWatch.debug")&&console.log(this.name()+": "+n)},logPrettyInfoToConsole:function(t,n){var r=t+"["+n+"]";
this.logToConsole("info",r)},logToServer:function(t){this.stop();
var n=t?t:{};
n.elapsedTimeSinceTimerCreation=this.elapsedTime(),n.negativeElapsedTime=this._negativeElapsedTime,n.negativeElapsedTimeStartTime=this._negativeElapsedTimeStartTime,n.negativeElapsedTimeStopTime=this._negativeElapsedTimeStopTime;
var r=this.splitTimes();
for(var i in r)n[i]=r[i].elapsedTime();
var s=this.markedElapsedTimes();
for(var o in s)n[o]=s[o];
window.ITSLogger&&ITSLogger.isLoaded&&(ITSLogger.named(this.name()).stats(null,n,!0),this._hasLoggedToServer=!0)},hasLoggedToServer:function(){return this._hasLoggedToServer}},ITSStopwatch.named("ITSLoadTimes").start(its.markupLoadStartTime),window.addEventListener("DOMContentLoaded",function(){ITSStopwatch.named("ITSLoadTimes").markElapsedTimeNamed("DOMContentLoaded",!0)},!0),window.addEventListener("load",function(){ITSStopwatch.named("ITSLoadTimes").markElapsedTimeNamed("load",!0),its.kit||window.setTimeout(function(){ITSStopwatch.named("ITSLoadTimes").markElapsedTimeNamed("afterLoad",!0)},1)},!0),window.setTimeout(function(){var t=ITSStopwatch.named("ITSLoadTimes");
t.hasLoggedToServer()||t.logToServer({failsafeTimeout:!0,probableExceptionDuringLoad:!0})},31e3),iTSDefer=function(){var e=[],t=!1,n=function(t){i()?e.push(t):t()},r=function(){t||(window.preventDeferJsLoad=!0);
if(!i())return;for(var n=0;
n<e.length;
n++)e[n]()},i=function(){return!window.preventDeferJsLoad},s=function(){t=!0};
return{register:n,execute:r,isDeferSupported:i,setBodyWasParsed:s}}(),typeof its=="undefined"&&(its={}),its.sf||(its.sf={}),its.sf.DelayedCallQueue={},its.sf.DelayedCallQueue._queue={},its.sf.DelayedCallQueue._handlerObjectsCache={},its.sf.DelayedCallQueue.call=function(handlerObjectName,aFunction){var handlerObject=its.sf.DelayedCallQueue._handlerObjectsCache[handlerObject];
if(!handlerObject)try{handlerObject=eval(handlerObjectName),handlerObject&&typeof handlerObject!="undefined"&&(its.sf.DelayedCallQueue._handlerObjectsCache=handlerObject)}catch(anException){}var handlerObjectFunctionArray=its.sf.DelayedCallQueue._queue[handlerObjectName];
!handlerObject||typeof handlerObject=="undefined"?(handlerObjectFunctionArray||(handlerObjectFunctionArray=[],its.sf.DelayedCallQueue._queue[handlerObjectName]=handlerObjectFunctionArray),handlerObjectFunctionArray.push(aFunction)):(its.sf.DelayedCallQueue.objectReady(handlerObjectName),aFunction())},its.sf.DelayedCallQueue.objectReady=function(e){var t=its.sf.DelayedCallQueue._queue[e];
if(t){for(var n=0;
n<t.length;
n++)t[n]();
its.sf.DelayedCallQueue._queue[e]=null,delete its.sf.DelayedCallQueue._queue[e]}},window.its||(window.its={}),its.MetricsQueue={},its.MetricsQueue._isDefined=function(e){return typeof e!="undefined"},its.MetricsQueue._isDefinedNonNull=function(e){return its.MetricsQueue._isDefined(e)&&e!=null},its.MetricsQueue._addAll=function(e,t){return e.push.apply(e,t),e},its.MetricsQueue._DELIVERY_VERSION=2,its.MetricsQueue._DEBUG_FLAG="MetricsDebug",its.MetricsQueue._MAX_PERSISTENT_QUEUE_SIZE=100,its.MetricsQueue._LOCALSTORAGE_QUEUE_KEY="itsMetricsEventQueue",its.MetricsQueue._LOCALSTORAGE_QUEUE_VERSION_KEY="version",its.MetricsQueue._LOCALSTORAGE_QUEUE_VERSION="2",its.MetricsQueue._LOCALSTORAGE_QUEUE_LAST_POST_INTERVAL_START_TIME_KEY="lastPostIntervalStartTime",its.MetricsQueue._EVENTS_KEY="events",its.MetricsQueue._config={},its.MetricsQueue.setConfig=function(e){its.MetricsQueue._debug("Initializing MetricsQueue");
for(var t in e)e.hasOwnProperty(t)&&its.MetricsQueue._isDefined(e[t])&&(its.MetricsQueue._config[t]=e[t]);
its.MetricsQueue._config.localStorage||(its.MetricsQueue._config.localStorage=localStorage),its.MetricsQueue._setPostInterval(its.MetricsQueue._calculatePostInterval()),its.MetricsQueue._config.compoundSeparator||(its.MetricsQueue._config.compoundSeparator=""),its.MetricsQueue._config.tokenSeparator||(its.MetricsQueue._config.tokenSeparator="")},its.MetricsQueue.__defineGetter__("config",function(){return its.MetricsQueue._config}),its.MetricsQueue.__defineSetter__("config",function(){throw"'its.MetricsQueue.config' may be read directly but can only be set via the 'its.MetricsQueue.setConfig()' method."}),its.MetricsQueue.getConfig=function(){return its.MetricsQueue._config},its.MetricsQueue.recordEvent=function(e,t,n){its.MetricsQueue._config.disabled||(its.MetricsQueue._config.postFrequency==0&&(n=!0),its.MetricsQueue._debug("enqueueing event: ",t),its.MetricsQueue._persistEvent(t),n&&its.MetricsQueue._sendEvents())},its.MetricsQueue._debugEnabled=function(){return localStorage&&localStorage.getItem(its.MetricsQueue._DEBUG_FLAG)=="true"},its.MetricsQueue._debug=function(){var e=null;
return its.MetricsQueue._debugEnabled()&&(e=its.MetricsQueue._logIt("debug",arguments)),e},its.MetricsQueue._warn=function(){var e=null;
return e=its.MetricsQueue._logIt("warn",arguments),e},its.MetricsQueue._logIt=function(e,t){var n=null;
if(e){var r,i;
its.MetricsQueue._logger()?(r=its.MetricsQueue._logger(),i=t):(r=console,i=[],i.push(e.toUpperCase()+": its.MetricsQueue:"),i.push.apply(i,t)),n=r[e].apply(r,i)}return n},its.MetricsQueue._logger=function(){return its.Logger&&(its.MetricsQueue._cachedLogger||(its.MetricsQueue._cachedLogger=its.Logger.named("its.MetricsQueue"))),its.MetricsQueue._cachedLogger},its.MetricsQueue._sendEvents=function(){var e=null;
if(!its.MetricsQueue._config.disabled&&its.MetricsQueue._config.metricsUrl){var t=null;
its.MetricsQueue._setPostInterval(its.MetricsQueue._config.postFrequency,!0);
var n="Sending";
if(its.MetricsQueue._config.sendDisabled)n="_config.sendDisabled, Sending";
else if(document.hidden)its.MetricsQueue._resetPostInterval(),n="hidden window, Sending";
else{var r=its.MetricsQueue._persistedEventsBatchString();
if(r){t=r,finalUrl=its.MetricsQueue._config.metricsUrl;
var i=finalUrl.indexOf("?")==-1?"?":"&";
finalUrl+=i+"deliveryVersion="+its.MetricsQueue._DELIVERY_VERSION;
var s=new XMLHttpRequest;
s.onreadystatechange=function(e){var t="N/A";
s.readyState==4&&(t=s.status,(s.status>=200&&s.status<300||s.status>=400&&s.status<500)&&its.MetricsQueue._resetPersistantEventQueue(),its.MetricsQueue._config.postResponseCallback&&its.MetricsQueue._config.postResponseCallback(s.status,s.responseText)),its.MetricsQueue._debug("XHR response: readyState:"+s.readyState+" status:"+t)},s.open("POST",finalUrl,!0),s.withCredentials=!0,s.setRequestHeader("Content-type","application/json"),s.send(t),e=t}}t?its.MetricsQueue._debug(n+" eventQueue: ",t):its.MetricsQueue._debug(n+" bypassed; no events to send")}else its.MetricsQueue._debug("Pings disabled via 'its.MetricsQueue.disabled' property");
return e},its.MetricsQueue._setPostInterval=function(e,t){its.MetricsQueue._debug("_setPostInterval: "+e),its.MetricsQueue._resetPostInterval(),e&&(its.MetricsQueue._postIntervalToken=setInterval(its.MetricsQueue._sendEvents,e),t&&its.MetricsQueue._config.localStorage.setItem(its.MetricsQueue._LOCALSTORAGE_QUEUE_LAST_POST_INTERVAL_START_TIME_KEY,(new Date).getTime().toString()))},its.MetricsQueue._resetPostInterval=function(){clearInterval(its.MetricsQueue._postIntervalToken),its.MetricsQueue._postIntervalToken=null},its.MetricsQueue._persistEvent=function(e){var t=null;
if(e){var n=its.MetricsQueue._persistedEvents();
n||(n=[]),n.push(e);
var r={};
r[its.MetricsQueue._LOCALSTORAGE_QUEUE_VERSION_KEY]=its.MetricsQueue._LOCALSTORAGE_QUEUE_VERSION,r[its.MetricsQueue._EVENTS_KEY]=n;
var t=JSON.stringify(r);
its.MetricsQueue._config.localStorage.setItem(its.MetricsQueue._LOCALSTORAGE_QUEUE_KEY,t)}return t},its.MetricsQueue._persistedEvents=function(){var e=null,t=its.MetricsQueue._config.localStorage.getItem(its.MetricsQueue._LOCALSTORAGE_QUEUE_KEY);
if(its.MetricsQueue._isDefinedNonNull(t)){var n=JSON.parse(t),e=null;
n&&(n.events?e=n.events:its.MetricsQueue._resetPersistantEventQueue());
if(its.MetricsQueue._isDefinedNonNull(e)&&e.length){if(its.MetricsQueue._config.staleEventTimeout){var r=[],i=(new Date).getTime();
for(var s=0;
s<e.length;
s++){var o=e[s];
o&&o.eventTime&&i-o.eventTime<its.MetricsQueue._config.staleEventTimeout&&r.push(e[s])}e=r}e&&e.length&&e.length>its.MetricsQueue._MAX_PERSISTENT_QUEUE_SIZE&&(e=e.slice(-its.MetricsQueue._MAX_PERSISTENT_QUEUE_SIZE),its.MetricsQueue._warn("eventQueue Overflow, deleting LRU events: size is: "+e.length+" which is over max size: "+its.MetricsQueue._MAX_PERSISTENT_QUEUE_SIZE,null,!0))}else its.MetricsQueue._warn('Empty persistant eventQueue "events" list, deleting.',null,!0);
if(!e||!e.length)e=null,its.MetricsQueue._debug("clearing unexpectedly empty queue"),its.MetricsQueue._resetPersistantEventQueue()}return e},its.MetricsQueue._persistedEventsBatchString=function(){var e=null,t=its.MetricsQueue._persistedEvents();
if(t){var n={};
its.MetricsQueue._config.debugClientToProvideClientId&&(n.clientId=its.MetricsQueue._config.debugClientToProvideClientId),n.deliveryVersion=its.MetricsQueue._DELIVERY_VERSION,n.postTime=(new Date).getTime(),n.xpBatchSize=t.length,n[its.MetricsQueue._EVENTS_KEY]=t,e=JSON.stringify(n)}return e},its.MetricsQueue._calculatePostInterval=function(){var e=its.MetricsQueue._config.postFrequency,t=its.MetricsQueue._config.localStorage.getItem(its.MetricsQueue._LOCALSTORAGE_QUEUE_LAST_POST_INTERVAL_START_TIME_KEY);
if(t){var n=(new Date).getTime(),r=its.MetricsQueue._config.postFrequency-(n-t);
r<0&&(r=1),e=r}return e},its.MetricsQueue._resetPersistantEventQueue=function(){its.MetricsQueue._config.localStorage.removeItem(its.MetricsQueue._LOCALSTORAGE_QUEUE_KEY)},window.its||(window.its={}),window.its.sf||(window.its.sf={}),its.sf.Client={_iTunesObject:function(){var e=null;
return typeof iTunes!="undefined"?e=iTunes:typeof itms!="undefined"&&(e=itms),e},_deviceObject:function(){var e=null;
return typeof Device!="undefined"&&(e=Device),e},_isRunning:function(){return its.isDefinedNonNull(this._iTunesObject())},version:function(){var e=null;
return this._iTunesObject()&&(this._iTunesObject().version?e=this._iTunesObject().version:this._iTunesObject().systemVersion&&(e=this._iTunesObject().systemVersion())),!e&&this._deviceObject()&&this._deviceObject().systemVersion&&(e=this._deviceObject().systemVersion),e},isVersion:function(e){return its.string.compareNumerically(its.sf.Client.version(),e)>=0},dsId:function(){var e=null;
return this._iTunesObject()&&(this._iTunesObject().primaryAccount?e=iTunes.primaryAccount.dsID:this._iTunesObject().getUserDSID?(e=this._iTunesObject().getUserDSID(),e=="0"&&(e=null)):its.isDefinedNonNull(this._iTunesObject().DSID)&&(e=this._iTunesObject().DSID,e=="0"&&(e=null))),e},iCloudDsid:function(){var e=null;
return this._iTunesObject()&&this._iTunesObject().appleAccountStore&&this._iTunesObject().appleAccountStore.primaryAppleAccount&&(e=this._iTunesObject().appleAccountStore.primaryAppleAccount.dsID),e},isXMLResponse:function(e){return e&&its.string.startsWith(e.getResponseHeader("content-type"),"text/xml")},findChildElementNodeAtPosition:function(e,t){if(!e)return;var n=e.childNodes.length;
if(t>=n)return;var r=0;
for(var i=0;
i<n;
i++){var s=e.childNodes[i];
if(s.nodeType===Node.ELEMENT_NODE){if(r===t)return s;
r+=1}}return null},findPositionChildElementNodeNamed:function(e,t){if(!e)return;var n=e.childNodes.length;
if(n===0)return;var r=0;
for(var i=0;
i<n;
i++){var s=e.childNodes[i];
if(s.nodeType===Node.ELEMENT_NODE){if(s.lastChild&&s.lastChild.textContent==t)return r;
r++}}return}},its.client||(its.client={}),its.client.version||(its.client.version=function(){return its.sf.Client.version()}),window.its||(window.its={}),window.its.sf||(window.its.sf={}),its.sf.Platform={iPhone:function(){return its.sf.Platform.init(),its.sf.Platform._iPhone==1},iPhone5:function(){return its.sf.Platform.init(),its.sf.Platform._iPhone5==1},iPad:function(){return its.sf.Platform.init(),its.sf.Platform._iPad==1},iPadPro:function(){return typeof Device!="undefined"&&(Device.productType.indexOf("iPad6,7")!==-1||Device.productType.indexOf("iPad6,8")!==-1)},ATV:function(){return its.sf.Platform.init(),its.sf.Platform._ATV==1},iTunes11:function(){return its.sf.Platform.init(),its.sf.Platform._iTunes11==1},iTunes12:function(){return its.sf.Platform.init(),its.sf.Platform._iTunes12==1},iBooksMac:function(){return its.sf.Platform.init(),its.sf.Platform._iBooksMac==1},MacAppStore:function(){return its.sf.Platform.init(),its.sf.Platform._MacAppStore==1},desktop:function(){return this.iTunes11()||this.iTunes12()?!0:this.iBooksMac()?!0:this.MacAppStore()?!0:!1},device:function(){return this.iPhone()||this.iPad()},init:function(){if(its.sf.Platform._IS_INITIALIZED)return;if(its.serverData&&its.serverData.constants&&its.serverData.constants.platformCacheId)its.sf.Platform._platformCacheId=Number(its.serverData.constants.platformCacheId);
else{var e=document.querySelector("meta[name='platform-cache-id']");
its.sf.Platform._platformCacheId=e?Number(e.getAttribute("content")):null}switch(its.sf.Platform._platformCacheId){case 25:case 23:case 20:case 15:case 30:its.sf.Platform._iPad=!0;
break;case 26:case 24:case 21:case 16:case 29:its.sf.Platform._iPhone=!0;
break;case 19:case 27:case 33:its.sf.Platform._ATV=!0;
break;case 17:its.sf.Platform._iTunes11=!0;
break;case 28:case 32:its.sf.Platform._iTunes12=!0;
break;case 22:its.sf.Platform._iBooksMac=!0;
break;case 13:its.sf.Platform._MacAppStore=!0}its.sf.Platform._IS_INITIALIZED=!0},hiDPI:function(){return window.devicePixelRatio>1},isDark:function(){return typeof document!="undefined"&&typeof document.body!="undefined"&&typeof document.body.className!="undefined"&&document.body.className.match("dark")},isMavericksOrLater:function(){return this.iBooksMac()||typeof iTunes!="undefined"&&(iTunes.platform=="mac"||iTunes.platform=="Mac")&&iTunes.osBuildID&&its.string.compareNumerically(iTunes.osBuildID,"13A")>=0},platformCacheId:function(){return its.sf.Platform.init(),its.sf.Platform._platformCacheId},isITML:function(){var e=!1;
return its.serverData&&its.serverData.constants&&its.serverData.constants.usesITML&&typeof itms!="undefined"&&(e=!0),e},isProd:function(){if(!its.isDefinedNonNull(this._isProd)){var e=its.property("ITSServerEnvironment");
this._isProd=e&&e.indexOf("prod")!=-1}return this._isProd},isBadgeTextColoringSupported:function(){return Device&&its.string.compareNumerically(Device.systemVersion,"8.1")>=0},isReleaseDateInMovieLockup:function(){return its.sf.Platform.iPad()},isATV9OrGreater:function(){return this.ATV()&&this.platformCacheId()>=33},isIPhone6PlusScreenSize:function(){return this._screenSize().height==736&&this._screenSize().width==414||this._screenSize().height==414&&this._screenSize().width==736},isIPhone6ScreenSize:function(){return its.isDefinedNonNull(this._isIPhone6ScreenSize)||(this._isIPhone6ScreenSize=this._screenSize().height==667&&this._screenSize().width==375),this._isIPhone6ScreenSize},isIPhone5ScreenSize:function(){return its.isDefinedNonNull(this._isIPhone5ScreenSize)||(this._isIPhone5ScreenSize=this._screenSize().height==568&&this._screenSize().width==320),this._isIPhone5ScreenSize},isIPhone4ScreenSize:function(){return typeof Device!="undefined"&&!its.isDefinedNonNull(this._isIPhone4ScreenSize)&&(this._isIPhone4ScreenSize=Device.productType.indexOf("iPhone4")!=-1),this._isIPhone4ScreenSize},_screenSize:function(){var e={};
return typeof Settings!="undefined"&&(e=typeof Settings.screen!="undefined"?Settings.screen:Settings.Screen),e},isVersionSupported:function(t){if(Device.systemVersion===t)return!0;
var n=Device.systemVersion,r=n.split("."),i=t.split("."),s=Math.max(r.length,i.length),o=function(e,t,n){e+="";
for(var r=0;
r<t;
r++)e+=n;
return e};
i.length!==s&&(t=o(t,s-i.length,".0"),i=t.split(".")),r.length!==s&&(n=o(n,s-r.length,".0"),r=n.split("."));
if(n===t)return!0;
for(var u=0,a=i.length;
u<a;
u++){i[u]=+i[u],r[u]=+r[u];
if(i[u]<r[u])return!0;
if(i[u]>r[u])return!1}return!1}},its.sf.Platform._logger=its.Logger?its.Logger.named("its.sf.Platform"):null,window.its||(window.its={}),window.its.sf||(window.its.sf={}),window.its.sf6||(window.its.sf6={}),window.its.dv6||(window.its.dv6={}),window.its.dv7||(window.its.dv7={}),window.its.dvx||(window.its.dvx={}),window.its||(window.its={}),its.files||(its.files={}),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice,r=n.call(arguments,1);
return function(){return t.apply(e,r.concat(n.call(arguments)))}}),Class={create:function(e,t){return Class._create(e,t)},createSubclass:function(e,t,n){if(!t)throw new Error("Undefined base class when creating subclass: "+e);
return Class._create(e,n,t)},_create:function(e,t,n){function r(){this.initialize.apply(this,arguments)}function i(e,t,n){var r=e[n];
e[n]=function(){var i=t[n],s=this.base,o=arguments;
this.base=function(){return arguments.length&&(o=arguments),i.apply(this,o)};
try{return r.apply(this,o)}finally{this.base=s}}}if(n){var s=function(){};
s.prototype=n.prototype,r.prototype=new s}Class.extend(r.prototype,t);
if(n)for(var o in n.prototype)r.prototype.hasOwnProperty(o)&&typeof r.prototype[o]=="function"&&typeof n.prototype[o]=="function"&&i(r.prototype,n.prototype,o);
return r.prototype.initialize||(r.prototype.initialize=its.emptyFunction),r.prototype.constructor=r,r.klassName=e,r},extend:function(e,t){e=e||{},t=t||{};
for(var n in t)e[n]=t[n];
return e},shallowClone:function(e){return Class.extend({},e)}},typeof window=="undefined"&&(window=this),typeof location=="undefined"&&(location={},location.search=""),window.its||(window.its={}),its.sf||(its.sf={}),its.currentTime=function(){return(new Date).getTime()},its.isDefined=function(t){return typeof t!="undefined"},its.isDefinedNonNull=function(t){return its.isDefined(t)&&t!=null},its.isDefinedNonNullNonEmpty=function(t){return its.isDefined(t)&&t!=null&&t!=""},its.isFunction=function(t){return typeof t=="function"},its.isNumber=function(t){return typeof t=="number"},its.isString=function(t){return typeof t=="string"||t instanceof String},its.isElement=function(t){return t&&t.nodeType==1},its.isArray=function(t){return t&&t.constructor===Array},its.isObject=function(t){return t&&t.constructor===Object},its.createObjectPath=function(e,t){return its.objectAtPath(e,t,!0)},its.objectAtPath=function(e,t,n){var r=definedValue(t,window);
if(e){var i=e.split(".");
for(var s=0;
r&&s<i.length;
s++){var o=i[s];
!r[o]&&n&&(r[o]={}),r[o]?r=r[o]:r=null}}return r},its.toArray=function(t){var n;
if(its.isString(t))t=its.string.trim(t,"(){}[]"),n=t.split(",");
else{var n=[];
if(t&&its.isDefinedNonNull(t.length))for(var r=0;
r<t.length;
r++)n[r]=t[r]}return n},its.arrayToMap=function(e){var t={};
e=its.toArray(e);
for(var n=0;
n<e.length;
n++)t[e[n]]=!0;
return t},its.toBoolean=function(t){return t?t=="0"||t=="false"?!1:!0:!1},its.isEmpty=function(t){var n=!0;
if(its.isDefinedNonNull(t))if(its.isString(t)&&t!="")n=!1;
else if(its.isArray(t)&&t.length>0)n=!1;
else for(var r in t)if(t.hasOwnProperty(r)){n=!1;
break}return n},its.contains=function(t,n){var r=!1;
return its.isDefinedNonNull(t)&&its.isDefinedNonNull(n)&&(its.isString(t)&&its.isString(n)&&t.indexOf(n)!=-1||its.isArray(t)&&t.indexOf(n)!=-1||its.isDefinedNonNull(t[n]))&&(r=!0),r},its.webkitVersion=function(){var t=navigator.userAgent,n=/AppleWebKit\/([\d.]+)/,r=n.exec(t),i;
if(r)i=r[1];
else{var s=/^iTunes\/10\.4 \(Windows;.+AppleWebKit\/$/;
s.exec(t)?i="533.21.1":(window.console&&console.warn("Unable to determine WebKit version from user agent: "+t),i="0")}return i},its.webkitVersionCompare=function(t,n){var r=0,i=0,s=t.split("."),o=n.split(".");
while((s[i]||o[i])&&r==0){var u=s[i]?its.string.toInt(s[i]):0,a=o[i]?its.string.toInt(o[i]):0;
u<a?r=-1:u>a&&(r=1),i++}return r},its.poseAs=function(e,t,n){var r=e[t];
e[t]=function(){var e=[r,arguments];
return n.apply(this,e)}},its.emptyFunction=function(){},its.swallowEventFunction=function(t){t.preventDefault(),t.stopPropagation()},window.its.element||(window.its.element={}),its.element.createDocumentFragmentFromString=function(t){var n=document.createDocumentFragment(),r;
if(!its.sf.Platform.isITML()){var i=document.createElement("div");
i.innerHTML=t,r=i.children;
var s=r.length;
for(var o=0;
o<s;
o++)n.appendChild(r[0])}else if(its.string.compareNumerically(its.sf.Client.version(),"8.0")>=0)n.innerXML=t;
else{t="<placeholder>"+t+"</placeholder>",i=(new DOMParser).parseFromString(t,"text/xml"),r=i.firstChild.children;
for(var o=0;
o<r.length;
o++){var u=r.item(o);
document.adoptNode(u),n.appendChild(u)}}return its&&its.Template&&its.sf.Platform.isITML()&&its.Template.queryForITSElements(n),n},its.element.createElementFromString=function(t){var n=its.element.createDocumentFragmentFromString(t),r=n.childNodes;
return r.length>0?(r.length>1&&window.console&&console.warn("its.element.createElementFromString: multiple elements were created, but only the first will be returned"),r.item(0)):null},its.element.setAttributes=function(t,n){if(n)for(var r in n)n.hasOwnProperty(r)&&t.setAttribute(r,n[r])},its.element.getScrollTop=function(e){return e==window?window.scrollY:e.scrollTop},its.element.getScrollLeft=function(e){return e==window?window.scrollX:e.scrollLeft},its.element.getClientHeight=function(e){return e==window?window.innerHeight:e.clientHeight},its.element.getClientWidth=function(e){return e==window?window.innerWidth:e.clientWidth},its.element.getScrollHeight=function(e){return e==window?window.pageYOffset:e.scrollHeight},its.element.getScrollWidth=function(e){return e==window?window.pageXOffset:e.scrollWidth},its.element.getOffsetHeight=function(e){return e==window?document.body.offsetHeight:e.offsetHeight},its.element.getOffsetWidth=function(e){return e==window?document.body.offsetWidth:e.offsetWidth},window.its.geometry||(window.its.geometry={}),its.geometry.doesRectIntersectRect=function(t,n){var r=!0;
return t.right<n.left?r=!1:t.left>n.right?r=!1:t.bottom<n.top?r=!1:t.top>n.bottom&&(r=!1),r},its.geometry.Orientation={VERTICAL:1,HORIZONTAL:2},window.its.array||(window.its.array={}),its.array.arrayOfPrimitivesAsSet=function(t){if(t==null)return null;
var n={};
for(var r=0;
r<t.length;
r++){var i=t[r];
switch(typeof i){case"boolean":case"number":case"string":n[i]=!0;
break;default:throw"its.array.asSet: array contains non primitive element"}}return n},its.array.pushAll=function(t,n){t.push.apply(t,n)},its.array.insertArray=function(e,t,n,r){var i=e[n];
return e[n]="temp",e[n]=i,r&&e.splice(n,t.length),e.splice.apply(e,[n,0].concat(t)),e},window.its.string||(window.its.string={}),its.string.startsWith=function(t,n,r){var i=!1;
return t&&n&&(t=t.substr(0,n.length),r&&(t=t.toLowerCase(),n=n.toLowerCase()),i=t.indexOf(n)===0),i},its.string.endsWith=function(t,n,r){var i=!1;
if(t){r&&(t=t.toLowerCase(),n=n.toLowerCase());
var s=t.length-n.length;
i=s>=0&&t.lastIndexOf(n)===s}return i},its.string.pad=function(t,n,r){var i=t+="";
r=r||"0";
if(i.length<n){var s=n-i.length,o=[];
for(var u=s;
u>0;
u--)o.push(r);
i=o.join("")+i}return i},its.string.replace=function(e,t,n){return e?(typeof e!="string"&&(e+=""),e.split(t).join(n)):e},its.string.whitespace="	\n\f\r             　\u2028\u2029​",its.string._whitespaceTrimStartRegex=new RegExp("^["+its.string.whitespace+"]+"),its.string._whitespaceTrimEndRegex=new RegExp("["+its.string.whitespace+"]+$"),its.string.trim=function(t,n,r){var i=null;
if(t)if(!r&&(!n||n==its.string.whitespace)&&t.trim)i=t.trim();
else{var s=null,o=null,u=null;
its.isDefinedNonNull(n)?(n=n.replace(/([.?*+^$[\]\\(){}-])/g,"\\$1"),s="["+n+"]",o=new RegExp("^"+s+"+"),u=new RegExp(s+"+$")):(s=its.string.whitespace,o=its.string._whitespaceTrimStartRegex,u=its.string._whitespaceTrimEndRegex);
var a=t.replace(o,"");
i=a.replace(u,"")}return i},its.string.splitTrimmed=function(t,n,r){var i=t.split(n);
if(i)for(var s=0;
s<i.length;
s++)i[s]=its.string.trim(i[s],r);
return i},its.string.xmlEscape=function(){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};
return function(t){var n=t;
return n&&(n+="",n=n.replace(/[&<>"']/g,function(t){return e[t]})),n}}(),its.string.xmlUnescape=function(t){return t.replace(/&apos;/g,String.fromCharCode(39)).replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},its.string.htmlUnescape=function(t){var n=document.createElement("textarea");
n.innerHTML=t.replace(/</g,"&lt;").replace(/>/g,"&gt;");
var r=n.value;
return n.remove(),r},its.string.contains=function(t,n){return t&&t.indexOf(n)>-1},its.string.urlDecode=function(t){var n=t;
return t&&(n=t.replace(/\+/g," "),n=decodeURIComponent(n)),n};
var _dateExpression=new RegExp("^([0-9]{4}/[0-9]{2}/[0-9]{2})/(.*)");
its.string.compare=function(t,n,r,i){var s=null,o=1;
r&&(o=-1);
var u=_dateExpression.exec(t),a=_dateExpression.exec(n);
u&&a&&(u[1]==a[1]?(t=u[2],n=a[2]):(s=u[1]>a[1]?1:-1,i&&(o=-1)));
if(!s){var f=parseFloat(t),l=parseFloat(n);
if(!isNaN(f)&&!isNaN(l)&&f!=l)s=f-l;
else{var c=t.toLowerCase(),h=n.toLowerCase();
if(c<h)s=-1;
else if(c>h)s=1;
else{s=0;
for(var p=0;
!s&&p<t.length;
p++){var d=t.charAt(p),v=n.charAt(p);
d<v?s=1:d>v&&(s=-1)}}}}return s*=o,s},its.string.compareNumerically=function(e,t){if(!e&&!t)return 0;
if(!e)return-1;
if(!t)return 1;
var n="0123456789",r=0,i=0;
while(r<e.length||i<t.length){var s=e[r],o=t[i];
if(!o)return 1;
if(!s)return-1;
var u=n.indexOf(s)>=0,a=n.indexOf(o)>=0;
if(u&&a){var f=its.string._getNumberFromBeginningOfString(e,r),l=its.string._getNumberFromBeginningOfString(t,i);
if(parseInt(f,10)<parseInt(l,10))return-1;
if(parseInt(f,10)>parseInt(l,10))return 1;
r+=f.length,i+=l.length}else{if(s<o)return-1;
if(s>o)return 1;
r++,i++}}return 0},its.string._getNumberFromBeginningOfString=function(e,t){var n="0123456789";
for(var r=t;
r<e.length;
r++)if(n.indexOf(e[r])<0)break;return e.substring(t,r)},its.string.toInt=function(t){return parseInt(t,10)},its.string.isJson=function(t){var n=!1;
if(!its.isEmpty(t)){var r=t.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,"");
n=/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/.test(r)}return n},its.string.evalJson=function itsStringEvalJson(aString){try{if(its.string.isJson(aString))return eval("("+aString+")")}catch(e){}throw new SyntaxError("Badly formed JSON string: "+aString)},its.string.allAlphaNumerics="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",its.string.randomAlphaNumericString=function(t){var n="";
for(var r=0;
r<t;
r++)n+=its.string.allAlphaNumerics[Math.floor(its.string.allAlphaNumerics.length*Math.random())];
return n},its.string.generateUuid=function(t,n){var r=null,i=(new Date).getTime()+"";
n||(n=6),t||(t=i.length+n);
if(n>t)throw new Error("its.string.generateUuid cannot generate a string with more random numbers than the max requested string length");
var s=t-n;
return s<i.length&&(i=i.substring(i.length-s)),r=i+its.string.randomAlphaNumericString(n),r},its.string.UUIDv4=function b(e){return e?(e^Math.random()*16>>e/4).toString(16):([1e7]+ -1e3+ -4e3+ -8e3+ -1e11).replace(/[018]/g,b)},its.string.unstringify=function(t){var n=t;
return t!=null&&its.isDefined(t)&&(n=="false"?n=!1:n=="true"?n=!0:/(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/.test(n)&&(isFinite(parsedNumber=parseFloat(n))?n=parsedNumber:isFinite(parsedNumber=parseInt(n,10))&&(n=parsedNumber))),n},its.string.capitalizeString=function(e){if(e&&e.length>0)return e.charAt(0).toUpperCase()+e.substr(1)},window.its.reflect||(window.its.reflect={}),its.reflect.keys=function keys(e){var keys=[];
for(var t in e)e.hasOwnProperty(t)&&!its.isFunction(e[t])&&keys.push(t);
return keys},its.reflect.hasAnyKeys=function(t){for(var n in t)if(t.hasOwnProperty(n))return!0},its.reflect.hasAnyNonNullKeys=function(t){for(var n in t)if(t.hasOwnProperty(n)&&t[n])return!0},its.reflect.values=function values(e){var values=[];
for(var t in e){var n=e[t];
e.hasOwnProperty(t)&&!its.isFunction(n)&&values.push(n)}return values},its.reflect.methods=function methods(e){var methods=[];
for(var t in e){var n=e[t];
e.hasOwnProperty(t)&&its.isFunction(n)&&methods.push(n)}return methods},its.reflect.copyKeysAndValues=function(t,n){if(t)for(var r in t){var i=t[r];
t.hasOwnProperty&&t.hasOwnProperty(r)&&!its.isFunction(i)&&(n[r]=i)}},its.reflect.invert=function(e){var t={};
for(var n in e)e.hasOwnProperty(n)&&!its.isFunction(e[n])&&(t[e[n]]=n);
return t},window.its.url||(window.its.url={}),its.url.parentDomainWithNumComponents=function(t,n){var r=t;
if(t&&t!=""){var i=t.split("."),s=i.length;
if(s>=n){r="";
while(n)r+=i[s-n],n--,n&&(r+=".")}}return r},its.url.queryParamsDict=function(t){var n=null,r=null;
if(!t)r=window.location.search;
else{var i=t.indexOf("?");
i>=0&&(r=t.substring(i))}return r?n=its.url.parseQueryParams(r):n={},n},its.url.queryParamValue=function(t,n){var r=its.url.queryParamsDict(n);
return r[t]},its.url.parseQueryParams=function(t,n){var r={};
if(t!=null&&t.length>0){t.charAt(0)==="?"&&(t=t.substr(1));
var i=t.indexOf("#");
i!==-1&&(t=t.substr(0,i));
var s=t.split("&");
for(var o=0;
o<s.length;
o++){var u=s[o].split("=");
if(u.length==2){var a=u[1];
n||(a=its.string.urlDecode(a)),r[u[0]]=a}}}return r},its.url.hashParamValue=function(t,n){var r=its.url.hashAnchorParamsDict(n);
return r[t]},its.url.hashAnchorParamsDict=function(t){var n,r={};
if(!t)n=window.location.hash;
else{var i=t.indexOf("#");
i>=0&&(n=t.substring(i))}return n&&(r=its.url.parseHashAnchorParams(n)),r},its.url.parseHashAnchorParams=function(t){var n={};
t||(t=window.location.hash);
if(t!=null&&t.length>0){t.charAt(0)==="#"&&(t=t.substr(1));
var r=t.split(";");
for(var i=0;
i<r.length;
i++){var s=r[i].split("=");
if(s.length==2){var o=its.string.urlDecode(s[1]);
n[s[0]]=o}else n[r[i]]=""}}return n},its.url.parseHostname=function(t){var n="";
if(t){t=t.toString();
if(t&&t.indexOf("://")>0){var r=t.indexOf("://")+3,i=t.indexOf("/",r);
i===-1&&(i=t.length),n=t.substring(r,i)}}return n},its.url.parseUrlScheme=function(t){var n="";
if(t){t=t.toString();
if(t&&t.indexOf("://")>0){var r=t.indexOf("://");
r===-1&&(r=t.length),n=t.substring(0,r)}}return n},its.url.changeUrlScheme=function(t,n){var r="";
if(t&&n){t=t.toString();
if(t){var i=its.url.parseUrlScheme(t);
r=t.replace(i,n)}}return r},its.url.finalPathComponent=function(t){var n="";
if(t){t=t.toString();
if(t&&t!=""){var r=t.lastIndexOf("/");
if(r==t.length-1&&r>0)var r=t.lastIndexOf(r-1);
r!=t.length-1&&(n=t.substring(r+1)),(r=n.lastIndexOf("/"))!=-1&&(n=n.substring(0,r)),(r=n.lastIndexOf("?"))!=-1&&(n=n.substring(0,r))}}return n},its.url.buildUrlFromMap=function(e){var t=[];
for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];
typeof r!="undefined"&&r!=null&&t.push(n+"="+encodeURIComponent(r))}return t.join("&")},its.url.appendUrlParameter=function(t,n,r){var i={};
return i[n]=r,its.url.appendUrlParameters(t,i)},its.url.appendUrlParameters=function(t,n){if(!n)return t;
var r=its.url.queryParamsDict(t);
for(var i in n)r[i]=n[i];
var s=its.url.buildUrlFromMap(r);
return its.url.appendUrlParametersString(its.url.baseUrl(t),s)},its.url.appendUrlParametersString=function(t,n){t||(t="");
if(!n)return t;
var r=t.indexOf("?")===-1?"?":"&";
return t+=r+n,t},its.url.encodeURIAndComponents=function(e){var t=its.url.queryParamsDict(e),n=encodeURI(its.url.baseUrl(e)),r=[];
for(var i in t)r.push(encodeURIComponent(i+"="+t[i]));
return its.url.appendUrlParametersString(n,r.join("&"))},its.url.baseUrl=function(t){if(typeof t=="string"){var n=t.indexOf("?");
if(n===-1){n=t.indexOf("#");
if(n===-1)return t}return t.substring(0,n)}},its.url.originalLocationQueryParams=its.url.queryParamsDict(),its.url.originalLocationHashAnchorParams=its.url.parseHashAnchorParams(),its.url.formRedirect=function(t,n,r){var i=document.createElement("form");
i.method=r?"post":"get",i.target=t,i.action=n,document.body.appendChild(i),i.submit()},its.url.openExternalUrl=function(t,n){var r=document.createElement("a");
r.setAttribute("href",t),n=="main"?r.setAttribute("target",n):r.setAttribute("target","_blank");
var i=document.createEvent("MouseEvents");
i.initMouseEvent("click",!0,!0,document.defaultView,1,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(i)},window.its.cookies||(window.its.cookies={}),its.cookies.EXPIRE_NOW=-1,its.cookies.EXPIRE_SESSION=null,its.cookies.EXPIRE_ONE_SECOND=1,its.cookies.EXPIRE_ONE_MINUTE=its.cookies.EXPIRE_ONE_SECOND*60,its.cookies.EXPIRE_ONE_HOUR=its.cookies.EXPIRE_ONE_MINUTE*60,its.cookies.EXPIRE_ONE_DAY=its.cookies.EXPIRE_ONE_HOUR*24,its.cookies.EXPIRE_ONE_WEEK=its.cookies.EXPIRE_ONE_DAY*7,its.cookies.EXPIRE_ONE_MONTH=its.cookies.EXPIRE_ONE_DAY*31,its.cookies.EXPIRE_SIX_MONTHS=its.cookies.EXPIRE_ONE_MONTH*6-5,its.cookies.EXPIRE_ONE_YEAR=its.cookies.EXPIRE_ONE_DAY*365,its.cookies.EXPIRE_ONE_SIDEREAL_YEAR=its.cookies.EXPIRE_ONE_DAY*365.25,its.cookies.EXPIRE_SIX_MONTHS=its.cookies.EXPIRE_ONE_DAY*180,its.cookies.set=function(t,n,r,i,s){return n&&(n=escape(n)),its.cookies.setUnescaped(t,n,r,i,s)},its.cookies.get=function(t){var n=its.cookies.getUnescaped(t);
return n&&(n=unescape(n)),n},its.cookies.setUnescaped=function(t,n,r,i,s){var o;
i||(i="/");
var u=null;
r&&(u=new Date,u.setTime(u.getTime()+r*1e3));
if(its.sf.Platform&&its.sf.Platform.isITML()){var a={name:t,value:n,path:i,domain:s?s:"",expires:u};
o=its.cookies._setRaw(a)}else{var f=u?u.toUTCString():"",l=s?" domain="+s:"",c=t+"="+n+"; expires="+f+"; path="+i+";"+l;
its.cookies._debugAndUnitTestLastRawSetCookieString=c;
var h=r==void 0||r==its.cookies.EXPIRE_SESSION||r==0,p="sf6"in its&&"Platform"in its.sf6&&its.sf.Platform.device();
if(p&&(h||r<0)){var d=document.cookie=c;
if(h)return d}o=its.cookies._setRaw(c)}return o},its.cookies.getUnescaped=function(t){var n=null,r=its.cookies._debugAndUnitTestCookieGetterWithRawCookieStringOverride||its.cookies._getRaw();
if(r&&t){its.cookies._debugAndUnitTestCookieGetterWithRawCookieStringOverride=null;
var i=r.split(";");
for(var s=i.length-1;
!n&&s>=0;
s--){var o=i[s],u=o.indexOf("=");
if(u>0)if(u+1==o.length)n="";
else{var a=its.string.trim(o.substring(0,u));
a==t&&(its.cookies._debugAndUnitTestLastRawGetCookieString=o,n=its.string.trim(o.substring(u+1)))}}}return n},its.cookies.remove=function(t,n){return its.cookies.setUnescaped(t,".",its.cookies.EXPIRE_NOW,null,n)},"iTunes"in window&&"cookie"in iTunes?its.cookies._cookieOwner="iTunes":typeof itms!="undefined"&&typeof itms.cookie!="undefined"?its.cookies._cookieOwner="itms":its.cookies._cookieOwner="document",its.cookies._setRaw=function(e){return window[this._cookieOwner].cookie=e},its.cookies._getRaw=function(){return window[this._cookieOwner].cookie||""},window.iTSLocalization||(iTSLocalization={}),window.iTSLocalization._strings||(iTSLocalization._strings={}),iTSLocalization.hasLocalizedValue=function(t){var n=iTSLocalization._strings[t];
return its.isDefined(n)},its.loc=function(e,t){var n=iTSLocalization._strings[e];
return typeof n=="undefined"&&(n=e),t&&(n=iTSLocalization.replaceTokens(n,t)),typeof itms=="undefined"&&(n=iTSLocalization.replaceMarkupTokens(n,t)),n},its.locDate=function(e){if(!e)return"";
var t=e.length,n;
if(t>10)n=new Date(e);
else{var r=t>=4?e.slice(0,4):0,i=t>=7?e.slice(5,7):1,s=t>=10?e.slice(8,10):1;
n=new Date(r,i-1,s)}return formatDate(n)},its.locTimeAgo=function(e){if(!e)return"";
var t=e.length,n;
if(t>10)n=new Date(e);
else{var r=t>=4?e.slice(0,4):0,i=t>=7?e.slice(5,7):1,s=t>=10?e.slice(8,10):1;
n=new Date(r,i-1,s)}var o=Math.floor((new Date-n)/1e3),u=Math.floor(o/31536e3);
if(u>1)return its.loc("DV14.TimeAgo.YearsAgo",{time:u});
if(u==1)return its.loc("DV14.TimeAgo.YearAgo",{time:u});
u=Math.floor(o/86400);
if(u>=7){var a=its.locMonthFormatsShort();
return its.loc(a[n.getMonth()],{day:n.getDate()})}if(u>1){var f=its.locWeekdaysShort();
return its.loc(f[n.getDay()])}return u=Math.floor(o/3600),u==1?its.loc("DV14.TimeAgo.HourAgo",{time:u}):u>1?its.loc("DV14.TimeAgo.HoursAgo",{time:u}):its.loc("DV14.TimeAgo.JustNow")},its.secondsAgo=function(e){if(!e)return 0;
var t=e.length,n;
if(t>10)n=new Date(e);
else{var r=t>=4?e.slice(0,4):0,i=t>=7?e.slice(5,7):1,s=t>=10?e.slice(8,10):1;
n=new Date(r,i-1,s)}var o=Math.floor((new Date-n)/1e3);
return o},its.locWeekdaysShort=function(){var e=["DV14.Weekday.Short.Sunday","DV14.Weekday.Short.Monday","DV14.Weekday.Short.Tuesday","DV14.Weekday.Short.Wednesday","DV14.Weekday.Short.Thursday","DV14.Weekday.Short.Friday","DV14.Weekday.Short.Saturday"];
return e},its.locMonthFormatsShort=function(){var e=["DV14.MonthFormat.Short.January","DV14.MonthFormat.Short.February","DV14.MonthFormat.Short.March","DV14.MonthFormat.Short.April","DV14.MonthFormat.Short.May","DV14.MonthFormat.Short.June","DV14.MonthFormat.Short.July","DV14.MonthFormat.Short.August","DV14.MonthFormat.Short.September","DV14.MonthFormat.Short.October","DV14.MonthFormat.Short.November","DV14.MonthFormat.Short.December"];
return e},its.locWithMarkupTokens=function(e,t){return iTSLocalization.replaceMarkupTokens(its.loc(e,t),t)},iTSLocalization._strings._showLocKeys&&(its.loc=function(e){return"+"+e+"+"}),its.locWithCount=function(e,t,n){var r=null,i,s;
return t==0&&(i=e+"."+"zero",iTSLocalization.hasLocalizedValue(i)&&(r=i)),r===null&&(r=e,s=iTSLocalization.pluralCategory(t),s!=="other"&&(i=e+"."+s,iTSLocalization.hasLocalizedValue(i)&&(r=i))),n||(n={}),its.isDefined(n.count)||(n.count=its.formatNumber(t)),its.loc(r,n)},iTSLocalization.replaceTokens=function(t,n){if(n)for(var r in n)if(n.hasOwnProperty(r)){var i="@@"+r+"@@";
t=its.string.replace(t,i,n[r])}return t},iTSLocalization.markupParams={nbsp:"&nbsp;",gt:"&gt;",lt:"&lt;",copy:"©"},iTSLocalization.replaceMarkupTokens=function(t,n){if(t.indexOf("##")>-1){if(n)for(var r in n)iTSLocalization.markupParams[r.toString()]=n[r];
for(var i in iTSLocalization.markupParams){var s="##"+i+"##";
t=t.replace(new RegExp(s,"gi"),iTSLocalization.markupParams[i])}t=t.replace(/##([^##]+)##/gi,"<$1>")}return t},iTSLocalization.localizedResourceUrlForPathKey=function(t,n){n===undefined&&(n=/https:/.test(window.location.protocol));
var r=n?"https://s.mzstatic.com":"http://r.mzstatic.com";
return r+its.loc(t)},typeof itms!="undefined"&&typeof formatNumber!="undefined"?its.formatNumber=function(e){return formatNumber(Number(e))}:its.formatNumber=function(e){if(typeof iTSLocalization.decimalSeparator=="undefined"){var t=iTSLocalization._strings._decimalSeparator;
typeof t=="undefined"&&(t="."),iTSLocalization.decimalSeparator=t,t=iTSLocalization._strings._thousandsSeparator,typeof t=="undefined"&&(t=","),iTSLocalization.thousandsSeparator=t}var n=parseFloat(e).toString().split("."),r=iTSLocalization.thousandsSeparator,i=n[0].split("");
for(var s=i.length-3;
s>0;
s-=3)i.splice(s,0,r);
n[0]=i.join("");
var o=n.join(iTSLocalization.decimalSeparator);
return o},iTSLocalization._pluralCategoryDefault=function(e){return"other"},iTSLocalization._pluralCategoryOne=function(e){return e==1?"one":"other"},iTSLocalization._pluralCategoryArabic=function(e){var t=e>>0;
if(t!=e)return"other";
if(t===0)return"zero";
if(t===1)return"one";
if(t===2)return"two";
var n=t%100;
return n>=11?"many":n>=3?"few":"other"},iTSLocalization._pluralCategoryFrench=function(e){return e<2&&e>=0?"one":"other"},iTSLocalization._pluralCategoryHebrew=function(e){var t=e>>0;
if(t!=e)return"other";
if(t===1)return"one";
if(t===2)return"two";
var n=t%10;
return n==0&&t>10?"many":"other"},iTSLocalization._pluralCategoryPolish=function(e){var t=e>>0;
if(t!=e)return"other";
if(t===1)return"one";
var n=t%10;
if(n<=4&&n>=2){var r=t%100;
if(r>14||r<12)return"few"}return"many"},iTSLocalization._pluralCategoryRomanian=function(e){var t=e>>0;
if(t!=e)return"few";
if(t===0)return"few";
if(t===1)return"one";
var n=e%100;
return n<=19&&n>=1?"few":"other"},iTSLocalization._pluralCategoryRussian=function(e){var t=e>>0;
if(t!=e)return"other";
var n=t%10;
if(n>=5||n==0)return"many";
var r=t%100;
return r<=14&&r>=11?"many":n==1?"one":"few"},iTSLocalization._pluralCategoryFnByLanguage={zh:iTSLocalization._pluralCategoryDefault,id:iTSLocalization._pluralCategoryDefault,ja:iTSLocalization._pluralCategoryDefault,ko:iTSLocalization._pluralCategoryDefault,ms:iTSLocalization._pluralCategoryDefault,th:iTSLocalization._pluralCategoryDefault,vi:iTSLocalization._pluralCategoryDefault,en:iTSLocalization._pluralCategoryOne,ca:iTSLocalization._pluralCategoryOne,da:iTSLocalization._pluralCategoryOne,nl:iTSLocalization._pluralCategoryOne,de:iTSLocalization._pluralCategoryOne,el:iTSLocalization._pluralCategoryOne,fi:iTSLocalization._pluralCategoryOne,hu:iTSLocalization._pluralCategoryOne,it:iTSLocalization._pluralCategoryOne,nb:iTSLocalization._pluralCategoryOne,no:iTSLocalization._pluralCategoryOne,pt:iTSLocalization._pluralCategoryOne,es:iTSLocalization._pluralCategoryOne,sv:iTSLocalization._pluralCategoryOne,tr:iTSLocalization._pluralCategoryOne,ar:iTSLocalization._pluralCategoryArabic,fr:iTSLocalization._pluralCategoryFrench,iw:iTSLocalization._pluralCategoryHebrew,pl:iTSLocalization._pluralCategoryPolish,ro:iTSLocalization._pluralCategoryRomanian,ru:iTSLocalization._pluralCategoryRussian},iTSLocalization.pluralCategory=function(e){if(its.serverData&&its.serverData.constants){var t=iTSLocalization._pluralCategoryFnByLanguage[its.serverData.constants.languageCode];
if(t)return t(e);
if(its.Logger){var n=its.Logger.named("its-base-util");
n.error("missing plural category function for: "+its.serverData.constants.languageCode,!0)}}return"other"},its.isXMLResponse=function(e){var t,n="content-type";
try{t=e&&e.getResponseHeader(n)}catch(r){t=""}return t&&its.string.startsWith(t,"text/xml")},its.plistDictGetValue=function(t,n){if(!t)return;var r=t.childNodes.length,i=null;
for(var s=0;
s<r;
s++){var o=t.childNodes[s];
if(o.nodeType===Node.ELEMENT_NODE){if(i)return o.nodeName==="array"||o.nodeName==="dict"?o:o.textContent;
o.nodeName==="key"&&o.textContent===n&&(i=o)}}},its.plistDictRemoveValue=function(t,n){if(!t)return;var r=t.childNodes.length,i=null,s=null;
for(var o=0;
o<r;
o++){var u=t.childNodes[o];
if(u.nodeType===Node.ELEMENT_NODE){if(i){s=u;
break}u.nodeName==="key"&&u.textContent===n&&(i=u)}}i&&s&&(t.removeChild(i),t.removeChild(s))},its.plistDictAddDict=function(t,n,r){if(!t)return;var i=document.createElement("key");
i.textContent=n;
var s=document.createElement("dict");
if(r&&Array.isArray(r))for(var o=0;
o<r.length;
o++)s.appendChild(r[o]);
t.appendChild(i),t.appendChild(s)},its.plistDictAddKeyValue=function(t,n,r){if(!t)return;var i=document.createElement("key");
i.textContent=n;
var s=document.createElement("string");
s.textContent=r,t.appendChild(i),t.appendChild(s)},its.plistDictAddKeyValuePairs=function(t,n){if(!t)return;for(var r in n){if(!n.hasOwnProperty(r))continue;its.plistDictAddKeyValue(t,r,n[r])}},its._dataCache={},its.property=function(e,t){return t||(returnValue=its._dataCache[e]),returnValue==undefined&&(returnValue=its.value("its.serverData.properties",e,!0,t)),returnValue},its.pageData=function(e,t){return t||(returnValue=its._dataCache[e]),returnValue==undefined&&(returnValue=its.value("its.serverData.pageData",e,!0,t)),returnValue},its.valueOverride=function(e,t){var n;
return e&&(t||(n=its._dataCache[e]),n==undefined&&(n=its.string.unstringify(its.url.originalLocationQueryParams[e])),n==undefined&&(n=its.string.unstringify(sessionStorage.getItem(e)),n===null&&(n=undefined)),n==undefined&&(n=its.string.unstringify(localStorage.getItem(e)),n===null&&(n=undefined)),n==undefined&&window.itsv&&(n=window.itsv[e]),!t&&its.isDefined(e)&&its.isDefined(n)&&(its._dataCache[e]=n)),n},its.value=function(dataPath,key,useOverrideIfAvailable,noCache){its.value.totalCount++;
var returnValue,keyIsDefined=its.isDefined(key),cacheKey=keyIsDefined?key:dataPath;
if(its.isDefined(cacheKey)){useOverrideIfAvailable&&keyIsDefined&&(returnValue=its.valueOverride(key,noCache));
if(returnValue==undefined){its.value.cacheMissCount++,noCache||(returnValue=its._dataCache[cacheKey]);
if(returnValue==undefined){var objectAtDataPath;
try{objectAtDataPath=eval(dataPath)}catch(anException){}if(objectAtDataPath!=undefined)if(keyIsDefined){returnValue=objectAtDataPath[key];
if(returnValue==undefined)try{returnValue=eval(dataPath+"."+key)}catch(anException){}}else returnValue=objectAtDataPath}}!noCache&&its.isDefined(returnValue)&&(its._dataCache[cacheKey]=returnValue)}return returnValue},its.setPropertyOverride=function(e,t,n){return its.setValueOverride(e,t,n)},its.setPageDataOverride=function(e,t,n){return its.setValueOverride(e,t,n)},its.setValueOverride=function(e,t,n){var r=null;
e?its.isDefined(t)||(r="Invalid value"):r="Invalid key";
if(r)throw new Error(r+". Usage: set[Property|Value]Override(key, value, usePermanentStorage)");
var i=null;
delete its._dataCache[e],its.removeValueOverride(e);
var s=null;
return n?s=localStorage:s=sessionStorage,s.setItem(e,t),i=s[e],i},its.removePropertyOverride=function(e){return its.removeValueOverride(e)},its.removePageDataOverride=function(e){return its.removeValueOverride(e)},its.removeValueOverride=function(key){delete its._dataCache[key],sessionStorage.removeItem(key),localStorage.removeItem(key);
try{returnValue=eval("delete window.itsv."+key)}catch(anException){}return key},its.value.totalCount=0,its.value.cacheMissCount=0,its.flushDataCache=function(){its._dataCache={}},its.screenReaderRunning=function(){if(typeof iTunes!="undefined"){if(iTunes.hasOwnProperty("screenReaderRunning"))return iTunes.screenReaderRunning;
if(iTunes.screenReaderRunning&&typeof iTunes.screenReaderRunning=="function")return iTunes.screenReaderRunning()}return!1}(),its.sf.Events={PAGE_LOAD:"its.sf.Events.PAGE_LOAD",PAGE_UNLOAD:"its.sf.Events.PAGE_UNLOAD"},window.its||(window.its={}),its.sf||(its.sf={}),its.notifications={_subscribers:{},_unboundSubscribers:{},subscribe:function(e,t,n,r,i,s){var o=this.senderId(n)||r;
i&&(t.filter=i),s&&(t.eventGroupId=s),o?(this._subscribers[e]||(this._subscribers[e]={}),this._subscribers[e][o]||(this._subscribers[e][o]=[]),this._subscribers[e][o].push(t)):(this._unboundSubscribers[e]||(this._unboundSubscribers[e]=[]),this._unboundSubscribers[e].push(t))},senderId:function(e){var t=null;
return e&&(e.__senderId||(e.__senderId=its.notifications.createSenderId()),t=e.__senderId),t},subscribeToSender:function(e,t,n,r,i){this.subscribe(e,t,n,null,r,i)},subscribeToTarget:function(e,t,n,r,i){this.subscribe(e,t,null,n,r,i)},unsubscribe:function(e,t,n,r){var i=this.senderId(n)||r;
if(this._subscribers[e]&&this._subscribers[e][i]){var s=this._subscribers[e][i].indexOf(t);
s>=0&&this._subscribers[e][i].splice(s,1)}if(this._unboundSubscribers[e]){var s=this._unboundSubscribers[e].indexOf(t);
s>=0&&this._unboundSubscribers[e].splice(s,1)}},publish:function(e,t,n,r,i){var s=this.senderId(n)||r,o=t||{};
o.eventInfo={name:e,sender:n,targetId:r};
var u=function(e){return e.eventGroupId==i};
if(this._subscribers[e]){var a=i&&this._subscribers[e][s]?this._subscribers[e][s].filter(u):this._subscribers[e][s];
this._sendNotification(e,a,o)}var f=i&&this._unboundSubscribers[e]?this._unboundSubscribers[e].filter(u):this._unboundSubscribers[e];
this._sendNotification(e,f,o)},publishToSender:function(e,t,n){this.publish(e,t,n,null)},publishToTarget:function(e,t,n){this.publish(e,t,null,n)},publishToEventGroup:function(e,t,n){this.publish(e,t,null,null,n)},remove:function(e){this._subscribers[e]&&delete this._subscribers[e],this._unboundSubscribers[e]&&delete this._unboundSubscribers[e]},removeEventGroup:function(e){var t=function(t){return t.eventGroupId!=e};
for(var n in this._subscribers){var r=this._subscribers[n];
for(var i in r){var s=r[i],o=s.filter(t);
o.length?this._subscribers[n][i]=o:delete this._subscribers[n][i]}}for(var n in this._unboundSubscribers){var u=this._unboundSubscribers[n],o=u.filter(t);
o.length?this._unboundSubscribers[n]=o:delete this._unboundSubscribers[n]}},getEventGroupSubscribers:function(e){var t={},n={};
for(var r in this._subscribers){var i=this._subscribers[r];
for(var s in i){var o=i[s];
for(var u in o){var a=o[u];
a.eventGroupId==e&&(t[r]||(t[r]={}),t[r][s]||(t[r][s]=[]),t[r][s].push(a))}}}for(var r in this._unboundSubscribers){var f=this._unboundSubscribers[r];
for(var u in f){var a=f[u];
a.eventGroupId==e&&(n[r]||(n[r]=[]),n[r].push(a))}}return{bound:t,unbound:n}},addEventGroupSubscribers:function(e,t){if(this.totalSubscriberCountForGroupId(e)!=0)debugger;if(t&&t.bound&&t.unbound){var n=t.bound,r=t.unbound;
for(var i in n){var s=n[i];
for(var o in s){var u=s[o];
for(var a in u){var f=u[a];
this.subscribeToTarget(i,f,o,f.filter,e)}}}for(var i in r){var l=r[i];
for(var a in l){var f=l[a];
this.subscribe(i,f,null,null,null,e)}}}},totalSubscriberCount:function(){var e=0;
for(var t in this._subscribers){var n=this._subscribers[t];
for(var r in n)e+=n[r].length}for(var t in this._unboundSubscribers)e+=this._unboundSubscribers[t].length;
return e},totalSubscriberCountForGroupId:function(e){var t=function(t){return t.eventGroupId==e},n=0;
for(var r in this._subscribers){var i=this._subscribers[r];
for(var s in i){var o=i[s],u=o.filter(t);
n+=u.length}}for(var r in this._unboundSubscribers){var a=this._unboundSubscribers[r],u=a.filter(t);
n+=u.length}return n},hasListeners:function(e,t,n){var r=this.senderId(t)||n;
return this._subscribers[e]&&this._subscribers[e][r]||this._unboundSubscribers[e]?!0:!1},_sendNotification:function(e,t,n){if(t)for(var r=0,i=t.length;
r<i;
r++){var s=t[r];
if(s){var o=s.filter;
(!o||o(n))&&s(n)}}}},its.notifications.createSenderId=function(){var e=0;
return function(){var t="senderId"+e;
return e++,t}}(),its.sf.DelayedCallQueue.objectReady("its.notifications"),window.its||(window.its={}),its.x||(its.x={}),its.x.util||(its.x.util={}),its.x.util.array||(its.x.util.array={}),its.x.uniqueGuid=1,its.x.attachGuid=function(t){t.__guid||(t.__guid=its.x.uniqueGuid++)},its.x.browserName=function(){return its.x.isOpera()?"opera":its.x.isKhtml()?"khtml":its.x.isSafari()?"safari":its.x.isChrome()?"chrome":its.x.isWebKit()?"webkit":its.x.isIE7()?"ie7":its.x.isIE8()?"ie8":its.x.isIE()?"ie":its.x.isFirefox()?"firefox":"unknown"},its.x.initBrowserDetect=function(){if(typeof its.x.initBrowserDetect.browser=="undefined"||!its.x.initBrowserDetect.browser){var t=navigator,n=t.userAgent,r=t.appVersion,i=parseFloat(r),s={};
s.isOpera=n.indexOf("Opera")>=0?i:undefined,s.isKhtml=r.indexOf("Konqueror")>=0?i:undefined,s.isWebKit=parseFloat(n.split("WebKit/")[1])||undefined,s.isChrome=parseFloat(n.split("Chrome/")[1])||undefined,s.isFirefox=/Firefox[\/\s](\d+\.\d+)/.test(n);
var o=Math.max(r.indexOf("WebKit"),r.indexOf("Safari"),0);
if(o&&!s.isChrome){s.isSafari=parseFloat(r.split("Version/")[1]);
if(!s.isSafari||parseFloat(r.substr(o+7))<=419.3)s.isSafari=2}if(document.all&&!s.isOpera){s.isIE=parseFloat(r.split("MSIE ")[1])||undefined;
var u=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),a=-1;
u.exec(n)!=null&&(a=parseFloat(RegExp.$1)),s.isIE7=a>=7&&a<8,s.isIE8=a>=8&&a<9}its.x.initBrowserDetect.browser=s}return its.x.initBrowserDetect.browser},its.x.isIE=function(){return its.x.initBrowserDetect().isIE},its.x.isIE7=function(){return its.x.initBrowserDetect().isIE7},its.x.isIE8=function(){return its.x.initBrowserDetect().isIE8},its.x.isOpera=function(){return its.x.initBrowserDetect().isOpera},its.x.isKhtml=function(){return its.x.initBrowserDetect().isKhtml},its.x.isWebKit=function(){return its.x.initBrowserDetect().isWebKit},its.x.isChrome=function(){return its.x.initBrowserDetect().isChrome},its.x.isSafari=function(){return its.x.initBrowserDetect().isSafari},its.x.isFirefox=function(){return its.x.initBrowserDetect().isFirefox},its.x.PLATFORMS||(its.x.PLATFORMS={}),its.x.PLATFORMS.Windows="Windows",its.x.PLATFORMS.MacOS="MacOS",its.x.PLATFORMS.Linux="Linux",its.x.PLATFORMS.Unix="Unix",its.x.PLATFORMS.iOS="iOS",its.x.PLATFORMS.Android="Android",its.x.__detectOS=function(){var t=undefined;
return navigator.appVersion.indexOf("Win")!=-1?t=its.x.PLATFORMS.Windows:navigator.appVersion.indexOf("Mac")!=-1?t=its.x.PLATFORMS.MacOS:navigator.appVersion.indexOf("X11")!=-1?t=its.x.PLATFORMS.Unix:navigator.appVersion.indexOf("Linux")!=-1?t=its.x.PLATFORMS.Linux:navigator.appVersion.indexOf("iOS")!=-1?t=its.x.PLATFORMS.iOS:navigator.appVersion.indexOf("Android")!=-1&&(t=its.x.PLATFORMS.Android),t},its.x.isWindows=function(){return its.x.__detectOS()==its.x.PLATFORMS.Windows},its.x.isMacOS=function(){return its.x.__detectOS()==its.x.PLATFORMS.MacOS},its.x.isIOS=function(){return its.x.__detectOS()==its.x.PLATFORMS.iOS},its.x.isAndroid=function(){return its.x.__detectOS()==its.x.PLATFORMS.Android},its.x.util.array.indexOf=function(t,n){var r=-1;
if(t.indexOf)r=t.indexOf(n);
else for(var i=0;
i<t.length&&r==-1;
i++)t[i]==n&&(r=i);
return r},its.x.util.array.shallowCopy=function(t){return t.slice(0)},its.x.notifyOfDOMContentLoaded=function(t){var n=!0;
return its.x.isIE()?n=window.attachEvent("onload",t):document.addEventListener("DOMContentLoaded",t,!1),n},its.x.addEventListener=function(t,n,r){t.addEventListener?t.addEventListener(n,r,!1):t.attachEvent&&t.attachEvent("on"+n,function(e){r.call(t,e)})},ITSEvent.prototype.preventDefault=function(){this._preventDefaultFlag=!0},ITSEvent.prototype.shouldPreventDefault=function(){return this._preventDefaultFlag},its.x.extendWithEventDispatching=function(t){t.__eventToListenersMap||(t.__eventToListenersMap={},t.__additionalDispatchers=new Array,Class.extend(t,its.x._ITSEventDispatcher))},its.x._ITSEventDispatcher=function(){},its.x._ITSEventDispatcher.itsAddEventListener=function(t,n){var r=!1;
if(typeof n=="function"){var i=this.__eventToListenersMap[t];
i||(i=new Array,this.__eventToListenersMap[t]=i),its.x.util.array.indexOf(i,n)==-1&&(i.push(n),r=!0)}return r},its.x._ITSEventDispatcher.itsRemoveEventListener=function(t,n){var r=this.__eventToListenersMap[t];
if(r){var i=its.x.util.array.indexOf(r,n);
i>=0&&r.splice(i,1)}},its.x._ITSEventDispatcher.itsHasEventListeners=function(t){if(!t)throw new Error("itsHasEventListeners called with null event");
var n=this.__eventToListenersMap[t.eventName];
return n&&n.length||this.__additionalDispatchers&&this.__additionalDispatchers.length},its.x._ITSEventDispatcher.itsDispatchEvent=function(t){var n=this.__eventToListenersMap[t.eventName];
if(n)for(var r=0;
r<n.length;
r++)try{n[r].apply(this,arguments)}catch(i){console&&console.error&&i.line&&i.sourceURL&&console.error(i+"    See line "+i.line+" of "+i.sourceURL)}if(this.__additionalDispatchers.length>0)for(var r=0;
r<this.__additionalDispatchers.length;
r++)try{this.__additionalDispatchers[r].itsDispatchEvent(t)}catch(i){console&&console.error&&i.line&&i.sourceURL&&console.error(i+"    See line "+i.line+" of "+i.sourceURL)}},its.x._ITSEventDispatcher.itsDelegateEvents=function(t){its.x.extendWithEventDispatching(t),this.__additionalDispatchers.push(t)},its.x.dynaLoadResourceFile=function(t,n){var r=!1;
if(its&&its.property&&its.property("DynaLoader.allowDynaLoading")){its._dynaLoadedFiles||(its._dynaLoadedFiles=[]);
if(t&&!its.contains(its._dynaLoadedFiles,t)){var i=null,s=null,o=null,i=document.getElementsByTagName("head");
i&&(s=i[0]),s&&(o=s.firstChild);
if(o){its._dynaLoadedFiles.push(t);
var u=its.contains(t,".js")||its.contains(t,".jsz")?"js":"css",a=u=="js"?"SCRIPT":"LINK",f=u=="js"?"text/javascript":"text/css",l=document.createElement(a);
l.onload=l.onreadystatechange=n,l.type=f,u=="css"?(l.rel="stylesheet",l.href=t):(l.charset="utf-8",l.src=t),its.x.element.insertBeforeElement(o,l),r=!0}else window.console&&console.log&&(console.log("its.x.dynaLoadResourceFile: Waiting for DOM <head> section to be created before fetching resource: "+t),window.setTimeout(function(){its.x.dynaLoadResourceFile(t,n)},200))}else t&&(r=!0)}return r},window.its||(window.its={}),its.x||(its.x={}),its.x.element||(its.x.element={}),its.x.element.logger=function(){return its.x.element.loggerInstance?its.x.element.loggerInstance:(window.ITSLogger&&ITSLogger.level?its.x.element.loggerInstance=new ITSLogger("ITSXBaseElement"):its.Logger&&(its.x.element.loggerInstance=its.Logger.named("ITSXBaseElement")),its.x.element.loggerInstance)},its.rootResourcesPathFromCssFilename=function(t){var n=null;
for(var r=0;
!n&&r<document.styleSheets.length;
r++){var i=document.styleSheets[r];
if(i.href){var s=i.href.indexOf("stylesheets/"+t);
s==-1&&(s=i.href.indexOf(t)),s!=-1&&(n=i.href.substring(0,s))}}return n},its.imagesPath=function(t){var n=null,r=its.rootResourcesPathFromCssFilename(t);
return r&&(n=r+"images/"),n},its.x.uniquifyId=function(t){var n=t,r=100;
do n=t+"-"+r++;
while(document.getElementById(n));
return n},its.x.removeClassNames=function(t,n){for(var r=0;
r<t.length;
r++)its.x.element.removeClassName(t[r],n)},its.x.element._printAll=function(){for(var t in its.x.element){var n=its.x.element[t],r=its.dev.parseFunctionArgsToArray(n),i=r.shift(),s=r.join(", ");
console.log("Element.prototype."+t+"("+s+")")}},its.x.element.altTag=function(t){return t.getAttribute("alt")},its.x.element.isOverflowing=function(t){var n=its.x.element.getComputedStyleProperty(t,"overflow");
if(!n||n==="visible")t.style.overflow="hidden";
var r=t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight;
return r},its.x.element.isShowingEllipsis=function(t){var n=its.x.element.isOverflowing(t),r="ellipsis",i="532",s=its.webkitVersion();
its.webkitVersionCompare(s,i)>0&&(r=its.x.element.getComputedStyleProperty(t,"text-overflow"));
var o=r=="ellipsis";
return n&&o},its.x.element.getAttributesStartingWith=function(t,n){var r=null;
for(var i=0;
i<t.attributes.length;
i++){var s=t.attributes.item(i).nodeName;
its.string.startsWith(s,n)&&(r==null&&(r=[]),r.push(s))}return r},its.x.element.removeAttributes=function(t,n){if(n)for(var r=0;
r<n.length;
r++)t.removeAttribute(n[r])},its.x.element.removeAttributesStartingWith=function(t,n){var r=its.x.element.getAttributesStartingWith(t,n);
its.x.element.removeAttributes(t,r)},its.x.element.getIntAttribute=function(t,n){var r=t.getAttribute(n);
return r!=null&&(r=its.string.toInt(r)),r},its.x.element.getBooleanAttribute=function(t,n){var r=t.getAttribute(n);
return r!=null?"true"==r:!1},its.x.element.getAttributeWithDefault=function(t,n,r){var i=t.getAttribute(n);
if(i===null||i===undefined)i=r;
return i},its.x.element.getAttributeOfElementOrAncestor=function(e,t){return its.x.element.elementOrAncestorByFunction(e,function(e){return e.hasAttribute(t)})},its.x.element.getAttributeValuesOfChildren=function(t,n){var r=[];
for(var i=0;
i<t.children.length;
i++){var s=t.children[i].getAttribute(n);
s&&r.push(s)}return r},its.x.element.hasClassName=function(t,n){return(new RegExp("(?:^|\\s+)"+n+"(?:\\s+|$)")).test(t.className)},its.x.element.hasClassNames=function(t,n){for(var r=0;
r<n.length;
r++)if(!its.x.element.hasClassName(t,n[r]))return!1;
return!0},its.x.element.addClassName=function(t,n){its.isEmpty(its.string.trim(n))||its.x.element.hasClassName(t,n)||(t.className&&t.className!=""?t.className=t.className+" "+n:t.className=n)},its.x.element.classNameStartingWith=function(t,n){var r=its.x.element.classNamesStartingWith(t,n),i=r.length?r[0]:null;
return i},its.x.element.classNamesStartingWith=function(t,n){var r=t.className.split(" "),i=[];
for(var s=0;
s<r.length;
s++)its.string.startsWith(r[s],n)&&i.push(r[s]);
return i},its.x.element.removeClassNamesStartingWith=function(t,n){var r=its.x.element.classNamesStartingWith(t,n);
if(r&&r.length)for(var i=0;
i<r.length;
i++)its.x.element.removeClassName(t,r[i])},its.x.element.removeClassName=function(t,n){if(its.x.element.hasClassName(t,n)){var r=t.className;
t.className=its.string.trim(r.replace(new RegExp("(?:^|\\s+)"+n+"(?:\\s+|$)","g")," "))}},its.x.removeClassNames=function(t,n,r){for(var i=0;
i<t.length;
i++)(!r||t[i]!=r)&&its.x.element.removeClassName(t[i],n)},its.x.element.toggleClassName=function(t,n){its.x.element[its.x.element.hasClassName(t,n)?"removeClassName":"addClassName"](t,n)},its.x.element.replaceClassName=function(t,n,r){its.x.element.removeClassName(t,n),its.x.element.addClassName(t,r)},its.x.element.getComputedStyleProperty=function(t,n){return getComputedStyle(t).getPropertyValue(n)},its.x.element.getPosition=function(t){var n=t,r=new Object;
r.left=r.top=0;
if(n.offsetParent)do r.left+=n.offsetLeft,r.top+=n.offsetTop;
while(n=n.offsetParent);
n=t;
do{if(n===document.body)break;r.left-=n.scrollLeft!=undefined?n.scrollLeft:0,r.top-=n.scrollTop!=undefined?n.scrollTop:0}while(n=n.parentNode);
return r.right=r.left+t.offsetWidth,r.bottom=r.top+t.offsetHeight,r},its.x.element.center=function(t,n){n=="fixed"?t.style.position="fixed":t.style.position="absolute",t.style.top="50%",t.style.left="50%",t.style.marginTop=0,t.style.marginTop=-(its.x.element.offsetHeightPlusMargin(t)/2)+"px",t.style.marginLeft=0,t.style.marginLeft=-(its.x.element.offsetWidthPlusMargin(t)/2)+"px"},its.x.element.offsetWidthPlusMargin=function(t){return t.offsetWidth+its.x.element.marginWidth(t)},its.x.element.offsetWidthLessPadding=function(t){return t.offsetWidth-its.x.element.paddingWidth(t)},its.x.element.usableContentWidth=function(t){return t.clientWidth-its.x.element.paddingWidth(t)},its.x.element.marginWidth=function(t){return its.string.toInt(its.x.element.getComputedStyleProperty(t,"margin-left"))+its.string.toInt(its.x.element.getComputedStyleProperty(t,"margin-right"))},its.x.element.paddingWidth=function(t){return its.string.toInt(its.x.element.getComputedStyleProperty(t,"padding-left"))+its.string.toInt(its.x.element.getComputedStyleProperty(t,"padding-right"))},its.x.element.offsetHeightPlusMargin=function(t){return t.offsetHeight+its.x.element.marginHeight(t)},its.x.element.offsetHeightLessPadding=function(t){return t.offsetHeight+its.x.element.paddingHeight(t)},its.x.element.marginHeight=function(t){return its.string.toInt(its.x.element.getComputedStyleProperty(t,"margin-top"))+its.string.toInt(its.x.element.getComputedStyleProperty(t,"margin-bottom"))},its.x.element.paddingHeight=function(t){return its.string.toInt(its.x.element.getComputedStyleProperty(t,"padding-top"))+its.string.toInt(its.x.element.getComputedStyleProperty(t,"padding-bottom"))},its.x.element.lineCount=function(t){return its.string.toInt(its.x.element.getComputedStyleProperty(t,"height"))/its.string.toInt(its.x.element.getComputedStyleProperty(t,"line-height"))},its.x.element.webkitLineClamp=function(t){return its.string.toInt(its.x.element.getComputedStyleProperty(t,"-webkit-line-clamp"))},its.x.element.isMultiLineTruncated=function(t){return its.x.element.webkitLineClamp(t)!=null&&t.clientHeight<t.scrollHeight},its.x.element.isMultiLineTruncatedK2=function(t){return its.x.element.webkitLineClamp(t)!=null&&t.clientHeight<t.scrollHeight},its.x.element.isVisible=function(t,n){var r=t,i=!0,s=null,o=null,u=null,a=null,f=its.x.element.logger(),l=!1,c=null,h=r===document;
while(i&&r&&!h){c=null,s=getComputedStyle(r);
if(s){o=s.getPropertyValue("display"),u=s.getPropertyValue("visibility"),a=s.getPropertyValue("opacity"),o==="none"?c="display":u==="hidden"?c="visibility":a=="0"&&(c="opacity");
if(c){i=!1;
var p=window.ITSLogger&&ITSLogger.level?ITSLogger.level()==ITSLogger.DEBUG:its.Logger&&f.isAnyDebugLevel?f.isAnyDebugLevel():!1;
if(p){var d=l?"ancestor.":"element.";
f.debug("isVisible: "+d+"notVisible due to "+c)}}}r=n?r.parentNode:null,r&&(l=!0)}return i},its.x.element.isOnscreen=function(t){var n=its.x.element.isVisible(t),r=its.x.element.logger();
if(n){var i=!1,s=t.getBoundingClientRect(),o={top:s.top,bottom:s.bottom,left:s.left,right:s.right,width:s.width,height:s.height},u=t.parentNode,a=parseInt(t.getAttribute("width"),10),f=parseInt(t.getAttribute("height"),10);
a&&(o.width=a,o.right=o.left+a),f&&(o.height=f,o.bottom=o.top+f);
while(u!==document&&n&&u&&!i&&its.x.element.isVisible(u)){var l=getComputedStyle(u);
if(l&&l.getPropertyValue("position")=="absolute")i=!0;
else{var c=u.getBoundingClientRect?u.getBoundingClientRect():null;
if(c){var h=!its.geometry.doesRectIntersectRect(o,c);
h&&u.style.overflow=="hidden"&&(n=!1),n||r.debug("isOnscreen: elementIsOnscreen = false due to child out of overflow:hidden ancestor")}u=u.parentNode}}if(n){var p={top:0,bottom:window.innerHeight,left:0,right:window.innerWidth};
n=its.geometry.doesRectIntersectRect(o,p),n||r.debug("isOnscreen: elementIsOnscreen = false due to element being outside of window bounds")}}else r.debug("isOnscreen: image.isVisible() = false");
return n},its.x.element.rectString=function(t,n){var r=t.getBoundingClientRect();
return n?n+=". ":n="",n+t.tagName+" - left:"+r.left+", right:"+r.right+", top:"+r.top+", bottom:"+r.bottom},its.x.element.show=function(t,n){t.style.display=n||"block";
var r=t;
setTimeout(function(){r.style.opacity="1"},0)},its.x.element.hide=function(t){var n=function(e){e.target.style.display="none",e.target.removeEventListener("webkitTransitionEnd",n,!1)};
t.style.opacity="0",its.x.element.getComputedStyleProperty(t,"-webkit-transition-duration")!=="0s"?t.addEventListener("webkitTransitionEnd",n,!1):t.style.display="none"},its.x.element.toggle=function(t,n){var r=t.style.display=="none";
return r?its.x.element.show(t,n):its.x.element.hide(t),r},its.x.element.moveToBottom=function(t){var n=t.parentNode;
n&&(its.x.element.remove(t),n.appendChild(t))},its.x.element.insertBeforeElement=function(t,n){n&&t.parentNode&&t.parentNode.insertBefore(n,t)},its.x.element.insertAfter=function(t,n){n&&t.parentNode&&t.parentNode.insertBefore(n,t.nextSibling)},its.x.element.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)},its.x.element.clear=function(t){t.innerHTML=""},its.x.element.replace=function(t,n){if(t.parentNode)return t.parentNode.replaceChild(n,t)},its.x.element.localSearch=function(t,n){var r=t,i;
do i=r.querySelectorAll(n),r=r.parentNode;
while(r&&r!=document&&i.length<1);
return i},its.x.element.elementOrAncestorByFunction=function(t,n){while(t&&t!=document){if(n(t))return t;
t=t.parentNode}return null},its.x.element.parentByAttributeName=function(t,n){return its.x.element.elementOrAncestorByFunction(t.parentNode,function(e){return e.hasAttribute(n)})},its.x.element.parentByClassName=function(t,n){return its.x.element.elementOrAncestorByFunction(t.parentNode,function(e){return its.x.element.hasClassName(e,n)})},its.x.element.parentByTagName=function(t,n){return its.x.element.elementOrAncestorByFunction(t.parentNode,function(e){return e.tagName.toLowerCase()===n.toLowerCase()})},its.x.element.parentBySelector=function(t,n){var r=document.querySelectorAll(n),s=r.length;
return its.x.element.elementOrAncestorByFunction(t,function(e){for(i=0;
i<s;
i++)if(r[i]===e)return!0;
return!1})},its.x.element.containsElement=function(t,n){return its.x.element.elementOrAncestorByFunction(n,function(e){return e===t})||!1},its.x.element.itsInnerText=function(t,n){var r=t.innerText;
return its.isEmpty(r)&&typeof t.textContent!="undefined"&&(r=t.textContent,n||(r=its.string.trim(r))),r},window.its||(window.its={}),its.files||(its.files={}),its.files["its-base-element.js"]=!0,String.prototype.toInt=function(){return its.string.toInt(this)},Number.prototype.addWithLoopingMax=function(t,n){var r=(this+t)%(n+1);
return r<0&&(r=n+r+1),r},Number.prototype.times=function(t,n){for(var r=0;
r<this;
r++)t.call(n,r)};
var EachLoopBreak="break",EachLoopContinue="continue";
(function(){var e=[NodeList,HTMLCollection,Array],t=e.length;
for(var n=0;
n<t;
n++){var r=e[n];
r.prototype.each=function i(i,e){var t=this.length;
for(var n=0;
n<t;
n++){var r=i.call(e,this[n],n);
if(r!=undefined){if(r==EachLoopBreak)break;if(r==EachLoopContinue)continue}}return this},r.prototype.except=function(t,n,r){var i=this.length;
for(var s=0;
s<i;
s++)this[s]!==t&&n.call(r,this[s],s)},r.prototype.first=function(){if(this[0])return this[0]},r.prototype.last=function(){var t=this.length-1;
if(this[t])return this[t]},r.prototype.empty=function(){return this.length==0},r.prototype.includes=function s(e){var s=!1;
return this.each(function(t){e===t&&(s=!0)}),s},r.prototype.index=function o(e){var t=this.length,o=-1;
for(var n=0;
n<t;
n++)if(this[n]===e){o=n;
break}return o},r.prototype.map||(r.prototype.map=function(t){var n=new Array;
return this.each(function(e){n.push(t(e))}),n}),r.prototype.mapAttribute=function(t){return this.map(function(e){return e[t]})},r.prototype.select=function(t){var n=new Array;
return this.each(function(e){var r=t(e);
r&&n.push(e)}),n},r.prototype.remove=function(t){if(t.each)return t.each(function(e){this.remove(e)},this),this;
var n=this.index(t);
return n>=0&&this.splice(n,1),this},r.prototype.addEventListeners=function(t,n,r){this.each(function(e){e.addEventListener(t,n,r)})},r.prototype.removeEventListeners=function(t,n,r){this.each(function(e){e.removeEventListener(t,n,r)})},r.prototype.hide=function(){this.each(function(e){e.hide()})},r.prototype.show=function(){this.each(function(e){e.show()})},r.prototype.max=function(){return Math.max.apply(Math,this)},r.prototype.min=function(){return Math.min.apply(Math,this)},r.prototype.sum=function u(){var u=0;
return this.each(function(e){u+=e}),u},r.prototype.toArray=function(){var t=new Array;
return this.each(function(e){t.push(e)}),t},r.prototype.addClassNames=function(t){this.each(function(e){e.addClassName(t)})},r.prototype.removeClassNames=function(t){this.each(function(e){e.removeClassName(t)})}}})(),Array.prototype.pushEach=function(e){var t=e.length;
for(var n=0;
n<t;
n++)this.push(e[n])},CSSStyleDeclaration.prototype.animation_transition=function(e,t,n){e=="transform"&&(e="-webkit-transform"),this.webkitTransition=e+" "+t/1e3+"s "+n},CSSStyleDeclaration.prototype.clear_animation_transition=function(e){this.animation_transition(e,0,"")},CSSStyleDeclaration.prototype.animation_translateY=function(e){this.webkitTransform="translate3d(0,"+e+",0)"},CSSStyleDeclaration.prototype.animation_translateX=function(e){this.webkitTransform="translate3d("+e+",0,0)"},CSSStyleDeclaration.prototype.topInPx=function(e){this.top=e+"px"},CSSStyleDeclaration.prototype.bottomInPx=function(e){this.bottom=e+"px"},function(){for(var e in its.x.element)Element.prototype[e]=function(e){return function(){var t=its.toArray(arguments);
return t.unshift(this),e.apply(this,t)}}(its.x.element[e])}(),window.its||(window.its={}),window.its.ui||(window.its.ui={}),its.ui.Constants={},its.ui.Constants.SRC_ATTRIBUTE_KEY="src",its.ui.Constants.SRC_SWAP_ATTRIBUTE_KEY_PREFIX="src-swap-",its.ui.Attributes={},its.ui.Attributes.SRC_SWAP_ATTRIBUTE_KEY="src-swap",its.ui.Attributes.SRC_LOAD_MANUAL_ON_DEMAND_MODIFIER_ATTRIBUTE_KEY="src-load-manual-on-demand",its.ui.Attributes.SRC_LOAD_AUTO_AFTER_DOM_LOAD_MODIFIER_ATTRIBUTE_KEY="src-load-auto-after-dom-load",its.ui.Attributes.SRC_LOAD_AUTO_AT_PAGE_LOAD_MODIFIER_ATTRIBUTE_KEY="src-load-auto-at-page-load",its.ui.Attributes.SRC_LOAD_AUTO_AFTER_PAGE_LOAD_MODIFIER_ATTRIBUTE_KEY="src-load-auto-after-page-load",its.ui.Attributes.SRC_LOAD_AUTO_AFTER_PAGE_LOAD_IF_NOT_ONSCREEN_MODIFIER_ATTRIBUTE_KEY="src-load-auto-after-page-load-if-not-onscreen",its.ui.Selectors={},its.ui.Selectors.SRC_SWAP_SELECTOR="img["+its.ui.Attributes.SRC_SWAP_ATTRIBUTE_KEY+"]",its.ui.Debug={},its.ui.Debug.SRC_WAS_FORCED_ATTRIBUTE_KEY="src-was-force-unhidden",its.ui.Debug.SRC_WAS_DELAYED_ATTRIBUTE_KEY="src-was-delayed",its.ui.Debug.SRC_WAS_INTENTIONALLY_LEFT_UNSET="src-was-intentionally-left-unset",its.ui.Debug.SRC_WAS_AUTO_DELAYED_ATTRIBUTE_KEY="src-was-auto-delayed-with-onscreen-test",its.ui.Debug.SRC_WAS_DELAYED_FOR_SWAPPING_ATTRIBUTE_KEY="src-was-delayed-for-swapping",its.ui.Debug.SRC_WAS_SWAPPED_ATTRIBUTE_KEY="src-was-swapped",its.ui.setDebugAttribute=function(t,n,r){its.kit&&its.kit.isDebugEnabled()&&t.setAttribute(n,r)},its.ui.isImageComplete=function(t){var n=t.complete&&t.src&&!its.contains(t.src,"/p.png");
return n=t.complete&&t.src,n},its.ui.hiddenImagesWithAncestor=function(t){var n=null;
return!t||!t.querySelectorAll?its.client.log("error calling its.ui.hiddenImagesWithAncestor for element: "+t):n=t.querySelectorAll(its.ui.Selectors.SRC_SWAP_SELECTOR),n},its.ui.unhideImages=function(t,n,r){t&&t.each(function(t){var i=t.getAttribute(its.ui.Attributes.SRC_SWAP_ATTRIBUTE_KEY),s=i&&(n||t.getAttribute(its.ui.Attributes.SRC_LOAD_MANUAL_ON_DEMAND_MODIFIER_ATTRIBUTE_KEY)!=null||its.kit.domLoaded()&&t.getAttribute(its.ui.Attributes.SRC_LOAD_AUTO_AFTER_DOM_LOAD_MODIFIER_ATTRIBUTE_KEY)!=null||its.kit.pageLoaded()&&t.getAttribute(its.ui.Attributes.SRC_LOAD_AUTO_AT_PAGE_LOAD_MODIFIER_ATTRIBUTE_KEY)!=null||its.kit.afterPageLoaded()&&t.getAttribute(its.ui.Attributes.SRC_LOAD_AUTO_AFTER_PAGE_LOAD_MODIFIER_ATTRIBUTE_KEY)!=null);
if(s){var o=null;
for(var u in its.ui.Attributes){var a=its.ui.Attributes[u];
!o&&a!=its.ui.Attributes.SRC_SWAP_ATTRIBUTE_KEY&&t.getAttribute(a)!=null&&(o=a),t.removeAttribute(a)}o||(o="true"),its.ui.setDebugAttribute(t,its.ui.Debug.SRC_WAS_DELAYED_ATTRIBUTE_KEY,o);
var f=!1;
if(its.property("sfdImageLeaveSrcBlankForTimingTestsForLoadType")){var l=its.propertys("sfdImageLeaveSrcBlankForTimingTestsForLoadType");
f=l&&l.toLowerCase()=="all",f||(f=l==o);
if(!f){var c=its.property("sfdImageLeaveSrcBlankForTimingTestsForLoadType")==its.ui.Attributes.SRC_LOAD_AUTO_AFTER_PAGE_LOAD_IF_NOT_ONSCREEN_MODIFIER_ATTRIBUTE_KEY;
f=t.getAttribute(its.ui.Debug.SRC_WAS_AUTO_DELAYED_ATTRIBUTE_KEY)&&c&&o==its.ui.Attributes.SRC_LOAD_AUTO_AFTER_PAGE_LOAD_MODIFIER_ATTRIBUTE_KEY}}f?(its.client.log("image src is null"),its.ui.setDebugAttribute(t,its.ui.Debug.SRC_WAS_INTENTIONALLY_LEFT_UNSET,"true")):(its.ui.markImageCompleteAfterLoad(t),t.src=i),n&&its.ui.setDebugAttribute(t,its.ui.Debug.SRC_WAS_FORCED_ATTRIBUTE_KEY,"true"),r&&r(t)}})},its.ui.unhideImagesWithAncestor=function(t,n,r){its.ui.unhideImages(its.ui.hiddenImagesWithAncestor(t),n,r)},its.ui.markImageCompleteAfterLoad=function(t){if(!its.ui.isImageComplete(t)){var n=function(){this.addClassName("complete")};
t.addEventListener("load",n),t.addEventListener("error",n),t.addEventListener("abort",n)}else t.addClassName("complete")},its.ui.markImagesCompleteAfterLoad=function(t){t.each(function(e){its.ui.markImageCompleteAfterLoad(e)})},its.ui.markImagesWithAncestorCompleteAfterLoad=function(t){if(!t||!t.querySelectorAll){its.client.log("error calling its.ui.markImagesWithAncestorCompleteAfterLoad for rootElement");
return}var n=t.querySelectorAll("img[src]:not(.complete)");
its.ui.markImagesCompleteAfterLoad(n)},its.ui.baseImagePath=function(t){var n=document.querySelector("meta[name='resource-image-path']");
if(n){var r=n.getAttribute("content");
return t&&r.indexOf("/"+t+"/")==-1&&(r=r.replace(/\/[^\/]+\/images\//,"/"+t+"/images/")),r}return null},its.ui.pathForImage=function(t,n){var r=its.ui.baseImagePath(t);
return r!=null?r+n:n},its.ui.fadeOutAndRemoveFromDom=function(e){e&&(e.style.webkitTransitionProperty="opacity",e.style.webkitTransitionDuration="0.5s",setTimeout(function(){e.style.opacity="0"},0),setTimeout(function(){e.parentElement.removeChild(e)},500))},function(e,t){e.its||(e.its={});
var n=e.its;
if(n.kit)return;n.kit={_domContentLoaded:!1,_pageLoaded:!1,_afterPageLoaded:!1,_preloadListeners:[],_domReadyListeners:[],_loadListeners:[],_afterLoadListeners:[],_domInsertedListeners:null,preload:function(){s.preload()},onPreload:function(e){this._preloadListeners.push(e)},onDomReady:function(e){this._domContentLoaded?e():this._domReadyListeners.push(e)},onLoad:function(e){this._pageLoaded?e():this._loadListeners.push(e)},onAfterLoad:function(e){this._afterPageLoaded?e():this._afterLoadListeners.push(e)},onDomInserted:function(e){var t=this._domInsertedListeners=this._domInsertedListeners||[];
t.push(e)},createController:function(e,t){r._debug.isEnabled()&&r._debug.controllerNameMatchesFilter(e)&&console.log("Creating controller matching filterControllerNameSubstring: "+e);
var n=this._util.newController(e,t),i=n.newClass();
return this._controllers[n.name]=i,this._domContentLoaded&&(r._debug.isEnabled()&&r._debug.controllerNameMatchesFilter(e)&&console.log("Controller created after DOMContentLoaded... initting manually: "+e),i._init(),i._bindOnRootElement(document),i.domReady&&i.domReady()),i.init&&i.init(),i},createMixin:function(e,t){var n=this._util.newMixin(e,t);
this._mixins[n.name]=n.newClass()},preventBinding:function(e){e[r._util.preventItsKitBinding]=!0},sendToController:function(e,t){i.typeOfObject(e)=="String"&&(e=r._util.massageControllerName(e));
var n=i.argumentsToArray(arguments,2);
e=this._controllers[e];
if(e&&t in e)return e[t].apply(e,n)},disableBinding:function(){s.ignoreDOMNodeInserted=!0},enableBinding:function(t){delete s.ignoreDOMNodeInserted,t&&n.kit.rebind()},rebind:function(t){s.bindAndInitOnElement(document.documentElement),t||s._notifyOfDomInserted(null)},bindAfter:function(t,n){this.disableBinding(),t&&(n=n||null,t.call(n)),this.enableBinding(!0)},domLoaded:function(){return n.kit._domContentLoaded},pageLoaded:function(){return n.kit._pageLoaded},afterPageLoaded:function(){return n.kit._afterPageLoaded},debug:function(e,t){e=i.optionalBooleanArg(e,!0);
var n=!1;
sessionStorage&&(sessionStorage["its.kit.debug.enabled"]=e.toString(),t?sessionStorage["its.kit.debug.filterControllerNameSubstring"]=t:sessionStorage.removeItem("its.kit.debug.filterControllerNameSubstring")),e&&(n=r._debug.printAll(),n||(t?console.log("WARNING: No controllers found matching: "+t):console.log("WARNING: No controllers found."))),r._debug.isEnabled=r._debug._isEnabled},isDebugEnabled:function(){return r._debug.isEnabled()},util:{extend:function(e,t,n){function o(t){for(var r in t){var i=t.__lookupGetter__(r),s=t.__lookupSetter__(r);
if(n||!(r in e))i||s?(i&&e.__defineGetter__(r,i),s&&e.__defineSetter__(r,s)):e[r]=t[r]}}var r;
t=this.arrayify(t);
if(t)for(var i=0,s=t.length;
i<s;
i++)o(t[i]);
return e},optionalArg:function(e,t){return e?e:t},optionalTypedArg:function(e,t,n){return i.typeOfObject(t)===e?t:n},optionalBooleanArg:function(e,t){return i.optionalTypedArg("Boolean",e,t)},optionalStringArg:function(e,t){return i.optionalTypedArg("String",e,t)},optionalNumberArg:function(e,t){return i.optionalTypedArg("Number",e,t)},optionalObjectArg:function(e,t){return i.optionalTypedArg("Object",e,t)},appendAttribute:function(e,t,n,r){var s=e.hasAttribute(t)?e.getAttribute(t)+i.optionalStringArg(r," ")+n:n;
e.setAttribute(t,s)},typeOfObject:function(t){if(t===null)return"null";
var n=typeof t;
switch(n){case"undefined":break;case"string":n="String";
break;case"number":n="Number";
break;case"object":n=t.constructor.name||t.toString().slice(8,-1);
break;case"function":n=t.name||t.constructor.name;
break;case"boolean":n="Boolean";
break;default:n="unknown"}return n},objectIsA:function(t,n){var r=i.typeOfObject(t);
return typeof n=="string"?r===n:r===i.typeOfObject(n)},arrayify:function(t){return i.objectIsA(t,Array)?t:[t]},pickFirstNonNull:function(){var t=i.argumentsToArray(arguments),n;
for(var r=0,s=t.length;
r<s;
r++){n=t[r];
switch(i.typeOfObject(n)){case"String":return n;
case"Function":var o=n();
if(o)return o}}return null},argumentsToArray:function(t,n){return Array.prototype.slice.call(t||[],i.optionalNumberArg(n,0))},apply:function(t,n,r){var s=null;
return n=i.objectIsA(n,"String")?t[n]:n,r=r||[],n&&(s=n.apply(t,i.argumentsToArray(r))),s},applyToCollection:function(t,n,r){var s=null,o=i.typeOfObject(t),u,a,f;
if(o==="Array")for(u=0,a=t.length;
u<a;
u++)f=i.apply(t[u],n,r),f&&!s&&(s=f);
if(o==="Object")for(u in t)t.hasOwnProperty(u)&&(f=i.apply(t[u],n,r)),f&&!s&&(s=f);
return s},bind:function(t,n){var r=i.argumentsToArray(arguments,2);
return function(){i.apply(t,n,r.concat(i.argumentsToArray(arguments)))}},defer:function(){var t=i.argumentsToArray(arguments),n=typeof t[0]=="number"?t.shift():0;
setTimeout(i.bind.apply(i,t),n)}},_controllers:{},_mixins:{},_init:{handleEvent:function(e){s[e.type]?s[e.type](e):s.applyToControllers(e.type,e),i.applyToCollection(r._mixins,e.type,arguments)},preload:function(){ITSStopwatch.named("ITSLoadTimes").markElapsedTimeNamed("itsKitDispatchPreloadStart",!0),ITSStopwatch.named("ITSLoadTimes").startSplitTimeNamed("itsKitDispatchPreloadDuration"),s.applyToControllers("preload"),n.kit._preloadListeners.forEach(function(e){e()}),ITSStopwatch.named("ITSLoadTimes").stopSplitTimeNamed("itsKitDispatchPreloadDuration",!0)},load:function(e){n.kit._pageLoaded=!0,i.defer(s,"afterPageLoadAction",e),ITSStopwatch.named("ITSLoadTimes").markElapsedTimeNamed("itsKitDispatchLoadStart",!0),ITSStopwatch.named("ITSLoadTimes").startSplitTimeNamed("itsKitDispatchLoadDuration"),n.kit._loadListeners.forEach(function(e){e()}),s.applyToControllers("load",e),ITSStopwatch.named("ITSLoadTimes").stopSplitTimeNamed("itsKitDispatchLoadDuration",!0)},afterPageLoadAction:function(e){n.kit._afterPageLoaded=!0,ITSStopwatch.named("ITSLoadTimes").markElapsedTimeNamed("itsKitDispatchAfterLoadStart",!0),ITSStopwatch.named("ITSLoadTimes").startSplitTimeNamed("itsKitDispatchAfterLoadDuration"),this.applyToControllers("afterLoad",e),n.kit._afterLoadListeners.forEach(function(e){e()}),ITSStopwatch.named("ITSLoadTimes").stopSplitTimeNamed("itsKitDispatchAfterLoadDuration",!0),ITSStopwatch.named("ITSLoadTimes").logToServer()},DOMContentLoaded:function(e){n.kit._domContentLoaded=!0,ITSStopwatch.named("ITSLoadTimes").markElapsedTimeNamed("itsKitDispatchInitStart",!0),ITSStopwatch.named("ITSLoadTimes").startSplitTimeNamed("itsKitDispatchInitDuration"),s.applyToControllers("_init"),ITSStopwatch.named("ITSLoadTimes").stopSplitTimeNamed("itsKitDispatchInitDuration",!0),s.bindAndInitOnElement(e.srcElement),ITSStopwatch.named("ITSLoadTimes").markElapsedTimeNamed("itsKitDispatchDomReadyStart",!0),ITSStopwatch.named("ITSLoadTimes").startSplitTimeNamed("itsKitDispatchDomReadyDuration"),s.applyToControllers("domReady",e),document.addEventListener("DOMNodeInserted",s,!1),n.kit._domReadyListeners.forEach(function(e){e()}),ITSStopwatch.named("ITSLoadTimes").stopSplitTimeNamed("itsKitDispatchDomReadyDuration",!0)},DOMNodeInserted:function(e){var t=e.srcElement;
if(s.ignoreDOMNodeInserted)return;if(t.nodeType!=1||t.tagName=="SCRIPT"||t.tagName=="LINK")return;if(t[r._util.preventItsKitBinding]||t.hasAttribute(r._util.preventItsKitBinding))return;s.bindAndInitOnElement(e.srcElement.parentNode),s._notifyOfDomInserted(e)},_notifyOfDomInserted:function(e){i.defer(s,"afterDomInsertedAction",e),n.kit._domInsertedListeners&&n.kit._domInsertedListeners.forEach(function(t){t(e)}),s.applyToControllers("domInserted",e)},afterDomInsertedAction:function(e){n.kit._afterDomInserted=!0,this.applyToControllers("afterInserted",e)},bindAndInitOnElement:function(t){s.applyToControllers("_bindOnRootElement",t)},applyToControllers:function(e){function a(){if(this.className in u)return t;
u[this.className]=!0;
var n=this._factory.options.initAfter;
return n&&(n=n.replace(o,"")+"Controller",n in r._controllers&&a.call(r._controllers[n])),i.apply(this,e,s)}var t=null,s=i.argumentsToArray(arguments,1),o=n.kit._util.controllerNameRegExp,u={};
return t=i.applyToCollection(r._controllers,a),t}},_util:{controllerNameRegExp:/Controller$/g,preventItsKitBinding:"prevent-its-kit-binding",createClass:function(t,n){var r=e;
return r[t]||(r[t]=(new Function("","return function "+t+"(){};"))()),n&&this.extendClass(r[t],n),r[t]},extendClass:function(e,t){t=i.arrayify(t);
var n;
for(var s=0,o=t.length;
s<o;
s++)n=t[s],t[s]=i.objectIsA(n,"String")?r._extensions[n]:n;
return i.extend(e.prototype,t)},newComponent:function(e,t){return this.newObject(e.replace(this.controllerNameRegExp,""),t)},newController:function(e,t){var n=!t;
e=this.massageControllerName(e),t=i.optionalObjectArg(t,{});
if(n||t.binding||t.component)t.newComponent=this.newComponent(e,[t.component||{},"all"]);
return this.newObject(e,[t.controller,"controller","all"],{_components:[]},t)},newMixin:function(e,t){return this.newObject(e+"Mixin",[t,"mixin","all"],{_controllers:[],_rawName:e})},newObject:function(e,t,n,r){return{name:e,klass:this.createClass(e,t),options:i.optionalObjectArg(r,{}),extend:function(e,t){var n=this.klass.prototype;
t&&(this.klass.prototype[t]={},n=n[t]),i.extend(n,e)},newClass:function(e){return i.extend(new this.klass,[{className:this.name,_factory:this},n,e])}}},massageControllerName:function(e){return e.replace(this.controllerNameRegExp,""),e.lastIndexOf("Controller")==-1&&(e+="Controller"),e}},_extensions:{all:{listen:function(e,t,n){return this._listen(i.argumentsToArray(arguments),!1)},capture:function(e,t,n){return this._listen(i.argumentsToArray(arguments),!0)},_listen:function(e,t){var n=this,r,s,o;
return e.length==1?(r=n.element||document,s=e[0],o=s+"Event"):e.length==2?typeof e[0]=="string"?(r=n.element||document,s=e[0],o=e[1]):(r=e[0],s=e[1],o=s+"Event"):(r=e[0],s=e[1],o=e[2]),typeof o!="object"&&(o=i.bind(n,o)),r.addEventListener(s,o,t),{remove:function(){r.removeEventListener(s,o,t)}}},handleEvent:function(e){var t=e.type+"Event";
this[t]&&this[t].call(this,e)},dispatchCustomEvent:function(e,t,n,r,s){r=i.optionalBooleanArg(r,!0),s=i.optionalBooleanArg(s,!0);
var o=document.createEvent("Events");
o.initEvent(t,r,s),o._customEvent=!0,i.extend(o,n),e.dispatchEvent(o)}},controller:{shouldBindToElement:function(e){return!0},rebind:function(){this.applyToComponents("init")},applyToComponents:function(e){i.applyToCollection(this._components,e,i.argumentsToArray(arguments,1))},getComponents:function(){return[].concat(this._components)},bindToElements:function(e,t){if(!e)return null;
typeof e=="string"&&(t=e,e=document.querySelectorAll(e));
var n=[],s;
for(var o=0,u=e.length;
o<u;
o++)s=this._bindToElement(e[o]),s&&n.push(s);
return i.applyToCollection(n,"bound"),i.applyToCollection(n,"init"),r._debug.isEnabled()&&r._debug.print(this,n,t),n},bindToElement:function(e){var t=this._bindToElement(e);
return t&&(i.apply(t,"bound"),i.apply(t,"init"),r._debug.isEnabled()&&r._debug.print(this,[t])),t},_init:function(){if(!this.binding){var e=this._factory.options.binding;
typeof e=="string"?(this._bindingSelector=e,this.binding=this._binding):typeof e=="function"&&(this.binding=e)}if(this._factory.options.mixins){var t=i.arrayify(this._factory.options.mixins),n,s;
for(var o=0,u=t.length;
o<u;
o++)n=t[o],s=r._mixins[n+"Mixin"],s&&(s.methods&&(this._factory.extend(s.methods),this._factory.options.newComponent&&this._factory.options.newComponent.extend(s.methods,n)),s._controllers.push(this))}},_binding:function(e){return this._bindingSelector&&e&&e.querySelectorAll?e.querySelectorAll(this._bindingSelector):[]},_bindOnRootElement:function(e){this.binding?this.bindToElements(this.binding(e),this._bindingSelector):r._debug.isEnabled()&&r._debug.controllerNameMatchesFilter(this._factory.name)&&console.log('WARNING: No "binding" specification found for matching controller: '+this._factory.name)},_bindToElement:function(e){var t=this._factory.options.newComponent;
if(t&&!(t.name in e)&&!e[r._util.preventItsKitBinding]&&!e.hasAttribute(r._util.preventItsKitBinding)){var n=null;
return this.shouldBindToElement(e)&&(n=t.newClass({element:e,controller:this}),this._factory.options.unbind!==!1&&e.addEventListener("DOMNodeRemovedFromDocument",i.bind(this,"_unbindFromElement",n)),this._components.push(n),e[t.name]=n),n}return null},_unbindFromElement:function(e){var t=this._components.indexOf(e);
t&&(i.apply(e,"unbound"),this._components.splice(t,1))},pagehide:function(e){this.unload&&(console.log("pagehide event called, but unload existed instead. Please replace unload with pagehide!"),this.unload(e))}},mixin:{sendCallback:function(e){arguments[0]=this._rawName+"_"+arguments[0],i.applyToCollection(this._controllers,"applyToComponents",arguments),i.applyToCollection(this._controllers,arguments[0],i.argumentsToArray(arguments,1))}}},_debug:{_isEnabled:function(){var t=/(\?|&)its.kit.debug.enabled=true(&|$)/.test(e.location.search)||sessionStorage&&sessionStorage["its.kit.debug.enabled"]=="true";
return this.isEnabled=function(){return t},t},isEnabled:function(){return this._isEnabled()},hasFilter:function(){return this.filterName()?!0:!1},filterName:function(){return sessionStorage["its.kit.debug.filterControllerNameSubstring"]},controllerNameMatchesFilter:function(e){var t=this.filterName();
return t=="all"||t&&e.toLowerCase().indexOf(t.toLowerCase())!=-1},print:function(e,t,n){var s=!1,o=e.className,u=this.filterName();
if(this.controllerNameMatchesFilter(o)){t||(t=e._components);
var a=!t.length&&u;
if(t.length||a){var f="its.kit.debug: "+o,l=t.length;
a?f+=" FAILED to bind to any elements":(f+=" SUCCESSFULLY bound to "+l+(l>1?" elements":" element"),s=!0),n&&(f+=' matching the selector: "'+n+'".'),t.length==1?console.log(f,"Component:",t[0]):t.length>5?console.log(f,"First 5 components:",t.slice(0,5)):console.log(f,"Components:",t)}}return r._debug.isEnabled()&&r._debug.controllerNameMatchesFilter(name)&&e.applyToComponents(function(){var e=this.element,t=this._factory.name,n=(e.getAttribute("its-kit-bound")||"").split(" ");
n.indexOf(t)==-1&&i.appendAttribute(e,"its-kit-bound",t)}),s},printAll:function(e){var t=this;
return s.applyToControllers(function(){return t.print(this,this._components,this._bindingSelector)})}},_go:function(e){e.document.addEventListener("DOMContentLoaded",s,!1),e.addEventListener("load",s,!1),e.addEventListener("pagehide",s,!1)}};
var r=n.kit,i=r.util,s=r._init;
r._go(e)}(window);
var iTSInclude={};
iTSInclude.clientSideInclude=function(t,n,r,i,s,o){var u=new Object;
if(t!=null){var a=null;
typeof t=="string"?a=document.getElementById(t):typeof t=="object"&&(a=t),u.element=a}u.url=n,u.timeout=r,u.successCallback=i,u.failureCallback=s,u.timeoutCallback=o,iTSInclude.makeHttpRequest(u)},iTSInclude.makeHttpRequest=function(t){var n=new Date,r=null,i=!1;
t.element!=null?r=t.element:t.elementId!=null&&(r=document.getElementById(t.elementId)),r&&r.getAttribute("ignore-plists")=="true"&&(i=!0);
var s=t.url,o=t.timeout,u=t.successCallback,a=t.failureCallback,f=t.timeoutCallback;
f==null&&(f=a);
var l=t.formParams,c=t.jsonParams,h=t.checkForDialog,p=t.dialogCallbacks,d=t.authDialogCallbacks,v=t.acceptStatus204?{200:"200",204:"204"}:{200:"200"},m;
if(t.useJscBridge==1){if(!iTunes.createXHR)throw"JSC bridge XHR not supported: iTunes.createXHR() is not present";
m=iTunes.createXHR()}else m=new XMLHttpRequest;
var g=!1;
if(!t.dontChangeUrl){var y=its.url.queryParamValue("guid");
y&&(s=its.url.appendUrlParameter(s,"guid",y))}m.onreadystatechange=function(){if(!g&&m.readyState==4)if(!v.hasOwnProperty(m.status))a!=null&&a.call(null,m);
else{if(m.responseXML!=null&&h){if(iTSInclude.handleDialogBox(m.responseXML,p,d,m))return;if(iTSInclude.isOldStyleError(m.responseXML)){a!=null&&a.call(null,m);
return}}var e=its.isXMLResponse(m);
r!=null&&(!i||!e)&&(r.innerHTML=m.responseText),u!=null&&u.call(null,m)}};
if(l!=null){var b=iTSInclude.requestBody(l);
m.open("POST",s,!0),typeof t.contentType!="undefined"?m.setRequestHeader("Content-type",t.contentType):m.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.withCredentials&&(m.withCredentials=!0),m.send(b)}else if(c){var w=c;
typeof c=="object"&&(w=JSON.stringify(c)),m.open("POST",s,!0),m.setRequestHeader("Content-type","application/json"),t.withCredentials&&(m.withCredentials=!0),m.send(w)}else m.open("GET",s,!0),t.withCredentials&&(m.withCredentials=!0),m.send();
return o>0&&setTimeout(function(){var e=new Date;
g=!0,m.readyState!=4&&(m.abort(),f!=null&&f.call(null,m))},o),m},iTSInclude.requestBody=function(e){var t=!0,n=new Array;
for(var r in e)t?t=!1:n.push("&"),n.push(encodeURIComponent(r)),n.push("="),n.push(encodeURIComponent(e[r]));
return n.join("")},iTSInclude.handleDialogBox=function(e,t,n,r){var i=iTSInclude.getDialogPlist(e);
return i==null?!1:(its.client.showPlistDialog?its.client.showPlistDialog(i,t,n):typeof iTunes!="undefined"&&iTunes.addProtocol?iTunes.addProtocol(r.responseText):console.log("Client does not support xml plist handling."),!0)},iTSInclude.getDialogPlist=function(e){var t=null,n=e.getElementsByTagName("key");
for(var r=0;
n!=null&&r<n.length;
r++)if(n[r].textContent=="dialog"&&n[r].nextElementSibling!=null&&n[r].nextElementSibling.nodeName=="dict"){t=n[r].nextElementSibling;
break}if(t==null)return null;
t.parentElement.removeChild(t);
var i=document.createElement("plist");
return i.setAttribute("version","1.0"),i.appendChild(t),i},iTSInclude.isOldStyleError=function(e){return its.client.getPlistStringValueForKey(e,"failureType")!=null},iTSInclude.makeRequestAndUpdateFragments=function(e,t,n){iTSInclude.makeHttpRequest({url:e,formParams:t||{},successCallback:function(e){iTSInclude.updateFragments(e.responseText),n&&n(e)},failureCallback:function(t){its.client.error("ajax failure for fragements include request ["+t.status+"] = "+e)}})},iTSInclude.updateFragments=function(e){var t=newElement("div",e),n=t.querySelectorAll("[fragment-replacement]");
n.each(function(e){var t=e.getAttribute("fragment-replacement");
iTSInclude.replaceFragment(t,e)})},iTSInclude.replaceFragment=function(e,t){var n="[fragment-replacement="+e+"]",r=document.querySelectorAll(n);
if(r.length>0){r.length>1&&its.client.info("we found more than 1 fragment with fragment-replacement id "+n+", updating all");
for(var i=0;
i<r.length;
i++){var s=r[i],o=i==0?t:t.cloneNode(!0);
s.parentNode.replaceChild(o,s)}}},iTSInclude.isJsonResponse=function(t){var n=!1;
try{var r=t.getAllResponseHeaders().toLowerCase().indexOf("json");
n=its.isDefinedNonNull(t)&&r!=-1}catch(i){}return n},window.its||(window.its={}),window.its.client||(window.its.client={}),its.client.isRunning=defined("iTunes"),its.client.isTouchSupported="createTouch"in document,its.client.getPlistStringValueForKey=function(e,t){var n=e.getElementsByTagName("key");
for(var r=0;
n!=null&&r<n.length;
r++)if(n[r].textContent==t&&n[r].nextElementSibling!=null&&n[r].nextElementSibling.nodeName=="string")return n[r].nextElementSibling.textContent;
return null},its.client.isAuthDialog=function(e){return"authorization"==its.client.getPlistStringValueForKey(e,"kind")},its.client.isClientGreaterThanOrEqualToSpecifiedVersion=function(e){if(!its.client.isRunning)return!0;
var t=its.client.version();
return!t||!e?"undefined":its.string.compareNumerically(t,e)>=0},its.client.onscreenConsole=function(){return window.ITSOnScreenConsole?ITSOnScreenConsole.onScreenConsoleForObject("ITSClient"):null},its.client._logFunnel=function(t,n,r){n||(n="log");
if((r||its.x&&its.x.isIE&&its.x.isIE())&&window.ITSOnScreenConsole)its.client.onscreenConsole().log(t,n);
else if(window.console){if(console[n])return console[n](t);
var i="Error: Attempt to log with unknown level: "+n+" with message: "+t;
console.error?console.error(i):console.log&&console.log(i)}},its.client.log=function(t,n){its.client._logFunnel(t,"log",n)},its.client.error=function(t,n){its.client._logFunnel(t,"error",n)},its.client.warn=function(t,n){its.client._logFunnel(t,"warn",n)},its.client.info=function(t,n){its.client._logFunnel(t,"info",n)},its.client.debug=function(t,n,r){(r||its.dev)&&its.client._logFunnel(t,"debug",n)},its.client.findChildElementNodeAtPosition=function(e,t){if(!e)return;var n=e.childNodes.length;
if(t>=n)return;var r=0;
for(var i=0;
i<n;
i++){var s=e.childNodes[i];
if(s.nodeType===Node.ELEMENT_NODE){if(r===t)return s;
r+=1}}return null},its.client.findPositionChildElementNodeNamed=function(e,t){if(!e)return;var n=e.childNodes.length;
if(n==0)return;var r=0;
for(var i=0;
i<n;
i++){var s=e.childNodes[i];
if(s.nodeType===Node.ELEMENT_NODE){if(s.lastChild&&s.lastChild.textContent==t)return r;
r++}}return},window.its||(window.its={}),window.its.client||(window.its.client={}),its.client.platformIsDesktop=!1,its.client.platformIsDV=!0,its.client.log=function(t,n){n?its.client._logFunnel(t,"log",n):its.client.isRunning&&defined("iTunes")&&iTunes.loggingEnabled?iTunes.log(t):console.log(t)},its.client.info=function(t,n){n?its.client._logFunnel(t,"info",n):its.client.isRunning&&defined("iTunes")&&iTunes.loggingEnabled?iTunes.log(t):console.info(t)},its.client.dismissCurrentPage=function(){if(defined("iTunes")&&iTunes.window!=null){var t=new Object;
t.animate=!0,iTunes.window.dismiss(t)}else defined("iTunes")&&iTunes.dismissSheet()},its.client.getNavigationBar=function(){var t=defined("iTunes")?iTunes.navigationBar:null;
return t},its.client.setNavigationBarHidden=function(t){defined("iTunes")&&iTunes.window!=null&&(iTunes.window.backViewController.navigationBarHidden=t)},its.client.isHDDevice=function(){return its.client.isRunning&&its.string.compareNumerically(its.client.version(),"3.2")>=0?window.devicePixelRatio>1||iTunes.device.mainScreenScale>1:window.devicePixelRatio>1},its.client.getUserDSID=function(){return defined("iTunes")&&iTunes.primaryAccount!=null?iTunes.primaryAccount.dsID:null},its.client.showConfirm=function(t,n,r,i,s,o){if(defined("iTunes")){var u=s||its.loc("OK"),a=o||its.loc("Cancel"),f=iTunes.confirm(n,t,u,a);
f&&r&&r()}},its.client._cachedVersion=null,its.client.version=function(){return!its.client._cachedVersion&&defined("iTunes")&&(its.client._cachedVersion=iTunes.systemVersion()),its.client._cachedVersion},its.client.setRubberBandingColors=function(t,n,r){its.client.isRunning&&defined("iTunes")&&t&&(t.topBackgroundColor=n,t.backgroundColor=r)},its.client.itemsNotInLibrary=function(e){var t=iTSDVOnDevice.hasMedias(e),n=[];
for(var r=0;
r<e.length;
r++)t[e[r]]||n.push(e[r]);
return n},its.client.alert=function alert(e){its.client.isRunning?(its.client.log("calling iTunes.alert for msg: "+e),iTunes.alert(e,"")):alert(e)},its.client.showPlistDialog=function(e,t,n){if(its.client.isAuthDialog(e)){its.client.showAuthDialog(e,n);
return}var r=iTunes.createDialog(),i=its.client.getPlistStringValueForKey(e,"message"),s=its.client.getPlistStringValueForKey(e,"explanation"),o=its.client.getPlistStringValueForKey(e,"okButtonString"),u=its.client.getPlistStringValueForKey(e,"cancelButtonString"),a=its.client.getPlistStringValueForKey(e,"otherButtonString"),f=new Array,l=0;
r.title=i,s&&(r.body=s),o&&(t&&t.okButtonAction?f[l]=iTunes.createButton(o,t.okButtonAction):f[l]=iTunes.createButton(o,null),l++),u&&(t&&t.cancelButtonAction?f[l]=iTunes.createButton(u,t.cancelButtonAction):f[l]=iTunes.createButton(u,null),r.cancelButtonIndex=l,l++),a&&(t&&t.otherButtonAction?f[l]=iTunes.createButton(a,t.otherButtonAction):f[l]=iTunes.createButton(a,null),l++),r.buttons=f,r.show()},its.client.showAuthDialog=function(e,t){var n=new Object;
n.completionCallback=function(e,n){if(e=="success"){if(t&&t.okButtonAction)return t.okButtonAction()}else e=="fail"?t&&t.cancelButtonAction&&t.cancelButtonAction():e=="cancel"&&t&&t.cancelButtonAction&&t.cancelButtonAction()},iTunes.authenticateForAccount(iTunes.primaryAccount,n)},its.client.screenReaderRunning=function(){return its.client.isRunning?its.screenReaderRunning:!1},its.client.showAlert=function(t,n){its.client.isRunning?iTunes.alert(n,t):alert(t+"\n"+n)},its.client.createStorePage=function(t){return iTunes.createStorePage(t)},its.client.createProductOverlay=function(t){return its.string.compareNumerically(its.client.version(),"5.0")>=0&&(t=its.url.appendUrlParameter(t,"oneView","true")),iTunes.createStorePage(t)},its.client.platformShortName="P2",its.client.platformIsDT=!1,its.client.platformIsDA=!1,its.client.platformIsK2=!1,its.client.platformIsP2=!0,its.client.accessibilityPostLayoutChange=function(){},its.client.createStorePage=function(t){var n=iTunes.createStorePage(t);
return n.shouldLoadProgressively=!0,n};
var nativeiTunes={},noDirectProperties=typeof iTunes=="undefined"||typeof iTunes.viewController=="undefined";
noDirectProperties?(nativeiTunes.viewController=iTunes.getViewController(),nativeiTunes.viewController.toolbarItems=iTunes.getViewController().toolbarItems(),nativeiTunes.viewController.navigationItem=iTunes.getViewController().getNavigationItem(),nativeiTunes.viewController.navigationItem.title=iTunes.getViewController().getNavigationItem().getTitle(),nativeiTunes.viewController.navigationItem.leftItem=iTunes.getViewController().getNavigationItem().getLeftItem(),nativeiTunes.viewController.navigationItem.rightItem=iTunes.getViewController().getNavigationItem().getRightItem(),nativeiTunes.viewController.navigationController=iTunes.getViewController().getNavigationController(),nativeiTunes.viewController.navigationController.navigationBar=iTunes.getViewController().getNavigationController().getNavigationBar(),nativeiTunes.viewController.navigationController.navigationBar.navigationItems=iTunes.getViewController().getNavigationController().getNavigationBar().getNavigationItems(),nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem=iTunes.getViewController().getNavigationController().getNavigationBar().getTopNavigationItem(),nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.title=iTunes.getViewController().getNavigationController().getNavigationBar().getTopNavigationItem().getTitle(),nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.leftItem=iTunes.getViewController().getNavigationController().getNavigationBar().getTopNavigationItem().getLeftItem(),nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.leftItem.enabled=iTunes.getViewController().getNavigationController().getNavigationBar().getTopNavigationItem().getLeftItem().getEnabled(),nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.leftItem.action=iTunes.getViewController().getNavigationController().getNavigationBar().getTopNavigationItem().getLeftItem().getAction(),nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.leftItem.title=iTunes.getViewController().getNavigationController().getNavigationBar().getTopNavigationItem().getLeftItem().getTitle(),nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.rightItem=iTunes.getViewController().getNavigationController().getNavigationBar().getTopNavigationItem().getRightItem(),nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.rightItem.enabled=iTunes.getViewController().getNavigationController().getNavigationBar().getTopNavigationItem().getRightItem().getEnabled(),nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.rightItem.action=iTunes.getViewController().getNavigationController().getNavigationBar().getTopNavigationItem().getRightItem().getAction(),nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.rightItem.title=iTunes.getViewController().getNavigationController().getNavigationBar().getTopNavigationItem().getRightItem().getTitle(),nativeiTunes.viewController.navigationController.toolbarHidden=iTunes.getViewController().getNavigationController().getToolbarHidden(),nativeiTunes.viewController.shouldShowFormAccessory=iTunes.getViewController().shouldShowFormAccessory(),nativeiTunes.accountCreationSecureContext=iTunes.getAccountCreationSecureContext(),nativeiTunes.navigationBar=iTunes.getNavigationBar()):nativeiTunes=iTunes,noDirectProperties&&(its.client.getNavigationBar=function(){return iTunes.getNavigationBar()},iTunes.clickFunction=function(e){var t=document.getElementById(e);
t&&t.click()}),its.kit.createController("iTSDeviceAccountManagement",{binding:"body#MHTermsWizard.accountManagement form, body#MHSignupAccountWizard.accountManagement form, body#MHSignupAddressWizard.accountManagement form",controller:{submitEvent:function(){this.applyToComponents("submitEvent")}},component:{init:function(){if(!its.client.isRunning)return;this.pageUUIDInput=this.element.querySelector("input#pageUUID"),this.dataInput=this.element.querySelector("input#signature"),this.machineGUIDInput=this.element.querySelector("input#machineGUID");
if(this.pageUUIDInput&&this.dataInput){this.accountCreationContext=nativeiTunes.accountCreationSecureContext;
if(typeof this.accountCreationContext!="undefined"){var e=document.querySelector("body#MHSignupAccountWizard.accountManagement");
e&&(this.appleIDInput=this.element.querySelector("input#accountNameField"))}}},submitEvent:function(e){if(this.accountCreationContext){var t=this.pageUUIDInput.value,n=t;
this.machineGUIDInput&&typeof iTunes.getMachineGUID=="function"&&(n+=iTunes.getMachineGUID(),this.machineGUIDInput.value=iTunes.getMachineGUID()),this.appleIDInput&&(n+=this.appleIDInput.value);
try{var r=this.accountCreationContext.signData(n);
this.dataInput.value=r}catch(i){}}}}}),its.kit.createController("iTSDeviceSignupSuccess",{binding:"body#MHSignupSuccess.accountManagement",component:{init:function(){if(!its.client.isRunning)return;if(!useJSData)return;this.accountCreationContext=nativeiTunes.accountCreationSecureContext,typeof this.accountCreationContext!="undefined"&&this.accountCreationContext.close()}}}),ITSLogger.constants={_version:"2.1",_intraFieldSeparator:"|",_visitorIdVersion:"v5",_undefinedValue:"undefined"},ITSLogger.isLoaded=!0;
for(var key in window.earlyLoadITSLogger)ITSLogger[key]=window.earlyLoadITSLogger[key];
ITSLogger._processQueuedMessages=function(){if(ITSLogger._loggingEnabledToServer()){if(ITSLogger._queuedMessages&&ITSLogger._queuedMessages.length){var t=its.x.util.array.shallowCopy(ITSLogger._queuedMessages);
ITSLogger._queuedMessages=[];
var n=10;
t.length&&(new Date).getTime()-its.markupLoadStartTime>n*1e3&&(ITSLogger.setUseOnScreenConsole(!1),ITSLogger.named()._funnelLogger(ITSLogger.ERROR,!0,"Failed to load requested ITSOnscreenConsole after "+n+" seconds... reverting to stdout"));
for(var r=0;
r<t.length;
r++){var i=t[r];
ITSLogger.named(i.loggerName)._funnelLogger(i.loggingThreshold,!0,i.message,i.serverDataDict,i.mirrorToServer)}}ITSLogger.possiblyWaitForQueueMessages()}},ITSLogger.REQUEST=0,ITSLogger.SESSION=1,ITSLogger.PERM=2,ITSLogger.DOMAIN_NAME_COMPONENTS=3,ITSLogger.STORAGE_KEY="jsLogValues",ITSLogger.Defaults={},ITSLogger.Defaults.loggerName="ITSLogger",ITSLogger.Defaults.level=ITSLogger.ERROR,ITSLogger.Defaults.useOnScreenConsole=!1,ITSLogger.Defaults.regexFilterString=null,ITSLogger.Defaults.persistence=ITSLogger.SESSION,ITSLogger.Defaults.regexFilterObject=null,ITSLogger.named=function(t){var n=null;
return t||(t=ITSLogger.Defaults.loggerName),ITSLogger.loggers&&(n=ITSLogger.loggers[t]),n||(n=new ITSLogger(t)),n},ITSLogger.stringify=function(t){var n="";
for(var r=0;
r<arguments.length;
r++){var i=arguments[r];
if(typeof arguments[r]=="object")try{i=JSON.stringify(arguments[r])}catch(s){i=arguments[r]}n+=i,r<arguments.length-1&&(n+=" ")}return n},ITSLogger._omnitureValue=function(t){var n=ITSLogger.constants._undefinedValue;
if(window.ITSMetrics){var r=ITSMetrics[t]();
r&&(n=r)}return n},ITSLogger._cleanValue=function(t){if(!t||t=="")t=ITSLogger.constants._undefinedValue;
return t},ITSLogger._createVisitorId=function(t){var n=null,r="[LS]",i=t?"1":"0",s=its.string.generateUuid(23,10),o="[LE]",u=[r,ITSLogger.constants._visitorIdVersion,i,s,o];
return n=u.join(ITSLogger.constants._intraFieldSeparator),n},ITSLogger._visitorMapVersionAdjustments=function(t){var n=its.reflect.values(t);
if(n&&n.length){var r=n[0],i=r.split(ITSLogger.constants._intraFieldSeparator);
i[1]!=ITSLogger.constants._visitorIdVersion&&(t={})}return t},ITSLogger._locallyStoredVisitorIdMap=function(t){if(typeof JSON=="undefined")return;var n=null,r="ITSLogger.visitorIds",i=localStorage[r],s={};
return i&&(s=JSON.parse(i),s=ITSLogger._visitorMapVersionAdjustments(s),n=s[t]),n||(s[t]=ITSLogger._createVisitorId(t!=ITSLogger.constants._undefinedValue),localStorage[r]=JSON.stringify(s)),s},ITSLogger._notifyServer=function(t,n,r,i,s,o){var u=null;
if(ITSLogger._loggingEnabledToServer()&&!its.property("ITSLogger.disableClientNotificationSends")){var a={};
t||(t=ITSLogger.constants._undefinedValue),a.messageParam=t;
if(!r||!r.message)r||(r={}),r.message=t;
a.loggerName=n,i||(i=ITSLogger.constants._undefinedValue),a.loggingThreshold=i;
var f={};
a||(a={});
var l="",c=null,h=its.property("ITSLogger.ServerReportingProtocol"),p=its.property("ITSLogger.ServerReportingDomain"),d=its.property("ITSLogger.ServerReportingApp"),v="/WebObjects/"+d+".woa/wa/";
s?its.string.startsWith(s,"http",!0)||(its.string.startsWith(s,"//")||(l="//"),l=h+l):s=h+"://"+p,l=s,o?(its.string.startsWith(o,"/")||(o="/"+o),its.string.endsWith(o,"/")||(o+="/")):o=v,l+=o,l+=its.property("ITSLogger.RecordStatsAction"),l+="?eventType="+n,l+="&version="+ITSLogger.constants._version;
var m=(new Date).getTime(),g=m-its.markupLoadStartTime,y=ITSLogger.constants._undefinedValue;
document&&document.body&&document.body.className&&(y=document.body.className);
if(!r)r={};
else for(var b in r)f[n+"_"+b]=r[b];
a.version=ITSLogger.constants._version,a.eventType=a.loggerName,a.serverEnvironment=ITSLogger._cleanValue(its.property("ITSServerEnvironment")),a.serverEnvironmentDetailsString=ITSLogger._cleanValue(window.status),its.kit.util.extend(a,window.statusData),a.serverInstance=ITSLogger._cleanValue(its.property("ITSServerInstance"));
var w=ITSLogger._cleanValue(its.client.getUserDSID());
a.dsid=w;
var E=ITSLogger._locallyStoredVisitorIdMap(w),S=E[w];
a.visitorId=S;
var x=its.reflect.values(E);
a.visitorIds=JSON.stringify(x);
var T=1;
E.unknown?x.length>=3&&(T=x.length-1):T=x.length,a.visitorCount=T,a.omnitureVisitorId=ITSLogger._cleanValue(its.cookies.get("s_vi")),a.vip=its.property("vip"),a.resourceRevNum=its.property("ITSResourceRevNum"),a.windowLocationHref=window&&window.location&&window.location.href?window.location.href:"undefined",a.timeOfLog=m,a.markupLoadStartTime=its.markupLoadStartTime,a.markupLoadEndTime=ITSLogger._cleanValue(its.markupLoadEndTime),a.markupLoadTotalTime=its.markupLoadStartTime&&its.markupLoadEndTime?its.markupLoadEndTime-its.markupLoadStartTime:"undefined",a.timeElapsedFromLoadStart=g,a.pageName=ITSLogger._omnitureValue("omniturePageName"),a.pageChannel=ITSLogger._omnitureValue("omnitureChannel"),a.pageClassName=y,a.allowDeferJsLoad=its.property("MZHtmlResourcesUtil.allowDeferJsLoad")?!0:!1,a.clientForceServerNotifications=its.property("ITSLogger.clientForceServerNotifications")?!0:!1;
for(var b in a)f["ITSLogger_"+b]=a[b];
f.sender=its.property("ITSLogger.SenderName");
var N=its.property("ITSLogger.blacklistedServerNotificationsFields");
if(N!=null)for(var C=0;
C<N.length;
C++){var k=N[C];
delete f[k]}c=JSON.stringify(f);
var L=new XMLHttpRequest;
L.open("POST",l,!0),L.setRequestHeader("Content-type","application/json"),L.send(c),u=c}return u},ITSLogger.prototype.loggerName=function(){return this._loggerName},ITSLogger.prototype.debug=function(t,n,r){this._funnelLogger(ITSLogger.DEBUG,!1,t,n,r)},ITSLogger.prototype.info=function(t,n,r){this._funnelLogger(ITSLogger.INFO,!1,t,n,r)},ITSLogger.prototype.warn=function(t,n,r){this._funnelLogger(ITSLogger.WARN,!1,t,n,r)},ITSLogger.prototype.error=function(t,n,r){this._funnelLogger(ITSLogger.ERROR,!1,t,n,r)},ITSLogger.prototype.stats=function(t,n,r){this._funnelLogger(ITSLogger.STATS,!1,t,n,r)},ITSLogger.prototype.queueMessage=function(t,n,r,i){ITSLogger._loggingEnabledToServer()&&ITSLogger.queueMessage(this.loggerName(),t,n,i,r)},ITSLogger.prototype.setMirrorToServer=function(t){this._mirrorToServer=t},ITSLogger.prototype.mirrorToServer=function(t){return t||this._mirrorToServer},ITSLogger.prototype._funnelLogger=function(t,n,r,i,s){if(ITSLogger._loggingEnabledToServer()){n||ITSLogger._processQueuedMessages();
var o=t;
o==ITSLogger.STATS&&(t=ITSLogger.INFO);
var u=null;
switch(t){case ITSLogger.DEBUG:u=its.client.debug;
break;case ITSLogger.INFO:u=its.client.info;
break;case ITSLogger.WARN:u=its.client.warn;
break;case ITSLogger.ERROR:u=its.client.error}var a=u&&t>=ITSLogger.level()||t==ITSLogger.ERROR,s=this.mirrorToServer(s);
if(a||s){if(r){var f=this.loggerName()+":",l=ITSLogger._omnitureValue("omniturePageName");
l!="undefined"&&(f+=l+":"),f+=" "+r;
if(t==ITSLogger.ERROR||a&&ITSLogger._passesRegexFilterTest(f)){var c=ITSLogger.useOnScreenConsole()&&window.ITSOnScreenConsole?!0:!1,h=ITSLogger.useOnScreenConsole()&&!window.ITSOnScreenConsole?!0:!1;
h&&a?(ITSLogger._loadOnscreenConsoleIfNeeded(),this.queueMessage(t,r,i,!1)):a&&u(f,c)}}s&&ITSLogger._notifyServer(r,this.loggerName(),i,o)}}},ITSLogger.level=function(){return ITSLogger.loggingPreferences().level},ITSLogger.setLevel=function(t,n,r,i){var s=null;
if(t==null||t==""){if(t==null){var o=ITSLogger._loggingPreferencesDisplayString();
s="Clearing previous settings of: ITSLogger.setLevel("+ITSLogger._loggingPreferencesDisplayString()+")"+'\nUsage: ITSLogger.setLevel(level["debug"[1]|"info"[2]|"warn"[3]|"error"[4], regexFilterString, useOnScreenConsole[true|false], persistence["REQUEST"[0]|"SESSION"[1]|"PERM"[2])'}ITSLogger.clearLoggingPreferences()}else logevel=ITSLogger._parseLogLevel(t),r||(r=ITSLogger.useOnScreenConsole()),ITSLogger.setLoggingPreferences(t,r,n,i),s=ITSLogger._loggingPreferencesDisplayString();
return s},ITSLogger.useOnScreenConsole=function(){var t=!1;
return ITSLogger.loggingPreferences().useOnScreenConsole&&(window.ITSOnScreenConsole||its.property("itsLoggerJsUrlForOnscreenConsole")&&its.property("itsLoggerCssUrlForOnscreenConsole"))&&(t=!0),t},ITSLogger.setUseOnScreenConsole=function(t){return ITSLogger._cachedPreferences.useOnScreenConsole=t,t},ITSLogger.regexFilterString=function(){return ITSLogger.loggingPreferences().regexFilterString},ITSLogger.setRegexFilterString=function(t){return ITSLogger._cachedPreferences.regexFilterString=t,t},ITSLogger.regexFilterObject=function(){return ITSLogger.loggingPreferences().regexFilterObject},ITSLogger.persistence=function(){return ITSLogger.loggingPreferences().persistence},ITSLogger.setPersistence=function(t){return t=ITSLogger._parseLogPersistence(t),ITSLogger.setLoggingPreferences(ITSLogger.loggingPreferences().level,ITSLogger.loggingPreferences().useOnScreenConsole,ITSLogger.loggingPreferences().regexFilterString,ITSLogger.loggingPreferences().persistence),t},ITSLogger._passesRegexFilterTest=function(t){var n=!1,r=ITSLogger.regexFilterObject();
if(!r||t.search(r)!=-1)n=!0;
return n},ITSLogger.clearLoggingPreferences=function(){ITSLogger.setLoggingPreferences(null)},ITSLogger._parseLogLevel=function(t){if(t!=null&&t.toUpperCase){var n=its.string.toInt(t);
if(isNaN(n)){var r=t?t.toUpperCase():"";
r=="DEBUG"?t=ITSLogger.DEBUG:r=="INFO"?t=ITSLogger.INFO:r=="WARN"?t=ITSLogger.WARN:r=="ERROR"?t=ITSLogger.ERROR:t=ITSLogger.Defaults.level}else t=n}return t},ITSLogger._parseLogPersistence=function(t){if(t!=null&&t.toUpperCase){var n=its.string.toInt(t);
if(isNaN(n)){var r=t?t.toUpperCase():"";
r=="REQUEST"?t=ITSLogger.REQUEST:r=="SESSION"?t=ITSLogger.SESSION:r=="PERM"?t=ITSLogger.PERM:t=ITSLogger.Defaults.persistence}else t=n}return t},ITSLogger._setDefaultLoggingPreferences=function(){ITSLogger._cachedPreferences={level:ITSLogger.Defaults.level,useOnScreenConsole:ITSLogger.Defaults.useOnScreenConsole,regexFilterString:ITSLogger.Defaults.regexFilterString,regexFilterObject:ITSLogger.Defaults.regexFilterObject,persistence:ITSLogger.Defaults.persistence}},ITSLogger.loggingPreferences=function(){if(!ITSLogger._cachedPreferences){var t=null;
ITSLogger._setDefaultLoggingPreferences(),localStorage&&localStorage.getItem(ITSLogger.STORAGE_KEY)?t=localStorage.getItem(ITSLogger.STORAGE_KEY):sessionStorage&&sessionStorage.getItem(ITSLogger.STORAGE_KEY)?t=sessionStorage.getItem(ITSLogger.STORAGE_KEY):t=its.cookies.get(ITSLogger.STORAGE_KEY);
if(t){var n=t.split("-");
n.length>0&&n[0].length>0&&(ITSLogger._cachedPreferences.level=n[0]),n.length>1&&n[1].length>0&&(ITSLogger._cachedPreferences.useOnScreenConsole=n[1]=="1"?!0:!1),n.length>2&&n[2].length>0&&(ITSLogger._cachedPreferences.regexFilterString=n[2],ITSLogger._cachedPreferences.regexFilterString!=ITSLogger._previousRegexFilterString&&(ITSLogger._previousRegexFilterString=ITSLogger._cachedPreferences.regexFilterString,ITSLogger._cachedPreferences.regexFilterObject=new RegExp(ITSLogger._cachedPreferences.regexFilterString))),n.length>3&&n[3].length>0&&(ITSLogger._cachedPreferences.persistence=n[3])}ITSLogger._queryParams=its.url.queryParamsDict();
var r=!1,i=ITSLogger._queryParams.jsLogLevel,s=ITSLogger._queryParams.jsLogReset;
if(i==""||s!=null)ITSLogger.clearLoggingPreferences();
else{var o=ITSLogger._queryParams.jsLogUseOnScreenConsole,u=ITSLogger._queryParams.jsLogRegexFilterString,a=ITSLogger._queryParams.jsLogPersistence;
if(o&&o.toUpperCase){var f=o.toUpperCase();
f=="TRUE"?o=1:f=="FALSE"&&(o=0)}a&&a.toUpperCase&&(a=a.toUpperCase()),i!=null&&(r=!0,ITSLogger._cachedPreferences.level=ITSLogger._parseLogLevel(i)),o!=null&&(o==""&&(o=ITSLogger.Defaults.useOnScreenConsole),ITSLogger._cachedPreferences.useOnScreenConsole=o),u!=null&&(u==""&&(u=ITSLogger.Defaults.regexFilterString),ITSLogger._cachedPreferences.regexFilterString=u),a!=null&&(a=ITSLogger._parseLogPersistence(a),ITSLogger._cachedPreferences.persistence=a),r&&a!=null&&ITSLogger.setLoggingPreferences(ITSLogger._cachedPreferences.level,ITSLogger._cachedPreferences.useOnScreenConsole,ITSLogger._cachedPreferences.regexFilterString,a)}}return ITSLogger._cachedPreferences},ITSLogger._loggingPreferencesDisplayString=function(){var t=ITSLogger.loggingPreferences();
return t.level+", "+t.regexFilterString+", "+t.useOnScreenConsole+", "+t.persistence},ITSLogger._loadOnscreenConsoleIfNeeded=function(t,n){!window.ITSOnScreenConsole&&(t||ITSLogger.useOnScreenConsole())&&(n||(n=ITSLogger._onscreenConsoleFinishedLoadingCb),its.x.dynaLoadResourceFile(its.property("itsLoggerCssUrlForOnscreenConsole")),its.x.dynaLoadResourceFile(its.property("itsLoggerJsUrlForOnscreenConsole"),n))},ITSLogger._onscreenConsoleFinishedLoadingCb=function(){ITSLogger._processQueuedMessages()},ITSLogger.showErrorIndicator=function(t){window.ITSOnScreenConsole?(ITSOnScreenConsole.showErrorIndicator(t),ITSLogger._processQueuedMessages()):ITSLogger._loadOnscreenConsoleIfNeeded(!0,function(){ITSLogger.showErrorIndicator(t)})},ITSLogger.setLoggingPreferences=function(t,n,r,i){ITSLogger._loadOnscreenConsoleIfNeeded(),t=ITSLogger._parseLogLevel(t),i=ITSLogger._parseLogPersistence(i);
var s=its.url.parentDomainWithNumComponents(document.domain,ITSLogger.DOMAIN_NAME_COMPONENTS);
if(t==null||t=="")ITSLogger._setDefaultLoggingPreferences(),its.cookies.remove(ITSLogger.STORAGE_KEY,s),sessionStorage&&sessionStorage.removeItem(ITSLogger.STORAGE_KEY),localStorage&&localStorage.removeItem(ITSLogger.STORAGE_KEY);
else{var o="";
t!=undefined&&(o+=t,ITSLogger._cachedPreferences.level=t),o+="-",n!=undefined&&(o+=n?"1":"0",ITSLogger._cachedPreferences.useOnScreenConsole=n),o+="-",r&&(o+=r,ITSLogger._cachedPreferences.regexFilterString=r,ITSLogger._cachedPreferences.regexFilterObject=new RegExp(ITSLogger._cachedPreferences.regexFilterString)),o+="-",i!=undefined&&(o+=i,ITSLogger._cachedPreferences.persistence=i);
var u=null;
i==ITSLogger.SESSION?sessionStorage?(localStorage.removeItem(ITSLogger.STORAGE_KEY),sessionStorage.setItem(ITSLogger.STORAGE_KEY,o)):u=its.cookies.EXPIRE_SESSION:i==ITSLogger.PERM&&(localStorage?(sessionStorage.removeItem(ITSLogger.STORAGE_KEY),localStorage.setItem(ITSLogger.STORAGE_KEY,o)):u=its.cookies.its.cookies.EXPIRE_ONE_YEAR),u&&its.cookies.set(ITSLogger.STORAGE_KEY,o,u,"/",s)}},ITSLogger._loggingEnabledToServer=function(){return its.serverData&&!its.property("ITSLogger.DisableLogging")&&typeof JSON!="undefined"},ITSLogger._omnitureEventHandler=function(t){t.omnitureQueryParams.eventName=t.eventName,ITSLogger.named("ITSOmniture").stats(null,t.omnitureQueryParams,!0)},ITSLogger.ITSMetrics={},ITSLogger.ITSMetrics.Events={},window.ITSMetrics?(ITSLogger.ITSMetrics.Events.CLICK=ITSMetrics.Events.CLICK,ITSLogger.ITSMetrics.Events.PAGE=ITSMetrics.Events.PAGE):(ITSLogger.ITSMetrics.Events.CLICK="ITSMetrics.Events.CLICK",ITSLogger.ITSMetrics.Events.PAGE="ITSMetrics.Events.PAGE"),its.notifications.subscribe(ITSLogger.ITSMetrics.Events.CLICK,ITSLogger._omnitureEventHandler),its.notifications.subscribe(ITSLogger.ITSMetrics.Events.PAGE,ITSLogger._omnitureEventHandler),ITSLogger._loadOnscreenConsoleIfNeeded(),ITSLogger._processQueuedMessages(),its.x.dynaLoadResourceFile(its.property("ITSLogger.jsUrlForLoggerSettingsPanel")),its.x.dynaLoadResourceFile(its.property("ITSLogger.cssUrlForLoggerSettingsPanel")),window.its||(window.its={}),window.its.client||(window.its.client={}),window.its.client.log||(window.its.client.log=function(e){window.console&&console.log&&console.log(e)}),window.ITSMetrics||(window.ITSMetrics={}),ITSMetrics.decodeMetricsPassThruParams=function(e){if(e==null)return null;
var t=its.string.xmlUnescape(e),n=its.url.parseQueryParams(t);
return its.client.log(n),n},ITSMetrics.encodeMetricsPassThruParams=function(e){if(e==null)return null;
var t="",n=0;
for(var r in e){var i=e[r];
n>0&&(t+="&"),t+=r+="="+encodeURIComponent(i),n++}return its.string.xmlEscape(t)},ITSMetrics.isOmnitureSupportedOnClient=function(){var e=!0;
return window.navigator.userAgent.indexOf("MacAppStore")>=0&&(e=its.string.compareNumerically(iTunes.systemVersion(),"10.9")<0),e},ITSMetrics.omniturePageName=function(){return ITSMetrics.omniture&&ITSMetrics.omniture.pageName?ITSMetrics.omniture.pageName:null},ITSMetrics.omnitureChannel=function(){return ITSMetrics.omniture&&ITSMetrics.omniture.channel?ITSMetrics.omniture.channel:null},ITSMetrics.processQueryParameterInfoInCurrentRequest=function(e){var t=its.url.queryParamsDict();
if(!its.isEmpty(t)){e.campaign=t.v0;
var n={},r=ITSMetrics.decodeMetricsPassThruParams(t["ign-mpt"]);
r&&(n=r);
var i=ITSMetrics.decodeMetricsPassThruParams(t["gc-mpt"]);
for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s]);
for(var s in n)if(s.length>=1&&s.length<=3){var o=parseInt(s.substr(1),10);
isNaN(o)||(s[0]=="c"?e["prop"+o]=n[s]:s[0]=="v"&&(o===0?e.campaign=n[s]:e["eVar"+o]=n[s]))}var u=t["ign-msr"];
if(u){its.client.log("Found SEO Referrer: "+u);
var a=ITSMetrics._parseHostAndSearchTerm(u);
its.client.log("Referrer domain: "+a.hostname+", search term: "+a.searchTerm),a.hostname&&a.hostname.indexOf("itunes.apple.com")?(console.log("Setting seo referrer cookie: "+u),its.cookies.set("seoReferrer",u,its.cookies.EXPIRE_ONE_DAY,null,"itunes.apple.com"),e.prop23=a.hostname,e.eVar23=a.hostname,e.prop24=a.searchTerm,e.eVar24=a.searchTerm):its.client.log("SEO Referrer's hostname is an SEO Page.  Ignoring")}}},ITSMetrics.userAgentForMetrics=function(){var e=navigator.userAgent;
return e.indexOf("呩")==0&&(e="iTunes Pre 9.2 (Windows Version Unknown)"),e},ITSMetrics.gameCenterUserAgent="GameCenter",ITSMetrics.gameCenterPrefix=ITSMetrics.gameCenterUserAgent+"-",ITSMetrics.isGameCenter=function(e){return e.length>ITSMetrics.gameCenterUserAgent.length&&e.substr(0,ITSMetrics.gameCenterUserAgent.length)==ITSMetrics.gameCenterUserAgent},ITSMetrics._parseHostAndSearchTerm=function(t){var n={},r=its.url.parseHostname(t),i=null,s=null;
return r.indexOf("www.google.")>=0||r.indexOf(".ask.com")>=0||r=="www.bing.com"?i="q":r.indexOf(".yahoo.com")>=0&&(i="p"),i&&(s=its.url.queryParamValue(i,t),s&&(n.searchTerm=s)),n.hostname=r,n},ITSMetrics.metricsId=function(){return its.cookies.get(ITSMetrics.OMNITURE_COOKIE_NAME)},window.ITSMetrics||(window.ITSMetrics={}),ITSMetrics.OMNITURE_HOST="metrics.apple.com",ITSMetrics.OMNITURE_HOST_SECURE="securemetrics.apple.com",ITSMetrics.OMNITURE_COOKIE_NAME="s_vi",ITSMetrics.OMNITURE_COOKIE_DOMAIN=".apple.com",ITSMetrics.Events={},ITSMetrics.Events.PAGE="ITSMetrics.Events.PAGE",ITSMetrics.Events.CLICK="ITSMetrics.Events.CLICK",ITSMetrics.createBaselineOmnitureObject=function(){return ITSMetrics._libraryInstance==null&&(ITSMetrics._libraryInstance=new ITSOmnitureLibrary),ITSMetrics._libraryInstance},ITSOmnitureLibrary=Class.create("",{initialize:function(e){ITSMetrics.reportingSuite&&(this.hier5=ITSMetrics.reportingSuite)},t:function(){var t={};
document.referrer&&document.referrer.length>0&&(t.r=document.referrer),t.ch=this.channel,t.products=this.products,this._emitPing(t,null,!1)},tl:function(t,n,r){var i={};
i.pe="lnk_"+n,i.pev2=r;
var s=typeof t!="boolean"?ITSLocationMetricsUtil.hrefForTargetElement(t):"";
s!==""&&(i.pev1=s),this._emitPing(i,this.linkTrackVars.split(","),!0)},_emitPing:function(t,n,r){var i=new Date,s=i.getYear(),o={};
o.AQB=1,o.ndh=1,o.t=i.getDate()+"/"+i.getMonth()+"/"+(s<1900?s+1900:s)+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()+" "+i.getDay()+" "+i.getTimezoneOffset(),o.ce="UTF-8",o.cl=15778463,o.pageName=this.pageName,o.g=window.location.href;
if(t&&Object.keys){var u=Object.keys(t);
for(var a=0;
a<u.length;
a++){var f=u[a];
o[f]=t[f]}}this.campaign&&(o.v0=this.campaign);
var l=this._whitelistArrayToMap(n);
for(var a=0;
a<50;
a++){if(a<=5){var c="hier"+a,h=this[c];
typeof h!="undefined"&&h!==null&&this._shouldIncludeVariable(l,c)&&(o["h"+a]=h)}var p="prop"+a,d=this[p];
typeof d!="undefined"&&d!==null&&this._shouldIncludeVariable(l,p)&&(o["c"+a]=d);
var v="eVar"+a,m=this[v];
typeof m!="undefined"&&m!==null&&this._shouldIncludeVariable(l,v)&&(o["v"+a]=m)}o.s=screen.width+"x"+screen.height,o.c=screen.colorDepth,o.v=navigator.javaEnabled()?"Y":"N",o.k="Y",o.bw=window.innerWidth,o.bh=window.innerHeight,o.AQE=1,o.sfcustom="1";
var g=window.location.protocol=="https:"?"https://securemetrics.apple.com":"http://metrics.apple.com";
g+="/b/ss/applesuperglobal/1/H.20.3/";
var y="s"+Math.floor(i.getTime()/108e5)%10+Math.floor(Math.random()*1e13);
g+=y,g=its.url.appendUrlParameters(g,o);
if("iTunes"in window&&"device"in iTunes&&its.string.compareNumerically(its.client.version(),"6.0")>=0)iTunes.pingURL(g);
else{var b=new Image;
b.src=g}var w=r?ITSMetrics.Events.CLICK:ITSMetrics.Events.PAGE,E=new ITSEvent(w,this);
E.omnitureQueryParams=o,E.pageData=ITSMetrics.pageData,its.notifications.publish(w,E)},_shouldIncludeVariable:function(t,n){return!t||t[n]},_whitelistArrayToMap:function(t){if(!t)return null;
var n={};
for(var r=0;
r<t.length;
r++)n[t[r]]=!0;
return n}}),window.addEventListener("pagehide",function(e){ITSPageMetricsUtil.onPageHidden(e)},!1),ITSPageMetricsUtil.ReferrerPageInfoKey="itsMetricsR",ITSPageMetricsUtil.MetricsStringSeparator="@@",ITSPageMetricsUtil.ADAM_ID="metrics-adamId",ITSPageMetricsUtil.logger=ITSLogger.named("ITSPageMetricsUtil"),ITSPageMetricsUtil.onPageHidden=function(t){var n=ITSPageMetricsUtil.currentPageInfo();
n&&(ITSPageMetricsUtil._saveReferrerPageInfo(n),delete ITSPageMetricsUtil._currentPageInfo)},ITSPageMetricsUtil.currentPageInfo=function(){if(!its.isDefined(ITSPageMetricsUtil._currentPageInfo)){var t=ITSMetrics.omniturePageName(),n=ITSPageMetricsUtil._pageNameExtrasForBuyMetrics(),r=ITSMetrics.omnitureChannel();
t?ITSPageMetricsUtil._currentPageInfo=new ITSMetricsPageInfo(t,n,r):ITSPageMetricsUtil._currentPageInfo=null}return ITSPageMetricsUtil._currentPageInfo},ITSPageMetricsUtil.handleDV6PageEventForPageData=function(e,t,n,r){var i=function(e,t){return typeof e=="boolean"?e:t},s={restoreOnSwoopyClose:i(t,!1),pingOnDidReAppear:i(n,!0),suppressLoadPing:i(r,!1)};
i(its.property("DV6.EnableOmnitureCachedPagePing"),!0)||(s.pingOnDidReAppear=!1),"productData"in e&&(e=e.productData);
var o="omnitureMetrics"in e;
o?ITSPageMetricsUtil._DV6PageHandler=function(t){ITSPageMetricsUtil.handleSF6PageEvent(e,t)}:ITSPageMetricsUtil._DV6PageHandler=function(){},o&&(ITSPageMetricsUtil._DV6PageHandler(s.suppressLoadPing),s.suppressLoadPing&&(ITSPageMetricsUtil._didDisappear=!0));
var u=!1;
return its.sf.Platform?u=its.sf.Platform.iPad():its.client&&(u=its.client.platformIsK2),u&&!ITSPageMetricsUtil._swoopyCloseHandler?(s.restoreOnSwoopyClose&&o?(console.warn("  + enabled swoopy close handler for "+e.omnitureMetrics.pageName),ITSPageMetricsUtil._swoopyCloseHandler=function(){ITSPageMetricsUtil.handleSF6PageEvent(e,!0)}):(console.warn("  - disabled swoopy close handler"),ITSPageMetricsUtil._swoopyCloseHandler=function(){console.warn("_swoopyCloseHandler() disabled")}),its.notifications.subscribe("swoopy:close",ITSPageMetricsUtil._swoopyCloseHandler)):s.restoreOnSwoopyClose&&console.warn("Ignored restoreOnSwoopyClose; _swoopyCloseHandler already exists"),"addEventListener"in iTunes&&"removeEventListener"in iTunes&&(ITSPageMetricsUtil._pageReappearHandler&&!s.pingOnDidReAppear?(iTunes.removeEventListener("didreappear",ITSPageMetricsUtil._pageReappearHandler,!1),delete ITSPageMetricsUtil._pageReappearHandler):!ITSPageMetricsUtil._pageReappearHandler&&s.pingOnDidReAppear&&(ITSPageMetricsUtil._pageReappearHandler=function(){ITSPageMetricsUtil._didDisappear&&(ITSPageMetricsUtil._DV6PageHandler(!1),ITSPageMetricsUtil._didDisappear=!1)},iTunes.addEventListener("didreappear",ITSPageMetricsUtil._pageReappearHandler,!1),iTunes.addEventListener("diddisappear",function(){ITSPageMetricsUtil._didDisappear=!0}))),o},ITSPageMetricsUtil.handleSF6PageEvent=function(e,t){ITSMetrics.pageData=e;
if(e.omnitureMetrics){ITSMetrics.reportingSuite=its.property("SF6.Metrics.ReportingSuite"),ITSMetrics.isClickMetricsEnabled=e.omnitureMetrics.isClickMetricsEnabled,ITSMetrics.isBuyMetricsEnabled=e.omnitureMetrics.isBuyMetricsEnabled;
if("_WARNING"in e.omnitureMetrics){var n=newElement("p",e.omnitureMetrics._WARNING);
n.style["-webkit-user-select"]="text",n.style["background-color"]="red",n.style.width="100%",n.style.margin="10px",n.style["font-size"]="24px",document.body.insertBefore(n,document.body.firstChild)}ITSMetrics.omniture&&ITSMetrics.omniture.pageName!=e.omnitureMetrics.pageName&&ITSPageMetricsUtil.onPageHidden(null),ITSMetrics.omniture=ITSMetrics.createBaselineOmnitureObject(),ITSMetrics.omniture.pageName=e.omnitureMetrics.pageName,ITSMetrics.omniture.products=e.omnitureMetrics.products,ITSMetrics.omniture.prop22=ITSMetrics.omniture.eVar22=e.omnitureMetrics.format,"channel"in e.omnitureMetrics&&(ITSMetrics.omniture.channel=e.omnitureMetrics.channel),"dsid"in e.omnitureMetrics&&(ITSMetrics.omniture.prop28=ITSMetrics.omniture.eVar28=e.omnitureMetrics.dsid);
var r=ITSMetrics.omniture.prop12=ITSMetrics.omniture.eVar12=navigator.userAgent;
ITSMetrics.isGameCenter(r)&&(ITSMetrics.omniture.pageName&&(ITSMetrics.omniture.pageName=ITSMetrics.gameCenterPrefix+ITSMetrics.omniture.pageName),ITSMetrics.omniture.channel&&(ITSMetrics.omniture.channel=ITSMetrics.gameCenterPrefix+ITSMetrics.omniture.channel)),"searchTerm"in e.omnitureMetrics?ITSMetrics.searchTerm=ITSMetrics.omniture.prop2=ITSMetrics.omniture.eVar2=e.omnitureMetrics.searchTerm:(delete ITSMetrics.searchTerm,delete ITSMetrics.omniture.prop2,delete ITSMetrics.omniture.eVar2),ITSMetrics.processQueryParameterInfoInCurrentRequest(ITSMetrics.omniture)}(!document||!document.hidden)&&!t&&e.omnitureMetrics&&e.omnitureMetrics.isPageMetricsEnabled&&ITSMetrics.isOmnitureSupportedOnClient()?ITSMetrics.omniture.t():ITSPageMetricsUtil.logger.warn("ITSMetrics: page ping disabled")};
if("its"in window&&"sf6"in its){var isDesktop=!1;
its.sf.Platform?isDesktop=its.sf.Platform.desktop():its.client&&(isDesktop=its.client.platformIsDesktop),isDesktop&&window.addEventListener("load",function(e){e.target==window.document&&("omnitureMetrics"in its.serverData.pageData||"metrics"in its.serverData.pageData)&&ITSPageMetricsUtil.handleSF6PageEvent(its.serverData.pageData)},!1)}ITSPageMetricsUtil.referrerPageInfo=function(){if(!its.isDefined(ITSPageMetricsUtil._referrerPageInfo)){ITSPageMetricsUtil._referrerPageInfo=null;
var t=its.cookies.get(ITSPageMetricsUtil.ReferrerPageInfoKey);
if(its.isDefinedNonNull(t)){var n=t.split(ITSPageMetricsUtil.MetricsStringSeparator);
if(n.length>=3){var r=n[0],i=n[1],s=n[2],o=n.length==4?n[3]:null;
ITSPageMetricsUtil._referrerPageInfo=new ITSMetricsPageInfo(r,o,i,s)}}}return ITSPageMetricsUtil._referrerPageInfo},ITSPageMetricsUtil.registerClickInCurrentPageInfo=function(t){if(!its.isDefinedNonNull(t))return;var n=ITSPageMetricsUtil.currentPageInfo();
n&&(n.location=t)},ITSPageMetricsUtil._pageNameExtrasForBuyMetrics=function(){var t=null;
return"omniture"in ITSMetrics&&"prop28"in ITSMetrics.omniture&&ITSMetrics.omniturePageName()&&(t=this.prop28),t},ITSPageMetricsUtil._saveReferrerPageInfo=function(t){if(!its.isDefinedNonNull(t))return;var n=[ITSPageMetricsUtil._prepareSerializedInfo(t.pageName),ITSPageMetricsUtil._prepareSerializedInfo(t.channelName),ITSPageMetricsUtil._prepareSerializedInfo(t.location),ITSPageMetricsUtil._prepareSerializedInfo(t.pageNameExtrasForBuyMetrics)],r=n.join(ITSPageMetricsUtil.MetricsStringSeparator);
r?(its.cookies.set(ITSPageMetricsUtil.ReferrerPageInfoKey,r,its.cookies.EXPIRE_SESSION,null,"itunes.apple.com"),ITSPageMetricsUtil.logger.info("referrer page info: saving cookie: "+r)):(its.cookies.remove(ITSPageMetricsUtil.ReferrerPageInfoKey),ITSPageMetricsUtil.logger.info("referrer page info: expiring cookie"))},ITSPageMetricsUtil._prepareSerializedInfo=function(t){return t?t.replace(ITSPageMetricsUtil.MetricsStringSeparator," "):""},ITSPageMetricsUtil.pageMetricsByAppendingPageNameDetails=function(e,t){if(null==t||t.length==0)return e;
if(!e.pageName)return e;
if(null==e||"object"!=typeof e)return e;
var n=e.constructor();
for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);
return n.pageName+="-"+t,n},ITSLocationMetricsUtil.LOCATION_KEY="metrics-loc",ITSLocationMetricsUtil.LOCATION_DETAILS_KEY="metrics-loc-details",ITSLocationMetricsUtil.LOCATION_LEAF_KEY="metrics-leaf",ITSLocationMetricsUtil.LOCATION_HREF_KEY="metrics-href",ITSLocationMetricsUtil.LOCATION_SEPARATOR="|",ITSLocationMetricsUtil._elementOrAncestorByFunction=function(e,t){while(e&&e!=document){if(t(e))return e;
e=e.parentNode}return null},ITSLocationMetricsUtil.isClickMetricsEnabled=function(t){var n=ITSLocationMetricsUtil._elementOrAncestorByFunction(t.parentNode,function(e){return e.hasAttribute("metrics-click")}),r=n?"true"==n.getAttribute("metrics-click"):ITSMetrics&&ITSMetrics.isClickMetricsEnabled;
return r},ITSLocationMetricsUtil.isBuyMetricsEnabled=function(){return ITSMetrics&&ITSMetrics.isBuyMetricsEnabled},ITSLocationMetricsUtil.generateLocationString=function(t,n,r){var i=[],s=null;
for(var o=t;
o;
o=o.parentNode){var u=ITSLocationMetricsUtil._locationForElement(o),a=!1;
u&&(i.push(u),a=!0);
if(s){var f=null;
u?f=u.metricsElement:o.tagName&&o.tagName.toLowerCase()=="body"&&(f=o),f&&ITSLocationMetricsUtil._modifyChildWithDetailsIfNecessary(f,s)}a&&(s=u)}if(i.length===0)return null;
var l="";
for(;
;){var u=i.pop();
if(!u)break;l.length>0&&(l+=ITSLocationMetricsUtil.LOCATION_SEPARATOR),l+=u.metricsString,u.metricsDetails&&(l+=u.metricsDetails)}var c=ITSMetrics.omniturePageName();
return c&&!n&&(l=c+ITSLocationMetricsUtil.LOCATION_SEPARATOR+l),r&&(l=l+ITSLocationMetricsUtil.LOCATION_SEPARATOR+r),l},ITSLocationMetricsUtil.appendBuyMetricsToBuyParams=function(t,n,r){if(!Object.keys||!t||t.length===0)return t;
buyMetrics=ITSLocationMetricsUtil.getBuyMetricsParams(n,r);
var i=Object.keys(buyMetrics);
for(var s=0;
s<i.length;
s++){var o=i[s];
t+="&"+o+"="+encodeURIComponent(buyMetrics[o])}return t},ITSLocationMetricsUtil.getBuyMetricsParams=function(e,t){var n={};
if(!ITSLocationMetricsUtil.isBuyMetricsEnabled())return n;
ITSMetrics.omniturePageName()&&(n.origPage=ITSMetrics.omniturePageName());
var r=ITSPageMetricsUtil._pageNameExtrasForBuyMetrics();
r&&(n.origPageExtras=r),ITSMetrics.omnitureChannel()&&(n.origPageCh=ITSMetrics.omnitureChannel());
var i=ITSLocationMetricsUtil.generateLocationString(e,!0,t);
i&&(n.origPageLocation=i);
var s=ITSPageMetricsUtil.referrerPageInfo();
s&&(s.pageName&&(n.origPage2=s.pageName),s.pageNameExtrasForBuyMetrics&&(n.origPageExtras2=s.pageNameExtrasForBuyMetrics),s.channelName&&(n.origPageCh2=s.channelName),s.location&&(n.origPageLocation2=s.location));
var o=ITSLocationMetricsUtil.getSearchMetrics(e,"B");
return o&&(n.origPageSearch=o),n},ITSLocationMetricsUtil.getSearchMetrics=function(t,n){var r=ITSMetrics.searchTerm;
if(r){var i=ITSLocationMetricsUtil._getAdamId(t);
i===null&&(i="unknownAdamid");
var s=n+"|"+encodeURIComponent(r)+"|"+i;
return s}return null},ITSLocationMetricsUtil.emitCustomClickEvent=function(e,t){var n=ITSLocationMetricsUtil.isClickMetricsEnabled(e);
ITSMetricsClickHandler._performPing(e,t,n)},ITSLocationMetricsUtil.setCustomClickHref=function(e,t){e&&t&&(e[ITSLocationMetricsUtil.LOCATION_HREF_KEY]=t)},ITSLocationMetricsUtil.hrefForTargetElement=function(e){return e.hasOwnProperty(ITSLocationMetricsUtil.LOCATION_HREF_KEY)?e[ITSLocationMetricsUtil.LOCATION_HREF_KEY]:e.hasAttribute&&e.hasAttribute(ITSLocationMetricsUtil.LOCATION_HREF_KEY)?e.getAttribute(ITSLocationMetricsUtil.LOCATION_HREF_KEY):e.tagName&&e.tagName.toLowerCase()=="a"?e.href:""},ITSLocationMetricsUtil.setCustomClickAdamId=function(e,t){e&&t?e[ITSPageMetricsUtil.ADAM_ID]=t:e&&e[ITSPageMetricsUtil.ADAM_ID]&&delete e[ITSPageMetricsUtil.ADAM_ID]},ITSLocationMetricsUtil._getAdamId=function(t){var n=t;
while(n&&n!=document){if(n.hasAttribute&&n.hasAttribute("adam-id"))return n.getAttribute("adam-id");
if(n[ITSPageMetricsUtil.ADAM_ID])return n[ITSPageMetricsUtil.ADAM_ID];
n=n.parentNode}return null},ITSLocationMetricsUtil._locationForElement=function(e){return e.hasAttribute&&e.hasAttribute(ITSLocationMetricsUtil.LOCATION_KEY)?{metricsString:e.getAttribute(ITSLocationMetricsUtil.LOCATION_KEY),metricsElement:e}:null},ITSLocationMetricsUtil._modifyChildWithDetailsIfNecessary=function(e,t){var n=t.metricsString;
if(n.length>0&&n.charAt(n.length-1)=="_"){var r="["+ITSLocationMetricsUtil.LOCATION_KEY+'="'+n+'"]',i=e.querySelectorAll(r);
if(t.metricsElement.hasAttribute(ITSLocationMetricsUtil.LOCATION_DETAILS_KEY))t.metricsDetails=t.metricsElement.getAttribute(ITSLocationMetricsUtil.LOCATION_DETAILS_KEY);
else{var s=-1;
for(var o=0;
o<i.length;
o++)if(i[o]===t.metricsElement){s=o;
break}s>=0&&(t.metricsDetails=s+1)}}},ITSMetricsClickHandler.Events={CLICK:"ITSMetricsClickHandler.Event.CLICK"},ITSMetricsClickHandler.logger=ITSLogger.named("ITSMetricsClickHandler"),ITSMetricsClickHandler.handleClickEvent=function(e){var t=ITSLocationMetricsUtil.isClickMetricsEnabled(e.target);
if(!t)return;if(e.button!=0||e.ctrlKey==1)return;var n=ITSMetricsClickHandler._clickTargetElement(e.target);
if(!n)return;ITSMetricsClickHandler._performPing(n,null,t)},ITSMetricsClickHandler.handleDropDownChangeEvent=function(e){var t=e.target;
if(!ITSLocationMetricsUtil.isClickMetricsEnabled(t))return;if(t.tagName!="SELECT")return;var n=t.options[t.selectedIndex],r=n;
if(!r)return;ITSMetricsClickHandler._performPing(r,null,!0)},ITSMetricsClickHandler._performPing=function(e,t,n){its.notifications.publish(ITSMetricsClickHandler.Events.CLICK,{name:ITSMetricsClickHandler.Events.CLICK,sender:ITSMetricsClickHandler,target:e,subElementLocation:t});
var r=ITSLocationMetricsUtil.generateLocationString(e,!1);
if(!r)return;t!==null&&(r+=ITSLocationMetricsUtil.LOCATION_SEPARATOR+t);
var i=ITSMetrics.createBaselineOmnitureObject();
i.linkTrackVars="hier5";
var s=ITSLocationMetricsUtil.getSearchMetrics(e,"C");
s&&(i.prop19=s,i.eVar19=s,i.linkTrackVars=i.linkTrackVars+",prop19,eVar19");
var o=ITSLocationMetricsUtil._getAdamId(e);
o!==null&&(i.prop29=o,i.eVar29=o,i.linkTrackVars=i.linkTrackVars+",prop29,eVar29");
if(n){ITSMetricsClickHandler.logger.info("Click metrics: "+r);
var u=n?r:"n/a";
i.prop30=u,i.eVar30=u,i.linkTrackVars+=",prop30,eVar30",ITSLocationMetricsUtil.hrefForTargetElement(e)!==""?i.tl(e,"o",u):i.tl(!0,"o",u),ITSPageMetricsUtil.registerClickInCurrentPageInfo(ITSLocationMetricsUtil.generateLocationString(e,!0))}delete i.linkTrackVars,delete i.prop19,delete i.eVar19,delete i.prop29,delete i.eVar29,delete i.prop30,delete i.eVar30},ITSMetricsClickHandler._clickTargetElement=function(e){var t=e;
while(t&&t!=document){if(t.tagName.toLowerCase()=="a"||t.hasAttribute(ITSLocationMetricsUtil.LOCATION_LEAF_KEY))return t;
t=t.parentNode}return null},ITSMetrics.isOmnitureSupportedOnClient()&&(document.addEventListener("mousedown",ITSMetricsClickHandler.handleClickEvent,!0),document.addEventListener("change",ITSMetricsClickHandler.handleDropDownChangeEvent,!0)),its.Logger=function(e){e||(e="default"),this._name=e,its.Logger._loggers||(its.Logger._loggers={}),its.Logger._loggers[e]=this},its.Logger.DEBUG=1,its.Logger.INFO=2,its.Logger.WARN=3,its.Logger.ERROR=4,its.Logger.STATS=5,its.Logger._loggingMethods=typeof console!="undefined"?[console.debug,console.info,console.warn,console.error]:null,its.Logger._version="3.1",its.Logger._intraFieldSeparator="|",its.Logger._visitorIdVersion="v6",its.Logger._undefinedValue="undefined",its.Logger._levelsAsText={},its.Logger._levelsAsText[its.Logger.DEBUG]="debug",its.Logger._levelsAsText[its.Logger.INFO]="info",its.Logger._levelsAsText[its.Logger.WARN]="warn",its.Logger._levelsAsText[its.Logger.ERROR]="error",its.Logger._levelsAsText[its.Logger.STATS]="stats",its.Logger.Defaults={},its.Logger.Defaults.loggerName="Logger",its.Logger.Defaults.level=its.Logger.ERROR,its.Logger._loggingEnabledToConsole=function(){return!its.property("ITSLogger.DisableLoggingToConsole")},its.Logger._loggingEnabledToServer=function(){return its.serverData&&!its.property("ITSLogger.DisableLogging")},its.Logger.setLevel=function(e){its.Logger._level=e},its.Logger.named=function(e){var t=null;
return e||(e=its.Logger.Defaults.loggerName),its.Logger._loggers&&(t=its.Logger._loggers[e]),t||(t=new its.Logger(e)),t},its.Logger.prototype={name:function(){return this._name},setLevel:function(e){this._level=e},level:function(){var e=its.property(this.name()+".LoggerLevel");
return e||(e=its.property("LoggerLevel")),e||(e=this._level),e||(e=its.Logger._level),e||(e=its.Logger.Defaults.level),e=its.Logger._levelToInt(e),e},isAnyDebugLevel:function(){return its.isDefinedNonNull(this._anyDebugLevel)?returnValue=this._anyDebugLevel:(this._anyDebugLevel=this.level()<its.Logger.ERROR?!0:!1,returnValue=this._anyDebugLevel),returnValue},levelText:function(){returnAsInt||(returnLevel=its.Logger._levelToText(returnLevel))},debug:function(e,t,n,r){return this._funnelLogger(its.Logger.DEBUG,!1,e,t,n,r)},info:function(e,t,n,r){return this._funnelLogger(its.Logger.INFO,!1,e,t,n,r)},warn:function(e,t,n,r){return this._funnelLogger(its.Logger.WARN,!1,e,t,n,r)},error:function(e,t,n,r){typeof n=="undefined"&&its.property("ITSLogger.mirrorToServerByDefaultOnErrors")&&(n=!0);
try{undefined.intentionallyCauseError()}catch(i){i.stack&&(t||(t={}),t.callstack=i.stack)}return this._funnelLogger(its.Logger.ERROR,!1,e,t,n,r)},stats:function(e,t,n){return this._funnelLogger(its.Logger.STATS,!1,e,t,n)},_funnelLogger:function(e,t,n,r,i,s){var o=null;
if(n){var u=this.level(),a=e;
a==its.Logger.STATS&&(e=its.Logger.INFO);
var f=e-1,l=(e>=u||e==its.Logger.ERROR)&&its.Logger._loggingMethods&&its.Logger._loggingMethods[f]?!0:!1;
if(l){var c=its.property("LoggerFilter");
if(!its.isDefined(c)||c=="")c=null;
c&&c!=this._cachedloggerFilterString&&(this._cachedloggerFilterString=c,this._cachedloggerFilter=new RegExp(this._cachedloggerFilterString));
var h="";
e==its.Logger.WARN?h+="WARN: ":e==its.Logger.ERROR&&(h+="ERROR: "),h+=this.name()+":",o=h+" "+n,!s&&(e==its.Logger.ERROR||e==its.Logger.WARN||its.Logger._passesRegexFilterTest(this._cachedloggerFilter,o))&&its.Logger._loggingMethods[f].apply(console,[h].concat(n));
if(e==its.Logger.ERROR&&window.iTunes&&iTunes.log){var p=h+" "+n.toString();
iTunes.log(p)}}return i&&its.Logger._notifyServer(n,this.name(),r,a),o}}},its.Logger._levelToInt=function(e){if(e!=null&&e.toUpperCase){var t=its.string.toInt(e);
if(isNaN(t)){var n=e?e.toUpperCase():"";
n=="DEBUG"?e=its.Logger.DEBUG:n=="INFO"?e=its.Logger.INFO:n=="WARN"?e=its.Logger.WARN:n=="ERROR"?e=its.Logger.ERROR:e=its.Logger.Defaults.level}else e=t}return e},its.Logger._levelToText=function(e){return its.Logger._levelsAsText[e]},its.Logger._passesRegexFilterTest=function(e,t){var n=!1;
if(!e||t.search(e)!=-1)n=!0;
return n},its.Logger._notifyServer=function(e,t,n,r,i,s){var o=null;
if(its.Logger._loggingEnabledToServer()){var u={};
e||(e=its.Logger._undefinedValue),u.messageParam=e;
if(!n||!n.message)n||(n={}),n.message=e;
u.loggerName=t,r||(r=its.Logger._undefinedValue),u.loggingThreshold=r;
var a={};
u||(u={});
var f="",l=null,c=its.property("ITSLogger.ServerReportingProtocol"),h=its.property("ITSLogger.ServerReportingDomain"),p=its.property("ITSLogger.ServerReportingApp"),d="/WebObjects/"+p+".woa/wa/";
i?its.string.startsWith(i,"http",!0)||(its.string.startsWith(i,"//")||(f="//"),f=c+f):i=c+"://"+h,f=i,s?(its.string.startsWith(s,"/")||(s="/"+s),its.string.endsWith(s,"/")||(s+="/")):s=d,f+=s,f+=its.property("ITSLogger.RecordStatsAction"),f+="?eventType="+t,f+="&version="+its.Logger._version;
var v=(new Date).getTime(),m=v-its.markupLoadStartTime,g=null;
document&&document.body&&document.body.className?g=document.body.className:g=its.Logger._undefinedValue;
if(!n)n={};
else for(var y in n)a[t+"_"+y]=n[y];
u.version=its.Logger._version,u.iTunesVersion=its.Logger._cleanValue(its.sf.Client.version()),u.eventType=u.loggerName,u.serverEnvironment=its.Logger._cleanValue(its.property("ITSServerEnvironment")),u.serverEnvironmentDetailsString=its.Logger._cleanValue(window.status),its.reflect.copyKeysAndValues(window.statusData,u),u.serverInstance=its.Logger._cleanValue(its.property("ITSServerInstance"));
var b=its.Logger._cleanValue(its.Logger._dsid());
u.dsid=b;
var w=its.Logger._locallyStoredVisitorIdMap(b),E=w[b];
u.visitorId=E;
var S=its.reflect.values(w);
u.visitorIds=JSON.stringify(S);
var x=1;
w.unknown?S.length>=3&&(x=S.length-1):x=S.length,u.visitorCount=x,u.omnitureVisitorId=its.Logger._cleanValue(its.cookies.get("s_vi")),u.metricsClientId=its.Logger._cleanValue(its.cookies.get("xp_ci")),u.vip=its.property("vip"),u.resourceRevNum=its.property("ITSResourceRevNum"),u.windowLocationHref=window&&window.location&&window.location.href?window.location.href:"undefined",u.timeOfLog=v,u.markupLoadStartTime=its.markupLoadStartTime,u.markupLoadEndTime=its.Logger._cleanValue(its.markupLoadEndTime),u.markupLoadTotalTime=its.markupLoadStartTime&&its.markupLoadEndTime?its.markupLoadEndTime-its.markupLoadStartTime:"undefined",u.timeElapsedFromLoadStart=m,u.pageName=its.Logger._omnitureValue("omniturePageName"),u.pageChannel=its.Logger._omnitureValue("omnitureChannel"),u.pageClassName=g,u.allowDeferJsLoad=its.property("MZHtmlResourcesUtil.allowDeferJsLoad")?!0:!1,u.clientForceServerNotifications=its.property("ITSLogger.clientForceServerNotifications")?!0:!1;
for(var y in u)a["ITSLogger_"+y]=u[y];
a.sender=its.property("ITSLogger.SenderName");
var T=its.property("ITSLogger.blacklistedServerNotificationsFields");
if(T!=null)for(var N=0;
N<T.length;
N++){var C=T[N];
delete a[C]}l=JSON.stringify(a);
var k=new XMLHttpRequest;
k.open("POST",f,!0),k.setRequestHeader("Content-type","application/json"),k.send(l),o=l}return o},its.Logger._omnitureValue=function(e){var t=its.Logger._undefinedValue;
if(window.ITSMetrics){var n=ITSMetrics[e]();
n&&(t=n)}return t},its.Logger._cleanValue=function(e){if(!e||e=="")e=its.Logger._undefinedValue;
return e},its.Logger._createVisitorId=function(e){var t=null,n="[LS]",r=e?"1":"0",i=its.string.generateUuid(23,10),s="[LE]",o=[n,its.Logger._visitorIdVersion,r,i,s];
return t=o.join(its.Logger._intraFieldSeparator),t},its.Logger._visitorMapVersionAdjustments=function(e){var t=its.reflect.values(e);
if(t&&t.length){var n=t[0],r=n.split(its.Logger._intraFieldSeparator);
r[1]!=its.Logger._visitorIdVersion&&(e={})}return e},its.Logger._locallyStoredVisitorIdMap=function(e){var t={},n=null,r="ITSLogger.visitorIds",i=its.sf.LocalStorage.getItem(r);
return i&&(t=JSON.parse(i),t=its.Logger._visitorMapVersionAdjustments(t),n=t[e]),n||(t[e]=its.Logger._createVisitorId(e!=its.Logger._undefinedValue),its.sf.LocalStorage.setItem(r,JSON.stringify(t))),t},its.Logger._dsid=function(){var e=0;
return its&&its.sf6&&its.sf.Client?e=its.sf.Client.dsId():typeof itms!="undefined"&&(e=itms.DSID),e},window.SF_EXCEPTION_LOGGER_NAME="ITSExceptionHandler",window._sf_itsComposeErrorMessage=function(e,t,n,r){var i="unknown (might be html-embedded script?)",s="unknown";
its.isDefinedNonNull(t)&&t!=""&&t!="undefined"&&(i=t),its.isDefinedNonNull(n)&&n!=""&&(s=n);
var o='{message:"'+e+'", url:"'+i+'", lineNumber:"'+s+'"}';
return o},window._sf_itsOnErrorCallback=function(e,t,n){if(e&&e instanceof Event){var r=e.target;
r&&(e="Error attempting to load a script: id="+r.id+" src="+r.src+" type="+r.type+", contents:"+r.innerHTML)}var i={message:e,url:t,lineNumber:n};
fullMessage=window._sf_itsComposeErrorMessage(e,t,n,window.SF_EXCEPTION_LOGGER_NAME),its.Logger.named(window.SF_EXCEPTION_LOGGER_NAME).error(fullMessage,i,!0,!0)},window._earlyOnerrorException&&(window._sf_itsOnErrorCallback(window._earlyOnerrorException.message,window._earlyOnerrorException.url,window._earlyOnerrorException.lineNumber),window._earlyOnerrorException=null),window.onerror=window._sf_itsOnErrorCallback,ITSLogger=function(e){return this._logger=its.Logger.named(e),this._logger},ITSLogger.named=function(e){return this._logger=its.Logger.named(e),this._logger},ITSLogger.prototype={debug:function(e,t,n,r){this._logger.debug(e,t,n)},info:function(e,t,n,r){this._logger.info(e,t,n)},warn:function(e,t,n,r){this._logger.warn(e,t,n)},error:function(e,t,n,r){this._logger.error(e,t,n)}},its.sf.DelayedCallQueue.objectReady("its.Logger"),its.sf.DelayedCallQueue.objectReady("ITSLogger"),window.its||(window.its={}),window.its.sf||(window.its.sf={}),its.sf.Metrics={},its.sf.Metrics._logger=its.Logger.named("its.sf.Metrics"),its.sf.Metrics._TOPIC_MAIN="xp_its_main",its.sf.Metrics.ActionType={ADD:"add",AD_TRANSPARENCY:"ad_transparency",AD_RELEVANT_YES:"ad_relevant_yes",AD_RELEVANT_NO:"ad_relevant_no",BACK:"back",BUY:"buy",BUY_INITIATE:"buyInitiate",DELETE:"delete",DIALOG:"dialog",DISMISS:"dismiss",DOWNLOAD:"download",FOCUS:"focus",NAVIGATE:"navigate",NOTIFY:"notify",OPEN:"open",PAUSE:"pause",PLAY:"play",REVEAL:"reveal",SAMPLE:"sample",SELECT:"select",SHEET:"sheet",SORT:"sort",STOP:"stop",SUBSCRIBE:"subscribe",UPDATE:"update"},its.sf.Metrics._LOCATION_KEY="metrics-loc",its.sf.Metrics._LOCATION_DETAILS_KEY="metrics-loc-details",its.sf.Metrics._LOCATION_LEAF_KEY="metrics-leaf",its.sf.Metrics.EventType={ACCOUNT:"account",BASE:"base",BUY_CONFIRMED:"buyConfirmed",CLICK:"click",PAGE:"page",DIALOG:"dialog",ENTER:"enter",EXIT:"exit",IMPRESSIONS:"impressions",MEDIA:"media",SEARCH:"search",TIME_ADJUSTED:"timeAdjusted"},its.sf.Metrics.itmsAvailable=typeof itms!="undefined",its.sf.Metrics.iTunesAvailable=typeof iTunes!="undefined",its.sf.Metrics.bagMetrics=function(){if(!its.sf.Metrics._bagMetricsCache){its.sf.Metrics._bagMetricsFull=null,its.sf.Metrics._bagMetricsCache={};
var e=null,t=null,n=null;
its.sf.Metrics.itmsAvailable?(t=itms.getBag(),n=typeof Device!="undefined"&&Device.appIdentifier):its.sf.Metrics.iTunesAvailable&&(t=typeof iTunes.getBag=="function"&&iTunes.getBag(),n=typeof iTunes.appBundleName!="undefined"?iTunes.appBundleName:null),t?(its.sf.Metrics._bagMetricsFull=t.metrics,its.sf.Metrics._bagMetricsFull||(e="Bag: metrics section not found")):e="Bag: bag not found",e&&its.sf.Metrics._logger.error(e);
if(its.sf.Metrics._bagMetricsFull){var r=its.sf.Metrics._bagMetricsFull,i=r[n];
its.reflect.copyKeysAndValues(r,its.sf.Metrics._bagMetricsCache),its.reflect.copyKeysAndValues(i,its.sf.Metrics._bagMetricsCache)}}return its.sf.Metrics._bagMetricsCache},its.sf.Metrics.bagMetricsBase=function(){if(!its.sf.Metrics._bagMetricsBaseCache){var e=its.sf.Metrics.bagMetrics().metricsBase;
its.sf.Metrics._bagMetricsBaseCache={},(its.sf14||its.sf.Metrics.itmsAvailable)&&e&&its.reflect.copyKeysAndValues(e,its.sf.Metrics._bagMetricsBaseCache)}return its.sf.Metrics._bagMetricsBaseCache},its.sf.Metrics.recordEvent=function(e,t,n){var r=e.fields;
r&&(t||(t="xp_its_main"),r=its.sf.Metrics.doesEventContainIadData(r),its.sf.Metrics.itmsAvailable&&itms.recordEvent?(r.xpSendMethod="itms",itms.recordEvent(t,r)):its.sf.Metrics.iTunesAvailable&&iTunes.recordEvent?(r.xpSendMethod="itunes",iTunes.recordEvent(t,r)):its.MetricsQueue&&its.MetricsQueue.recordEvent?(r.xpSendMethod="javascript",its.MetricsQueue.recordEvent(t,r,n)):its.sf.Metrics._logger.warn('No native or JavaScript "recordEvent" method found',null,!0))},its.sf.Metrics.doesEventContainIadData=function(e){if(e.iAd||e.iAdId||e.iAdAlgoId||e.iAdMetadata||e.iAdFormat||e.iAdImpressionId)e.hasiAdData=!0;
else if(e.impressions){var t=e.impressions.length;
for(var n=0;
n<t;
n++)if(e.impressions[n].iAdId||e.impressions[n].iAdAlgoId||e.impressions[n].iAdMetadata||e.impressions[n].iAdFormat||e.impressions[n].iAdImpressionId){e.hasiAdData=!0;
break}}return e},its.sf.Metrics.blacklistedEvents=null,its.sf.Metrics.blacklistedEventsMap=function(){return its.sf.Metrics.configFieldMap("blacklistedEvents")},its.sf.Metrics.blacklistedFields=null,its.sf.Metrics.blacklistedFieldsMap=function(){return its.sf.Metrics.configFieldMap("blacklistedFields")},its.sf.Metrics.configFieldMap=function(e){var t={};
if(its.sf.Metrics.config.disabled)its.sf.Metrics[e]={};
else if(!its.sf.Metrics[e]){t=its.arrayToMap(its.sf.Metrics.config[e]);
var n=its.arrayToMap(its.property("metrics."+e));
its.reflect.copyKeysAndValues(n,t);
var r=its.arrayToMap(its.pageData("metrics.config."+e));
its.reflect.copyKeysAndValues(r,t),Object.keys(t).length&&(its.sf.Metrics[e]=t)}else t=its.sf.Metrics[e];
return t},its.sf.Metrics.eventDisabled=function(e){var t=!1;
if(its.sf.Metrics.config.disabled)t=!0;
else{var n=its.sf.Metrics.blacklistedEventsMap();
n[e]&&(t=!0)}return t},its.sf.Metrics.fieldsMappedData=function(e,t){var n={},r=null;
its.sf.Metrics.config.fieldsMap&&(r=its.objectAtPath(t,its.sf.Metrics.config.fieldsMap));
if(r){if(!its.isArray(e)){var i=[];
i.push(e),e=i}for(var s in r){var o=r[s],u=null;
for(var a=0;
a<o.length;
a++){var f=o[a];
for(var l=0;
l<e.length;
l++){var c=e[l];
u=its.objectAtPath(f,c);
if(u){if(s=="id"){var h=u.toString(),p=h.indexOf("."),d="its";
p!=-1&&(d=h.substring(0,p)),n.idType=d+its.sf.Metrics.config.compoundSeparator+f}break}}if(u)break}u&&(n[s]=u)}}else its.sf.Metrics.config.disabled||its.sf.Metrics._logger.error("fieldsMap does not contain a section called: "+t);
return n},its.sf.Metrics.setLocationInfo=function(e,t,n){if(!its.sf.Metrics.config.disabled){e.metrics||(e.metrics={});
var r=its.sf.Metrics.fieldsMappedData(t,"custom.location");
r.locationType=n,e.metrics.locationInfo=r}},its.sf.Metrics.setTargetInfo=function(e,t,n,r,i,s){if(!its.sf.Metrics.config.disabled){e.metrics||(e.metrics={});
var o={};
o.targetId=t,o.targetId==null&&delete o.targetId,o.targetType=n,o.targetType==null&&delete o.targetType,o.targetActionType=r,o.targetActionType==null&&delete o.targetActionType,o.targetActionUrl=i,o.targetActionUrl==null&&delete o.targetActionUrl,o.targetActionDetails=s,o.targetActionDetails==null&&delete o.targetActionDetails,o.target=n+its.sf.Metrics.config.compoundSeparator+t,o.target==null&&delete o.target,e.metrics.targetInfo=o}},its.sf.Metrics.clearTargetInfo=function(e){its.sf.Metrics.setTargetInfo(e,null,null,null,null,null)},its.sf.Metrics.pingMetricsBeforePageUnload=function(e,t,n,r,i,s){its.sf.Metrics.setTargetInfo(e,t,n,r,i,s),ITSLocationMetricsUtil.setCustomClickHref(e,i),ITSLocationMetricsUtil.emitCustomClickEvent(e,null)},its.sf.Metrics._locationForElement=function(e){return e.hasAttribute&&e.hasAttribute(its.sf.Metrics._LOCATION_KEY)?{metricsString:e.getAttribute(its.sf.Metrics._LOCATION_KEY),metricsElement:e}:null},its.sf.Metrics.assignFieldValue=function(e,t,n,r,i,s){if(t&&t.length>=1){s||(s=t);
var o=its.sf.Metrics.blacklistedFieldsMap(),u=i?i+".":"";
if(!o[t]&&!o[u+t])if(!e||!its.isDefined(e[t])){e||(e={});
var a=its.valueOverride(s);
its.isDefined(a)||(r?a=definedValue(its.pageData(r+"."+s),n):a=n),a&&its.isDefined(a)?e[t]=a:delete e[t]}else its.isDefined(e[t])&&!e[t]&&delete e[t]}return e},its.sf.Metrics.assignFieldValues=function(e,t,n,r,i){if(e)for(var s in e)t=its.sf.Metrics.assignFieldValue(t,s,e[s],n,r,i);
return t},its.sf.Metrics.baseDataFields=function(e,t,n){var r=n?n:null;
if(!r){var i=its.sf.Metrics.bagMetricsBase(),s={};
its.reflect.copyKeysAndValues(i,s);
var o=its.property("metrics.metricsBase");
if(o)for(var u in o)s[u]=o[u];
r=s}if(!r.pageContext&&its.sf.Platform.isITML()&&typeof TabBar!="undefined"&&TabBar.selectedTab){var a=its.App&&its.App.StoreSheetData;
a?r.pageContext="Sheet":r.pageContext=its.string.capitalizeString(TabBar.selectedTab.identifier)}var f=its.sf.Metrics.assignFieldValues(r,e,null,t);
return f},its.sf.Metrics.pageDataFields=function(e,t){var n=its.pageData("metricsBase"),r=its.sf.Metrics.assignFieldValues(n,e,null,t);
return r},its.sf.Metrics.environmentFields=function(e,t){var n={};
n.baseVersion=its.sf.Metrics._BASE_VERSION,n.resourceRevNum=its.property("ITSResourceRevNum"),n.timezoneOffset=(new Date).getTimezoneOffset(),n.clientId=its.cookies.get("xp_ci"),its.sf14||its.sf.Metrics.itmsAvailable?(itms.storefront&&(n.storeFrontHeader=itms.
  storefront)
  ,n.app=Device.appIdentifier,n.hostApp=itms.hostApp,n.appVersion=Device.appVersion,n.osVersion=Device.systemVersion,n.dsId=itms.DSID,n.userAgent=itms.userAgent,n.connection=itms.networkConnectionType,n.screenWidth=Settings.Screen.width,n.screenHeight=Settings.Screen.height,n.pixelRatio=Device.pixelRatio,typeof Device!="undefined"&&Device.capacity&&(n.capacitySystem=its.sf.Metrics._deResNumber(Device.capacity("totalSystemCapacity")),n.capacitySystemAvailable=its.sf.Metrics._deResNumber(Device.capacity("totalSystemAvailable")),n.capacityDisk=its.sf.Metrics._deResNumber(Device.capacity("totalDiskCapacity")),n.capacityData=its.sf.Metrics._deResNumber(Device.capacity("totalDataCapacity")),n.capacityDataAvailable=its.sf.Metrics._deResNumber(Device.capacity("totalDataAvailable")))):its.sf.Metrics.iTunesAvailable&&(n.storeFrontHeader=iTunes.storefront,n.app=iTunes.appBundleName,n.appVersion=its.sf.Client.version(),n.osVersion=its.client&&its.client.osVersion&&its.client.osVersion()||iTunes.systemVersion&&iTunes.systemVersion()||its.sf.Metrics._macOsVersion(),n.dsId=its.sf.Client.dsId(),isNaN(n.dsId)&&(n.dsId=null),n.pageUrl=window&&window.location&&window.location.href?window.location.href:null,n.userAgent=navigator.userAgent,n.screenWidth=screen.width,n.screenHeight=screen.height,n.pixelRatio=window.devicePixelRatio,n.windowInnerWidth=window.innerWidth,n.windowInnerHeight=window.innerHeight,n.windowOuterWidth=window.outerWidth,n.windowOuterHeight=window.outerHeight,n.windowOrientation=window.orientation,n.browserEngineType="AppleWebKit",n.browserType="iTunes",n.browserVersion=its.sf.Client.version()),e=its.sf.Metrics.assignFieldValue(e,"xpPostFrequency",its.sf.Metrics.config.postFrequency,"metrics",t,"postFrequency");
for(aField in n)e=its.sf.Metrics.assignFieldValue(e,aField,n[aField],null,t);
return e},its.sf.Metrics._deResNumber=function(t){if(typeof t!="undefined")return Math.floor(Math.floor(t/1024/1024)/100)*100},its.sf.Metrics.requestId=function(){var t="z",n=Date.now(),r=Math.floor(Math.random()*1e5);
return n=n.toString(36).toUpperCase(),r=r.toString(36).toUpperCase(),its.cookies.get("xp_ci")+t+n+t+r},its.sf.Metrics.derivedFields=function(e,t){var n=e,r=null,i=its.property("metrics.fieldsMap");
i||(i=its.sf.Metrics.config.fieldsMap);
if(i){var s=i.cookies;
if(s)for(var o=0;
o<s.length;
o++){var u=s[o],a=its.cookies.get(u);
a&&(r||(r={}),r[u]=a)}}return r&&(n.cookies=r,n=its.sf.Metrics.assignFieldValues(n,e,null,t)),n},its.sf.Metrics.allDerivedFields=function(e,t,n){var r=its.sf.Metrics.baseDataFields(e,t,n);
return r=its.sf.Metrics.pageDataFields(r,t),r=its.sf.Metrics.environmentFields(r,t),r=its.sf.Metrics.derivedFields(r,t),r},its.sf.Metrics._createConfig=function(){var e={};
its.MetricsQueue&&its.MetricsQueue.config.disabled&&(e.disabled=!0);
if(!e.disabled){var t={};
its.reflect.copyKeysAndValues(its.sf.Metrics.bagMetrics(),t);
var n=its.property("metrics");
e=t;
if(n)for(var r in n)e[r]=n[r];
e.metricsBase=null,delete e.metricsBase;
for(var r in e){var i=its.valueOverride("metrics."+r);
i&&(e[r]=i)}e.localStorage=its.sf.LocalStorage,e.postResponseCallback=its.sf.Metrics._postResponseCallback}return e},its.sf.Metrics._postResponseCallback=function(e,t){if(e==200){var n=its.string.evalJson(t);
if(n){n.setSf&&its.sf.Metrics.iTunesAvailable&&iTunes.setStorefront&&iTunes.storefront!=n.setSf&&(iTunes.version&&its.sf.Metrics._logger.warn("iTunes "+iTunes.version+" x-set-apple-storefront="+n.setSf+" failed (old header="+iTunes.storefront+"). Setting by hand...",null,!0),iTunes.setStorefront(n.setSf));
if(n.setCookies)for(var r=0;
r<n.setCookies.length;
r++){var i=n.setCookies[r],s=its.cookies.get(i.name);
s!=i.value&&its.cookies.set(i.name,i.value,i.expiration,i.path,i.domain)}}}},its.sf.Metrics._macOsVersion=function(e){e||(e=navigator.userAgent);
var t=e.match(/Mac.*OS X ([\d_\-\.]+)/);
return t&&t.length>1?t[1]:null},its.sf.Metrics.setConfig=function(e){if(e&&!e.disabled)if(!its.sf.Metrics.config||its.sf.Metrics.config.stubConfig)its.sf.Metrics.config=e;
else for(var t in e)!its.sf.Metrics.config[t]&&e.hasOwnProperty(t)&&its.isDefined(e[t])&&(its.sf.Metrics.config[t]=e[t]);
else its.sf.Metrics.config={},e?its.sf.Metrics.config.disabled=e.disabled:(its.sf.Metrics.config.stubConfig=!0,its.sf.Metrics.config.disabled=!0);
(!its.sf.Metrics.itmsAvailable||!itms.recordEvent)&&(!its.sf.Metrics.iTunesAvailable||!iTunes.recordEvent)&&its.MetricsQueue&&its.MetricsQueue.recordEvent&&its.MetricsQueue&&its.MetricsQueue.setConfig(its.sf.Metrics.config)},its.sf.Metrics.setConfig(its.sf.Metrics._createConfig()),its.sf.Metrics||(its.sf.Metrics={}),its.sf.Metrics.Events={},its.sf.Metrics.Events.Base=Class.create("its.sf.Metrics.Events.Base",{initialize:function(e,t,n,r,i){var s="base";
this._logger=its.Logger.named(this.klassName),e||(e={}),this.fields=e,this.eventType=t,this.eventVersion=n,i=definedValue(i,definedValue(its.property("metrics.topic_main"),its.sf.Metrics._TOPIC_MAIN)),this.topic=i,this.fields=this.assignFieldValues(this.fields,null),this.fields=this.assignFieldValue(this.fields,"eventType",t),this.fields=this.assignFieldValue(this.fields,"eventVersion",n),this.fields=this.assignFieldValue(this.fields,"topic",i),this.fields=this.assignFieldValue(this.fields,"eventTime",(new Date).getTime()),this.fields=its.sf.Metrics.allDerivedFields(this.fields,this.eventType,r)},assignFieldValue:function(e,t,n,r){return its.sf.Metrics.assignFieldValue(e,t,n,r,this.eventType)},assignFieldValues:function(e,t,n){return its.sf.Metrics.assignFieldValues(e,t,n,this.eventType)}}),its.sf.Metrics._BASE_VERSION=1,its.createObjectPath("its.sf.Metrics.Events"),its.sf.Metrics.Events.Click=Class.createSubclass("its.sf.Metrics.Events.Click",its.sf.Metrics.Events.Base,{initialize:function(e,t){this.base(e,its.sf.Metrics.EventType.CLICK,this.version(),t)},version:function(){return its.sf.Metrics._CLICK_VERSION}}),its.sf.Metrics.Events.Click._modifyChildWithDetailsIfNecessaryDeprecatedHtmlOnly=function(e,t){var n=t.metricsString;
if(n.length>0&&n.charAt(n.length-1)=="_"){var r="["+its.sf.Metrics._LOCATION_KEY+'="'+n+'"]',i=e.querySelectorAll(r);
if(t.metricsElement.hasAttribute(its.sf.Metrics._LOCATION_DETAILS_KEY))t.metricsDetails=t.metricsElement.getAttribute(its.sf.Metrics._LOCATION_DETAILS_KEY);
else{var s=-1;
for(var o=0;
o<i.length;
o++)if(i[o]===t.metricsElement){s=o;
break}s>=0&&(t.metricsDetails=s+1)}}},its.sf.Metrics.Events.Click._generateLocationStackDeprecatedHtmlOnly=function(e,t,n){var r=[],i=null;
for(var s=e;
s;
s=s.parentNode){var o=its.sf.Metrics._locationForElement(s),u=!1;
o&&(r.push(o),u=!0);
if(i){var a=null;
o?a=o.metricsElement:s.tagName&&s.tagName.toLowerCase()=="body"&&(a=s),a&&its.sf.Metrics.Events.Click._modifyChildWithDetailsIfNecessaryDeprecatedHtmlOnly(a,i)}u&&(i=o)}if(r.length===0)return null;
var f="";
for(;
;){var o=r.pop();
if(!o)break;f.length>0&&(f+=its.sf.Metrics.config.tokenSeparator),f+=o.metricsString,o.metricsDetails&&(f+=o.metricsDetails)}var l=its.pageData("metricsBase.page");
return l&&!t&&(f=l+its.sf.Metrics.config.tokenSeparator+f),n&&(f=f+its.sf.Metrics.config.tokenSeparator+n),f},its.sf.Metrics.Events.Click.clickTargetElement=function(e){var t=e,n;
while(t&&t!=document){if(t.metrics&&t.metrics.targetInfo){n=t.metrics.targetInfo;
if(n.targetType)return t}t=t.parentNode}return null},its.sf.Metrics.Events.Click.clickDataFromElement=function(e,t,n,r){var i=null;
if(e&&e.metrics&&e.metrics.targetInfo){var s=e.metrics.targetInfo,o=s.targetType;
o&&(i={},its.sf.Metrics.itmsAvailable?i.location=its.sf.Metrics.Events.Click.location(e):i.location=its.sf.Metrics.Events.Click._generateLocationStackDeprecatedHtmlOnly(e),i.targetId=s.targetId,i.targetType=o,i.target=s.target,i.actionType=s.targetActionType,i.actionUrl=s.targetActionUrl,i.actionDetails=s.targetActionDetails,i.positionX=n,i.positionY=r,i.impressions=null),e.metrics.iAdId&&(i.iAdId=e.metrics.iAdId,i.iAdAlgoId=e.metrics.iAdAlgoId,i.iAdMetadata=e.metrics.iAdMetadata,i.iAdImpressionId=e.metrics.iAdImpressionId,i.iAdFormat=e.metrics.iAdFormat)}return i},its.sf.Metrics.Events.Click.location=function(e){var t=e,n=[],r={},i,s,o,u,a,f,l;
while(t){i=t.parentNode;
if(i){var c=t.metrics?t.metrics.locationInfo:null;
c?r=its.sf.Metrics.fieldsMappedData(c,"custom.location"):r={},l=its.sf.Metrics.Events.Click._getLocationType(t,c);
if(l){r.locationType=l,s=i.children,o=s.length,u=0;
for(var h=0;
h<o;
h++){var p=s.item(h);
a=p.metrics?p.metrics.locationInfo:null,f=its.sf.Metrics.Events.Click._getLocationType(p,a);
if(f){if(p==t)break;u++}}r.locationPosition=u,n.push(r)}}t=i}return n},its.sf.Metrics.Events.Click._getLocationType=function(e,t){var n=e.metrics?e.metrics.targetInfo:null,r=n?n.targetType:null,i=t?t.locationType:null;
return r?r:i},its.sf.Metrics._CLICK_VERSION=4,its.sf.Metrics.Events.Dialog=Class.createSubclass("its.sf.Metrics.Events.Dialog",its.sf.Metrics.Events.Base,{initialize:function(e,t){this.base(e,its.sf.Metrics.EventType.DIALOG,its.sf.Metrics._DIALOG_VERSION,t),this.fields=this.assignFieldValue(this.fields,"type"),this.fields=this.assignFieldValue(this.fields,"message"),this.fields=this.assignFieldValue(this.fields,"buttons"),this.fields=this.assignFieldValue(this.fields,"code")}}),its.sf.Metrics._DIALOG_VERSION=1,its.sf.Metrics.Events.Dialog._handleDialog=function(e){var t=null,n={};
its.sf.Metrics.recordEvent(new its.sf.Metrics.Events.Dialog(n))},!its.sf.Metrics.eventDisabled(its.sf.Metrics.EventType.DIALOG),its.sf.Metrics.Events.Enter=Class.createSubclass("its.sf.Metrics.Events.Enter",its.sf.Metrics.Events.Base,{initialize:function(e,t){this.base(e,its.sf.Metrics.EventType.ENTER,its.sf.Metrics._ENTER_VERSION,t),this.fields=this.assignFieldValue(this.fields,"type"),this.fields=this.assignFieldValue(this.fields,"refUrl"),this.fields=this.assignFieldValue(this.fields,"refApp")}}),its.sf.Metrics._ENTER_VERSION=1,its.sf.Metrics.Events.Enter._handleEnter=function(e){var t=null,n={};
its.sf.Metrics.recordEvent(new its.sf.Metrics.Events.Enter(n))},!its.sf.Metrics.eventDisabled(its.sf.Metrics.EventType.ENTER),its.createObjectPath("its.sf.Metrics.Events"),its.sf.Metrics.Events.Impressions=Class.createSubclass("its.sf.Metrics.Events.Impressions",its.sf.Metrics.Events.Base,{initialize:function(e,t){this.base(e,its.sf.Metrics.EventType.IMPRESSIONS,this.version(),t)},version:function(){return its.sf.Metrics._IMPRESSIONS_VERSION}}),its.sf.Metrics._IMPRESSIONS_VERSION=1,its.sf.Metrics.Events.Exit=Class.createSubclass("its.sf.Metrics.Events.Exit",its.sf.Metrics.Events.Base,{initialize:function(e,t){this.base(e,its.sf.Metrics.EventType.EXIT,its.sf.Metrics._EXIT_VERSION,t),this.fields=this.assignFieldValue(this.fields,"type")}}),its.sf.Metrics._EXIT_VERSION=1,its.sf.Metrics.Events.Exit._handleExit=function(e){var t=null,n={type:null};
its.sf.Metrics.recordEvent(new its.sf.Metrics.Events.Exit(n))},!its.sf.Metrics.eventDisabled(its.sf.Metrics.EventType.EXIT),its.sf.Metrics.Events.Page=Class.createSubclass("its.sf.Metrics.Events.Page",its.sf.Metrics.Events.Base,{initialize:function(e,t){this.base(e,its.sf.Metrics.EventType.PAGE,this.version(),t),this.fields=this.assignFieldValue(this.fields,"pageLoadTime",this.fields.pageLoadTime),this.fields=this.assignFieldValue(this.fields,"pageRenderTime",this.fields.pageRenderTime),this.fields=this.assignFieldValue(this.fields,"navigation",this.fields.navigation),this.fields=this.assignFieldValue(this.fields,"isUber",this.fields.isUber,"metrics.fields"),this.fields=this.assignFieldValue(this.fields,"searchFilters",this.fields.searchFilters,"metrics.fields"),this.fields=this.assignFieldValue(this.fields,"searchTerm",this.fields.searchTerm,"metrics.fields"),this.fields=this.assignFieldValue(this.fields,"serverInstance",this.fields.serverInstance,"metrics.fields"),this.fields=this.assignFieldValue(this.fields,"serverTiming",this.fields.serverTiming,"metrics.fields"),this.fields=this.assignFieldValue(this.fields,"refUrl",document.referrer),typeof iTunes!="undefined"&&iTunes.referringUserAgent&&(this.fields=this.assignFieldValue(this.fields,"refApp",iTunes.referringUserAgent));
var n=its.sf.Metrics.Events.Page.pageHistoryArray(),r=its.sf.Metrics.Events.Page.pageHistoryString();
this.fields=this.assignFieldValue(this.fields,"pageHistory",r),n.push(this.fields.page),n=n.splice(-5,5),its.sf.LocalStorage.setItem(its.sf.Metrics._PAGEHISTORY_LOCAL_STORAGE_KEY,JSON.stringify(n))},version:function(){return its.sf.Metrics._PAGE_VERSION}}),its.sf.Metrics.Events.Page.supersedeConfig=function(e){e&&its.sf.Metrics.setConfig(e)},its.sf.Metrics.Events.Page.pageHistoryString=function(){var e=its.sf.LocalStorage.getItem(its.sf.Metrics._PAGEHISTORY_LOCAL_STORAGE_KEY);
return e||(e=its.sf.LocalStorage.getItem("pageHistory"),e&&its.sf.LocalStorage.setItem(its.sf.Metrics._PAGEHISTORY_LOCAL_STORAGE_KEY,e),its.sf.LocalStorage.removeItem("pageHistory")),e},its.sf.Metrics.Events.Page.pageHistoryArray=function(){var e=its.sf.Metrics.Events.Page.pageHistoryString(),t;
if(e)try{t=JSON.parse(e)}catch(n){console.warn("EXCEPTION encountered while parsing localStorage.getItem("+its.sf.Metrics._PAGEHISTORY_LOCAL_STORAGE_KEY+"):",n),its.sf.LocalStorage.removeItem(its.sf.Metrics._PAGEHISTORY_LOCAL_STORAGE_KEY)}return its.isDefined(t)||(t=[]),t},its.sf.Metrics.Events.Page._handleLoadEvent=function(e){var t=e.pageInfo;
if(t){var n=(new Date).getTime(),r=e.target,i={pageLoadTime:n,pageUrl:e.url};
t.metrics&&its.sf.Metrics.Events.Page.supersedeConfig(t.metrics.config),its.sf.Metrics.eventDisabled(its.sf.Metrics.EventType.PAGE)||its.sf.Metrics.recordEvent(new its.sf.Metrics.Events.Page(i,t.metricsBase))}},its.sf.Metrics.eventDisabled(its.sf.Metrics.EventType.PAGE)||its.notifications.subscribe(its.sf.Events.PAGE_LOAD,its.sf.Metrics.Events.Page._handleLoadEvent),its.sf.Metrics._PAGE_VERSION=1,its.sf.Metrics._NAVIGATION_KEY="its.sf.Metrics.Navigation",its.sf.Metrics._PAGEHISTORY_LOCAL_STORAGE_KEY="its.sf.Metrics.Events.Page.pageHistory",its.sf.Metrics._NAVIGATION_FORWARD_VALUE="forward",its.sf.Metrics._NAVIGATION_BACK_VALUE="back",its.sf.Metrics.Events.TimeAdjusted=Class.createSubclass("its.sf.Metrics.Events.TimeAdjusted",its.sf.Metrics.Events.Base,{initialize:function(e,t){this.base(e,its.sf.Metrics.EventType.TIME_ADJUSTED,its.sf.Metrics._TIME_ADJUSTED_VERSION,t),this.fields=this.assignFieldValue(this.fields,"amount")}}),its.sf.Metrics._TIME_ADJUSTED_VERSION=1,its.sf.Metrics.Events.TimeAdjusted._handleTimeAdjusted=function(e){var t=null,n={amount:null};
its.sf.Metrics.recordEvent(new its.sf.Metrics.Events.TimeAdjusted(n))},!its.sf.Metrics.eventDisabled(its.sf.Metrics.EventType.TIME_ADJUSTED),its.createObjectPath("its.dvx.Metrics.Events"),its.dvx.Metrics.Events.Click=Class.createSubclass("its.dvx.Metrics.Events.Click",its.sf.Metrics.Events.Click,{version:function(){return its.dvx.Metrics._CLICK_VERSION}}),its.dvx.Metrics._CLICK_VERSION=1,its.dvx.Metrics.Events.Click._handleClickEvent=function(e){var t=its.sf.Metrics.Events.Click.clickDataFromElement(e.target,e.subElementLocation,null,null);
t&&its.sf.Metrics.recordEvent(new its.dvx.Metrics.Events.Click(t))},its.dvx.Metrics.Events.Click._handleDropDownChangeEvent=function(e){},its.sf.Metrics.eventDisabled(its.sf.Metrics.EventType.CLICK)||its.notifications.subscribe(ITSMetricsClickHandler.Events.CLICK,its.dvx.Metrics.Events.Click._handleClickEvent),its.createObjectPath("its.dvx.Metrics.Events"),its.dvx.Metrics.Events.Page=Class.createSubclass("its.dvx.Metrics.Events.Page",its.sf.Metrics.Events.Page,{version:function(){return its.dvx.Metrics._PAGE_VERSION}}),its.dvx.Metrics._PAGE_VERSION=1,its.dvx.Metrics.Events.Page._handleLoadEvent=function(e){this._loadTime=(new Date).getTime()-its.markupLoadStartTime},its.dvx.Metrics.Events.Page._handleRenderEvent=function(e){if(e&&e.pageData&&e.pageData.metrics&&e.pageData.metricsBase){its.dvx.Metrics.Events.Page._patchPageData(e.pageData);
if(!its.sf.Metrics.eventDisabled(its.sf.Metrics.EventType.PAGE)){this._renderTime=(new Date).getTime()-its.markupLoadStartTime;
var t={navigation:this._navigation,pageLoadTime:this._loadTime,pageRenderTime:null};
its.sf.Metrics.recordEvent(new its.dvx.Metrics.Events.Page(t))}}else its.dvx.Metrics.Events.Page._logger.warn("Received page load event with no pageData")},its.dvx.Metrics.Events.Page._patchPageData=function(e){its.flushDataCache(),"its"in window||(its={}),"serverData"in its||(its.serverData={}),"pageData"in its.serverData||(its.serverData.pageData={}),its.serverData.pageData.metrics=e.metrics,its.serverData.pageData.metricsBase=e.metricsBase,its.sf.Metrics.Events.Page.supersedeConfig(its.pageData("metrics.config"))},its.sf.Metrics.Events.Page.supersedeConfig(its.pageData("metrics.config")),its.sf.Metrics.eventDisabled(its.sf.Metrics.EventType.PAGE)||(its.notifications.subscribe(ITSMetrics.Events.PAGE,its.dvx.Metrics.Events.Page._handleLoadEvent),its.notifications.subscribe(ITSMetrics.Events.PAGE,its.dvx.Metrics.Events.Page._handleRenderEvent)),its.dvx.Metrics.Events.Page._logger=its.Logger.named(its.dvx.Metrics.Events.Page.klassName);
if(typeof KStartEvent=="undefined"){if(typeof KSupportsTouches=="undefined")var KSupportsTouches=its.client.isTouchSupported;
var KStartEvent=KSupportsTouches?"touchstart":"mousedown",KMoveEvent=KSupportsTouches?"touchmove":"mousemove",KEndEvent=KSupportsTouches?"touchend":"mouseup",KCancelEvent=KSupportsTouches?"touchcancel":""}its.kit.createController("iTSMobileTouchManagerCleanup",{binding:"body#MXAccountSummary, body#MXEditAccountWizard, body#MHSecondaryAuthPage",component:{init:function(){window.iTunes&&iTunes.addEventListener&&iTunes.addEventListener("didreappear",bind(this,"reappear"),!1)},reappear:function(e){selectedElements=document.querySelectorAll(".pressed"),selectedElements&&selectedElements.each(function(e){e.removeClassName("pressed")})}}}),its.kit.createController("iTSMobileTouchManager",{binding:'select, div.option, div.field input[type="submit"], div.more-button, div.boxed a div.button',component:{init:function(){this.wrapper=this.element.elementOrAncestorByFunction(function(e){return e.nodeName=="DIV"&&(e.hasClassName("field")||e.hasClassName("option")||e.hasClassName("button"))}),this.storage=window.sessionStorage;
if(this.storage!==undefined&&this.storage.getItem("pressedElement"))var e=this.storage.getItem("pressedElement");
this.wrapper.tint=this.wrapper.querySelector(".pressed-tint"),this.wrapper.tint==null&&(this.wrapper.tint=document.createElement("DIV"),this.wrapper.tint.addClassName("pressed-tint"),this.wrapper.tint.setAttribute("role","presentation"),this.wrapper.insertAdjacentElement("afterBegin",this.wrapper.tint)),this.element.nodeName=="SELECT"||this.wrapper.hasClassName("button")||this.wrapper.hasClassName("more-button")?this.wrapper._sticky=!0:this.wrapper._sticky=!1,this.element.addEventListener(KStartEvent,this,!1),this.element.addEventListener(KMoveEvent,this,!1),this.element.addEventListener(KEndEvent,this,!1),this.listen("DOMFocusIn"),this.listen("DOMFocusOut"),defer(this,function(){this.wrapper.hasClassName("pressed")&&this.wrapper.removeClassName("pressed")})},touchstartEvent:function(e){var t=this.wrapper;
t._startTouchPos=e.touches!=null&&e.touches[0]!=null?{x:e.touches[0].pageX,y:e.touches[0].pageY}:{x:e.pageX,y:e.pageY};
if(typeof t._touchisvalid=="undefined"||!t._touchisvalid){t._touchisvalid=!0,t._pressedTimer!=null&&(clearTimeout(t._pressedTimer),t._pressedTimer=null);
if(t.transitionDuration==null){t.transitionDuration=t.querySelector(".pressed-tint").getComputedStyleProperty("-webkit-transition-duration");
var n=t.querySelector("label");
n!=null&&n!=undefined&&(t.transitionDelay=n.getComputedStyleProperty("-webkit-transition-delay"))}t._pressedTimer=setTimeout(function(){t.addClassName("pressed")},40)}else t._touchisvalid=!1},touchmoveEvent:function(e){var t=this.wrapper;
if(t._touchisvalid==1){var n=e.touches!=null&&e.touches[0]!=null?{x:e.touches[0].pageX,y:e.touches[0].pageY}:{x:e.pageX,y:e.pageY};
diffX=Math.abs(n.x-t._startTouchPos.x),diffY=Math.abs(n.y-t._startTouchPos.y);
if(diffY>6){t._touchisvalid=!1,t._pressedTimer!=null&&clearTimeout(t._pressedTimer);
var r=t.querySelector("label");
t.tint.style.webkitTransitionDuration="0ms",r!=null&&r!=undefined&&(r.style.webkitTransitionDelay="0ms"),t.removeClassName("pressed"),setTimeout(function(){t.tint.style.webkitTransitionDuration=t.transitionDuration,r!=null&&r!=undefined&&(r.style.webkitTransitionDelay=t.transitionDelay)},0)}}},touchendEvent:function(e){var t=this.wrapper;
t._touchisvalid==1&&(t._sticky==0?(t._pressedTimer!=null&&clearTimeout(t._pressedTimer),t.removeClassName("pressed"),t._touchisvalid=!1):this.storage.setItem("pressedElement",this.element.id),this.dispatchCustomEvent(this.element,"iTSMobileTouchManager.event.pressed",{touchevent:e})),this._touchisvalid=!1},mousedownEvent:function(e){this.touchstartEvent(e)},mousemoveEvent:function(e){this.touchmoveEvent(e)},mouseupEvent:function(e){this.touchendEvent(e)},DOMFocusInEvent:function(e){!this.wrapper.hasClassName("pressed")&&this.element.nodeName=="SELECT"&&(this.element.focused=!0,this.touchstartEvent(e))},DOMFocusOutEvent:function(e){this.wrapper.hasClassName("pressed")&&this.element.nodeName=="SELECT"&&(this.wrapper._sticky=!1,this.element.focused=!1,this.touchendEvent(e))}}}),Validation.prototype.initValidation=function(e){if(navigator&&navigator.userAgent&&navigator.userAgent.match(/Android/)){var t=document.getElementById("creditCardNumberField"),n=document.getElementById("postalCodeField");
t&&t.setAttribute("pattern","[\\s\\d\\*]*"),n&&n.setAttribute("pattern","[\\d-]*")}e.querySelectorAll("form").each(function(e){e.validated=!1,e.clickedInput=null;
var t=!1,n=function(e){e.querySelectorAll("input").each(function(t){t.addEventListener("change",function(t){e.validated=e.validate(!1)})}),e.querySelectorAll("select").each(function(t){t.addEventListener("change",function(t){e.validated=e.validate(!1)})})};
e.validate=function(e){var t=!0,n=null;
return this.querySelectorAll(".required").each(function(e){var t=e.elementOrAncestorByFunction(function(e){return e.nodeName=="label"||e.nodeName=="DIV"&&e.hasClassName("field")});
t&&t.removeClassName("error")}),this.querySelectorAll(".required").each(function(e){e.tagName.toUpperCase()!=="LABEL"&&(e.tagName.toUpperCase()==="INPUT"||e.tagName.toUpperCase()==="SELECT"||e.tagName.toUpperCase()==="TEXTAREA"?e.setAttribute("required",""):e.setAttribute("aria-required","true"));
if((e.tagName=="INPUT"&&e.value==""||e.tagName=="SELECT"&&e.value=="WONoSelectionString"||e.value=="")&&!e.id.match("nucaptcha")&&!e.id.match("lmsubmitted")){var r=e.elementOrAncestorByFunction(function(e){return e.nodeName=="label"||e.nodeName=="DIV"&&e.hasClassName("field")});
if(e.parentNode.hasClassName("option-picker")){r=e.parentNode.previousElementSibling.tagName=="H2"?e.parentNode.previousElementSibling:null;
if(r===null){var i=e.getAttribute("error-label-class");
i&&(r=document.querySelector("h2."+i)||document.querySelector("h1."+i))}}t=!1,n==null&&(n=e,e.scrollIntoViewIfNeeded(!0)),r&&r.addClassName("error")}}),e&&!t&&defer(this,function(){alerter.alert(localize("MissingInfoPopupText"),localize("MissingInfoPopupTitle"),localize("Ok"))}),t&&document.querySelector("#securityQuestions")!=null&&(t=Validation.prototype.crAnswersValidation(e)),t},e.querySelectorAll("input").each(function(t){t.getAttribute("type")=="submit"&&(t.hasClassName("validate")?t.addEventListener("click",function(t){e.validated=e.validate(!0),e.clickedInput=t.target}):t.addEventListener("click",function(t){e.validated=!0,e.clickedInput=t.target}))})}),e.captureEvents(Event.SUBMIT),e.onsubmit=function(e){if(e.target.validated&&e.target.clickedInput)startLoadingButtonIndicator(e.target.clickedInput);
else if(nativeiTunes&&nativeiTunes.navigationBar){var t=nativeiTunes.navigationBar;
if(t){var n=t.leftItem,r=t.rightItem;
n&&(n.loading=!1,n.enabled=!0),r&&(r.loading=!1,r.enabled=!0)}}if(e.target.validated){its.client.isRunning&&its.string.compareNumerically(its.client.version(),"6.0")>=0&&Validation.prototype.disableNavigationButtons(),its.kit.sendToController("iTSDeviceAccountManagementController","submitEvent"),its.kit.sendToController("iTSDeviceSignupBillingFormController","submitEvent");
if(document.querySelector("#carm-container")&&!its.kit.sendToController("iTSCarmPaymentDetails","submitEvent",e))return!1}return e.target.validated}},Validation.prototype.disableNavigationButtons=function(){if(typeof iTunes!="undefined"&&typeof iTunes.viewController!="undefined"){var e=iTunes.viewController.navigationItem;
if(e){var t=e.leftItem;
t&&(t.action=null,t.enabled=!1);
var n=e.rightItem;
n&&(n.action=null,n.enabled=!1)}}},Validation.prototype.crAnswersValidation=function(e){var t=document.querySelectorAll("div#securityQuestions div.question span.value"),n=document.querySelectorAll("div#securityQuestions input.answer"),r=!0;
for(var i=0;
i<n.length;
i++){var s=n[i].value;
for(var o=0;
o<n.length;
o++)if(o!=i){var u=s==n[o].value;
r&&u&&(r=u);
if(u){var a=n[i].elementOrAncestorByFunction(function(e){return e.nodeName=="DIV"&&e.hasClassName("field")});
a!=null&&!a.hasClassName("error")&&a.addClassName("error")}}r&&(r=s!=t[i].innerText)}return e&&!r&&defer(this,function(){alerter.alert(its.loc("JS.errors.answerProblemDesc"),its.loc("JS.errors.answerProblemTitle"),localize("Ok"))}),r},window.addEventListener("DOMContentLoaded",function(){new Validation(document)},!0);
var SelectPlaceholder={noSelectionClass:"noselection",woNoSelectionString:"WONoSelectionString"};
SelectPlaceholder.init=function(){document.querySelectorAll("select").each(function(e){e.value==SelectPlaceholder.woNoSelectionString&&e.addClassName(SelectPlaceholder.noSelectionClass),e.addEventListener("change",function(t){t.target.value==SelectPlaceholder.woNoSelectionString?e.addClassName(SelectPlaceholder.noSelectionClass):e.removeClassName(SelectPlaceholder.noSelectionClass)},!1)})},document.addEventListener("DOMContentLoaded",SelectPlaceholder.init,!1);
var SelectCountyIoc={};
SelectCountyIoc.init=function(){var e=document.querySelector("select#select-county");
e&&e.addEventListener("change",function(e){document.querySelector("input#select-county-button").click()})},document.addEventListener("DOMContentLoaded",SelectCountyIoc.init,!1),document.addEventListener("DOMContentLoaded",disableButtons,!1),document.addEventListener("DOMContentLoaded",ccNumberEdit,!1),document.addEventListener("DOMContentLoaded",taxIdEdit,!1),FinMailManager.prototype.sendEmailAfterPromptingUser=function(){if(typeof iTunes.createDialog!="undefined"){var e=this.createEmailDialog();
e.show()}else this.emailTheTermsOld()},FinMailManager.prototype.emailTheTermsOld=function(){var e="",t=null,n=alerter.prompt(this._message,e,t,this._sendButtonLabel,this._cancelButtonLabel);
this.sendEmail(n)},FinMailManager.prototype.createEmailDialog=function(){var e=iTunes.createDialog(),t="default",n=iTunes.createTextField(t);
n.keyboardType="email";
var r=iTunes.createButton(this._cancelButtonLabel,null),i=this,s=iTunes.createButton(this._sendButtonLabel,function(){i.sendEmail(n.value)});
return e.title=this._message,e.textFields=Array(n),e.buttons=Array(r,s),e.cancelButtonIndex=0,e.emailValue=function(){return e.emailField.value},e},FinMailManager.prototype.sendEmail=function(e){if(!e)return!1;
if(!isValidEmail(e))return alerter.alert(this._errorMessage,""),!1;
var t=its.url.appendUrlParameter(this._directActionUrl,"e",e),n=new XMLHttpRequest;
n.open("GET",t,!1);
var r=-1;
try{n.send(null),r=n.status}catch(i){r=i}var s=r==200?n.responseText:this._errorMessage;
alerter.alert(s,"")};
var footers={featured:"featured",genius:"genius"},reloadFootersAfterGeniusOptOut=function(e,t,n){e==null&&(e=footers),n&&(t?g4aHelper.clearSectionCache(e.genius):iTunes.reloadFooterSection(e.featured))},reloadFootersAfterGeniusOptIn=function(e,t,n){n?iTunes.reloadFooterSection(e.genius):iTunes.reloadFooterSection(e.featured,t)},saveCuid=function(e){var t=null;
iTunes.setLibraryIdentifier("app-genius",e),iTunes.sendPostOfType("app-genius",{completionCallback:t})},removeClientCuid=function(){iTunes.setLibraryIdentifier("app-genius",null)},gotoGeniusForAppsWelcomePage=function(e,t,n){t==null&&(t=footers),iTunes.dismissSheet();
if(n){var r=iTunes.sectionsController;
if(r){var i=r.sectionWithIdentifier(footers.genius);
if(i){var s=i.viewController;
s.className!="iTunesNavigationController"&&(s=s.navigationController),dismissOverlay(),s.popToRootViewController(!1),s.topViewController.reload(),r.selectedSection=i}}else iTunes.selectFooterTab(t.genius)}else iTunes.selectFooterTab(t.featured);
iTunes.openURL(e)},g4aHelper={clearSectionCache:function(e){var t=iTunes.sectionsController;
if(t){var n=t.sectionWithIdentifier(e);
if(n){var r=n.viewController;
r.className!="iTunesNavigationController"&&(r=r.navigationController);
var i=!1;
r.popToRootViewController(i),r.topViewController.reload()}return n}return iTunes.reloadFooterSection(e),null}},dismissOverlay=function(){var e={animate:!1};
iTunes.window!=null?iTunes.window.dismiss(e):iTunes.dismissSheet()};
iTSDVBuyUtil={},iTSDVBuyUtil.createBuyDict=function(e){var t=new Object;
return t.actionParams=e.actionParams,t.artworkURL=e.artworkUrl,t.artistName=e.artistName,t.itemType=e.itemType,t.itemId=e.itemId,t.title=e.title,"true"==e.isPreorder&&(t.isPreorder=!0,t["is-preorder"]=!0),t.feedUrl=e.feedUrl,t.feedName=e.feedName,t.bundleId=e.bundleId,t.iconIsPreRendered=e.iconIsPreRendered,e.softwareType&&(t["software-type"]=e.softwareType),iTSDVBuyUtil.supportsNewsstand()&&(e.newsstandLatestIssueIcon&&(t.artworkURL=e.newsstandLatestIssueIcon),e.newsstandBindingEdge&&(t.UINewsstandBindingEdge=e.newsstandBindingEdge),e.newsstandBindingType&&(t.UINewsstandBindingType=e.newsstandBindingType)),t.requiredCapabilities=e.requiredCapabilities,t.minimumOSVersion=e.minimumOSVersion,e.fileSize&&(t["file-size"]=e.fileSize),e.versionId&&(t.versionID=e.versionId),e.publicationVersion&&(t.publicationVersion=e.publicationVersion),e.pageProgressionDirection&&(t.pageProgressionDirection=e.pageProgressionDirection),"true"==e.isExplicitBook&&(t.explicit=!0),e.parentalControlAttributes&&(t.parental_control_attributes=e.parentalControlAttributes),e.priceType&&(t.priceType=e.priceType),e.ownerDsid&&(t.ownerDsid=e.ownerDsid),t},iTSDVBuyUtil.createBuyOptions=function(e){var t=new Object;
return e!=null&&(t.exitAfterFinished=e==="true"),t},iTSDVBuyUtil.buyDictFromJsonBuyData=function(e,t){t||(t=document.body);
var n=iTSDVBuyUtil.getJsonParam(e,"action-params"),r=iTSDVBuyUtil.getJsonParam(e,"sub-element-location");
defined("ITSLocationMetricsUtil")&&(n=ITSLocationMetricsUtil.appendBuyMetricsToBuyParams(n,t,r));
var i=iTSDVBuyUtil.getJsonParam(e,"item-title"),s=iTSDVBuyUtil.getJsonParam(e,"artist-name"),o=iTSDVBuyUtil.getJsonParam(e,"item-id"),u=iTSDVBuyUtil.getJsonParam(e,"item-type"),a=iTSDVBuyUtil.getJsonParam(e,"artwork-url"),f=iTSDVBuyUtil.getJsonParam(e,"is-preorder"),l=iTSDVBuyUtil.getJsonParam(e,"file-size"),c=iTSDVBuyUtil.getJsonParam(e,"bundle-id"),h=iTSDVBuyUtil.getJsonParam(e,"icon-is-prerendered"),p=iTSDVBuyUtil.getJsonParam(e,"software-type"),d=iTSDVBuyUtil.getJsonParam(e,"newsstand-latest-issue-icon"),v=iTSDVBuyUtil.getJsonParam(e,"newsstand-binding-edge"),m=iTSDVBuyUtil.getJsonParam(e,"newsstand-binding-type"),g=iTSDVBuyUtil.getJsonParam(e,"required-capabilities"),y=iTSDVBuyUtil.getJsonParam(e,"minimum-os-version"),b=iTSDVBuyUtil.getJsonParam(e,"versionID"),w=iTSDVBuyUtil.getJsonParam(e,"publicationVersion"),E=iTSDVBuyUtil.getJsonParam(e,"pageProgressionDirection"),S=iTSDVBuyUtil.getJsonParam(e,"feed-url"),x=iTSDVBuyUtil.getJsonParam(e,"feed-name"),T={actionParams:n,artistName:s,artworkUrl:a,itemId:o,itemType:u,title:i,isPreorder:f,bundleId:c,iconIsPreRendered:h,softwareType:p,newsstandLatestIssueIcon:d,newsstandBindingEdge:v,newsstandBindingType:m,requiredCapabilities:g,minimumOSVersion:y,fileSize:l,versionId:b,feedUrl:S,feedName:x,publicationVersion:w,pageProgressionDirection:E};
return iTSDVBuyUtil.createBuyDict(T)},iTSDVBuyUtil.getJsonParam=function(e,t){var n=e[t];
return n?n:null},iTSDVBuyUtil.buyDictFromBuyButton=function(e){var t=e.getAttribute("action-params");
defined("ITSLocationMetricsUtil")&&(t=ITSLocationMetricsUtil.appendBuyMetricsToBuyParams(t,e));
var n=e.getAttribute("item-title"),r=e.getAttribute("artist-name"),i=e.getAttribute("item-id"),s=e.getAttribute("item-type"),o=e.getAttribute("artwork-url"),u=e.getAttribute("is-preorder"),a=e.getAttribute("file-size"),f=e.getAttribute("bundle-id"),l=e.getAttribute("icon-is-prerendered"),c=e.getAttribute("software-type"),h=e.getAttribute("newsstand-latest-issue-icon"),p=e.getAttribute("newsstand-binding-edge"),d=e.getAttribute("newsstand-binding-type"),v=e.getAttribute("required-capabilities"),m=e.getAttribute("minimum-os-version"),g=e.getAttribute("versionID"),y=e.getAttribute("publicationVersion"),b=e.getAttribute("pageProgressionDirection"),w=e.getAttribute("feed-url"),E=e.getAttribute("feed-name"),S={actionParams:t,artistName:r,artworkUrl:o,itemId:i,itemType:s,title:n,isPreorder:u,bundleId:f,iconIsPreRendered:l,softwareType:c,newsstandLatestIssueIcon:h,newsstandBindingEdge:p,newsstandBindingType:d,requiredCapabilities:v,minimumOSVersion:m,fileSize:a,versionId:g,feedUrl:w,feedName:E,publicationVersion:y,pageProgressionDirection:b};
return iTSDVBuyUtil.createBuyDict(S)},iTSDVBuyUtil.buyOptionsDictFromBuyButton=function(e){var t=e.getAttribute("exit-after-finished");
return iTSDVBuyUtil.createBuyOptions(t)},iTSDVBuyUtil.buyActionWithParameters=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m={actionParams:t,artistName:n,artworkUrl:r,itemId:i,itemType:s,title:o,isPreorder:u,bundleId:a,iconIsPreRendered:f,softwareType:l,requiredCapabilities:c,minimumOSVersion:h,fileSize:p,versionId:d},g=iTSDVBuyUtil.createBuyDict(m);
iTSDVBuyUtil.buyActionWithBuyDict(e,g,v)},iTSDVBuyUtil.buyActionWithBuyButton=function(e,t){var n=iTSDVBuyUtil.buyDictFromBuyButton(t),r=iTSDVBuyUtil.buyOptionsDictFromBuyButton(t);
iTSDVBuyUtil.buyActionWithBuyDict(e,n,r)},iTSDVBuyUtil.buyActionWithJsonBuyData=function(e,t,n,r){var i=null;
if(its.isArray(t)){i=new Array;
for(var s=0;
s<t.length;
s++){var o=t[s],u=iTSDVBuyUtil.buyDictFromJsonBuyData(o,n);
i.push(u)}}else i=iTSDVBuyUtil.buyDictFromJsonBuyData(t,n);
iTSDVBuyUtil.buyActionWithBuyDict(e,i,r)},iTSDVBuyUtil.buyActionWithBuyDict=function(e,t,n){if(!defined("iTunes")){console.log(t);
return}var r=its.isArray(t),i=0;
if(r)for(var s=0;
s<t.length;
s++){var o=t[s];
if(!iTSDVBuyUtil.allowBuyActionForBuyDict(o))return;i+=iTSDVBuyUtil.fileSizeForDeterminingRequiredSpaceFromBuyDict(o),iTSDVBuyUtil.mungeBuyDict(o)}else{if(!iTSDVBuyUtil.allowBuyActionForBuyDict(t))return;i=iTSDVBuyUtil.fileSizeForDeterminingRequiredSpaceFromBuyDict(t),iTSDVBuyUtil.mungeBuyDict(t)}var u=function(i,s){if(i){if(iTunes.protocol&&iTunes.protocol.clientIdentifier=="Podcasts"){if(its.isDefinedNonNullNonEmpty(n))for(var o in n)t[o]=n[o];
its.isDefinedNonNullNonEmpty(e)&&(t.animationId=e),iTunes.subscribe(t)}else e&&iTunes.performPurchaseAnimation(e);
iTSDVBuyUtil._logEnabled&&console.log("Calling Buy Action: "+JSON.stringify(t)),iTunes.buyAction(t,n)}else if(!iTSDVBuyUtil.hasNewSpaceCheck()){var u;
r?u=its.loc("Js.BuyButton.NotEnoughSpaceToDownloadItems"):u=its.loc("Js.BuyButton.NotEnoughSpaceToDownloadItem"),iTunes.alert(u)}else{var a=iTunes.createDialog();
a.title=its.loc("Js.BuyButton.CannotDownload");
if(r)a.body=its.loc("Js.BuyButton.NotEnoughAvailableStorage.Multiple");
else{var f=t.title;
a.body=its.loc("Js.BuyButton.NotEnoughAvailableStorage",{itemName:f})}var l=iTunes.createButton(its.loc("Done"),null),c=iTunes.createButton(its.loc("Settings"),function(e){iTunes.openURL("prefs:root=General&path=USAGE")});
a.buttons=Array(l,c),a.cancelButtonIndex=0,a.show()}},a=t.isPreorder,f=!a&&i>0&&defined("iTunes");
f=!1;
if(f)if(!iTSDVBuyUtil.hasNewSpaceCheck()){var l=i<iTunes.diskSpaceAvailable();
u(l,i)}else{var c={};
c[iTunes.device.FREE_SPACE_OPTION_EFFORT_LEVEL]=iTunes.device.FREE_SPACE_EFFORT_DO_NOTHING,iTunes.device.requestFreeSpace(i,c,u)}else u(!0,i)},iTSDVBuyUtil._logEnabled=!1,iTSDVBuyUtil.mungeBuyDict=function(e){var t=e.itemType;
t=="movie-bundle"&&(t="movie"),t=="tone"&&its.client.version()<"5.0"&&(t="ringtone"),t=="textbook"&&(t="eBook"),t=="thirdPartyMix"&&(t="wemix"),e.itemType=t;
if(t=="software"){var n=e.itemId,r=iTSDVOnDevice.getApp(n);
if(r&&r.ratingRank){var i=r.ratingRank,s=e.actionParams,o=its.url.parseQueryParams(s);
o.installedSoftwareRating=i,s=its.url.buildUrlFromMap(o),e.actionParams=s}}},iTSDVBuyUtil.shouldRestrictIOSVersion=function(e){var t=its.serverData.properties.vendLastSupportedVersionIfAvailable;
return t?!1:e&&its.string.compareNumerically(its.client.version(),e)<0?!0:!1},iTSDVBuyUtil.allowBuyActionForBuyDict=function(e){var t=e.requiredCapabilities;
if(!iTSDVBuyUtil.checkCapabilities(t))return!1;
var n=e.minimumOSVersion;
if(iTSDVBuyUtil.shouldRestrictIOSVersion(n)){var r=its.loc("ix.ApplicationNotCompatible.WarningTitle"),n=e.minimumOSVersion,i=iTSDVBuyUtil.stripTrailingDotZerosFromOSVersion(n),s=its.loc("ix.ApplicationNotCompatible.SoftwareUpdateDescription",{version:i}),o=its.loc("OK");
return iTunes.alert(s,r,o),!1}return!0},iTSDVBuyUtil.downloadAction=function(e,t){var n=new Array;
n[0]=t,e&&iTunes.performPurchaseAnimation(e),iTunes.addExternalDownloads(n)},iTSDVBuyUtil.stripTrailingDotZerosFromOSVersion=function(e){while(its.string.endsWith(e,".0"))e=e.substring(0,e.length-2);
return e},iTSDVBuyUtil.hasNewSpaceCheck=function(){return iTunes.device&&iTunes.device.requestFreeSpace},iTSDVBuyUtil.checkCapabilities=function(e){if(e){var t="<dict>",n=e.split(" ");
for(var r=0;
r<n.length;
r++)n[r].length>0&&(t+="<key>"+n[r]+"</key><true/>");
return t+="</dict>",defined("iTunes")?iTunes.checkCapabilities(t,!0):!1}return!0},iTSDVBuyUtil.fileSizeForDeterminingRequiredSpaceFromBuyDict=function(e){var t=e["file-size"];
if(t){var n=parseInt(t);
if(e.itemType=="software"||e.itemType=="eBook")n*=2.5;
return n}return null},iTSDVBuyUtil._supportsNewsstandCache=null,iTSDVBuyUtil.supportsNewsstand=function(){return iTSDVBuyUtil._supportsNewsstandCache||(iTSDVBuyUtil._supportsNewsstandCache=defined("iTunes")&&its.string.compareNumerically(its.client.version(),"5.0")>=0),iTSDVBuyUtil._supportsNewsstandCache};
const K2StartEvent="createTouch"in document?"touchstart":"mousedown",K2BuyButtonStateNormal=0,K2BuyButtonStateSelected=4,K2BuyButtonStateDisabledCSS="disabled",K2BuyButtonStateSelectedCSS="selected",K2BuyButtonHeight=25,K2BuyButtonTypeDefault="default",K2BuyButtonTypePrice="price",K2BuyButtonTypeNonPurchasable="non-purchasable",K2BuyButtonAlignmentLeft=0,K2BuyButtonAlignmentCenter=1,K2BuyButtonAlignmentRight=2,K2BuyButtonTypeDefaultMaxWidth=220,K2BuyButtonTypePriceMaxWidth=220;
its.kit.createController("iTSK2BuyButton",{binding:"div.buy:not(.hidden)"}),iTSK2BuyButton.Events={},iTSK2BuyButton.Events.PODCAST_EPISODE_DOWNLOADED="podcastEpisodeDownloaded",iTSK2BuyButton.Events.COLLECTION_SUBSCRIBED="collectionSubscribed",its.x&&its.x.extendWithEventDispatching&&its.x.extendWithEventDispatching(iTSK2BuyButton),iTSK2BuyButtonController.prototype.domReady=function(){this.globalTextWidthDict={};
if(defined("iTunes")&&iTunes.addEventListener)try{iTunes.addEventListener("buttonOpened",bind(this,"buttonOpenedEvent"),!1),iTunes.addEventListener("buttonClosed",bind(this,"buttonClosedEvent"),!1)}catch(t){its.client.log(t)}},iTSK2BuyButtonController.prototype.buttonOpenedEvent=function(t){var n=JSON.parse(t);
n["overlayUrl"]==window.location.href&&document.addEventListener(K2StartEvent,this,!1)},iTSK2BuyButtonController.prototype.buttonClosedEvent=function(t){var n=JSON.parse(t);
n["overlayUrl"]==window.location.href&&document.removeEventListener(K2StartEvent,this,!1)},iTSK2BuyButtonController.prototype.handleEvent=function(){if(its.client.isRunning){event.preventDefault();
var t=new Object;
t.overlayUrl=window.location.href;
var n=JSON.stringify(t);
iTunes.dispatchGlobalEvent("closeButtons",n),document.removeEventListener(K2StartEvent,this,!1)}},iTSK2BuyButtonController.prototype.load=function(){try{var t=new Image,n=document.querySelector("meta[name='resource-image-path']").getAttribute("content");
its.client.platformIsP2&&["left_blue.2x","left_blue_pressed.2x","left_app.2x","left_app_pressed.2x","left_app_fat.2x","left_app_fat_pressed.2x","left_green.2x","left_green_pressed.2x","left_green_fat.2x","left_green_fat_pressed.2x","left_red.2x","left_red_pressed.2x","middle_blue.2x","middle_blue_pressed.2x","middle_app.2x","middle_app_pressed.2x","middle_brown","middle_brown_pressed","middle_green.2x","middle_green_pressed.2x","middle_red.2x","middle_red_pressed.2x","right_blue.2x","right_blue_pressed.2x","right_app.2x","right_app_pressed.2x","right_app_fat.2x","right_app_fat_pressed.2x","right_green.2x","right_green_pressed.2x","right_green_fat.2x","right_green_fat_pressed.2x","right_red.2x","right_red_pressed.2x"].each(function(e){t.src=n+e+".png"})}catch(r){its.client.log(r)}},iTSK2BuyButtonController.allBuyButtons=function(){return its.kit._controllers.iTSK2BuyButtonController._components},iTSK2BuyButton.prototype.init=function(){if(!this.element.hasAttribute("rating-disabled")&&!this.element.hasAttribute("button-disabled")){this.animateOnActionContainer=this.element.parentByAttributeName("animate-on-action-container");
var e=this;
its.x.extendWithEventDispatching(this),this.itsDelegateEvents(iTSK2BuyButton),this.element.addEventListener(K2StartEvent,function(){if(e.element.wired)return;e.element.wired=!0,!e.element.hasAttribute("confirm-text")&&e.element.hasClassName("one-click")?(e.element.addEventListener("touchstart",function(){},!1),e.element.addEventListener("click",function(){e.buttonClick(e.element,e.element,event)},!1)):K2BuyButton.createWithModelAndDelegate(e.element,{buyButtonWasActivated:function(t,n,r){e.buttonClick(t,n,r)}})},!1)}document.body.hasClassName("product")&&(this.textDiv=this.element.querySelector(".mid"),this.textDiv.offsetWidth>175&&this.truncateIntialText())},iTSK2BuyButton.prototype.truncateIntialText=function(){this.textDiv.textContent=this.textDiv.innerText.slice(1);
if(this.textDiv.offsetWidth<=167){this.textDiv.innerHTML="&#8230;"+this.textDiv.textContent;
return}this.truncateIntialText()},iTSK2BuyButton.prototype.reInit=function(){this.element.wired=!1,this.init()},iTSK2BuyButton.prototype.setText=function(e){this.element.setAttribute("style","");
var t="<div role='button'><div class='lcap'></div><div class='mid'>"+e+"</div><div class='rcap'></div><div class='price-text'></div></div>";
this.element.innerHTML=t,this.reInit()},iTSK2BuyButton.prototype.buttonClick=function(e,t,n){if(this.preventDoubleClick())return;this.disableOrEnableEbookButton(t,!0);
if(t.hasAttribute("action-params"))iTSDVBuyUtil.buyActionWithBuyButton(this.getAnimationElementId(),t);
else if(t.buyData||t.hasAttribute("buy-data")){if(t.buyData)var r=t.buyData;
else var i=t.getAttribute("buy-data"),r=JSON.parse(i);
iTSDVBuyUtil.buyActionWithJsonBuyData(this.getAnimationElementId(),r,t)}else if(t.hasAttribute("download-url")){var s=!1,o=t.getAttribute("item-type"),u=t.getAttribute("podcast-type");
if(t.getAttribute("podcast-media-type")==="Document")iTunes.openURL(t.getAttribute("download-url")),s=!0;
else if(o=="eBook"||o=="textbook"){var a=!0,f=!0,l=iTunes.protocol&&(iTunes.protocol.clientIdentifier=="WiFi-Music"||iTunes.protocol.clientIdentifier=="iTunesU");
if(l)if(iTunes.device&&iTunes.device.applicationsForUTI){a=!1;
var c=iTunes.device.applicationsForUTI("com.adobe.pdf");
for(var h=0;
h<c.length;
h++)if(c[h].bundleID=="com.apple.iBooks"){a=!0;
break}}else{var p="1"==its.cookies.get("dz.hasiBooks");
p||(confirm(its.loc("Js.BuyButton.iBooksRequiredForEpubConfirm"))?its.cookies.set("dz.hasiBooks","1",1e8):f=!1)}f&&(a?(t.setAttribute("document-target-app","com.apple.iBooks"),iTSK2iTunesClient.downloadAction(this.getAnimationElementId(),t),s=!0):its.client.alert(its.loc("Js.BuyButton.iBooksRequiredForEpub")))}else iTunes.protocol.clientIdentifier=="iTunesU"&&o=="podcast-episode"&&u=="itunes-u"?(iTSK2iTunesClient.downloadAction(this.getAnimationElementId(),t),s=!0):(iTSK2iTunesClient.downloadAction(this.getAnimationElementId(),t),s=!0);
if(s){var d=new ITSEvent(iTSK2BuyButton.Events.PODCAST_EPISODE_DOWNLOADED,this),v=this.eventData();
for(var m in v)d[m]=v[m];
this.itsDispatchEvent(d)}}else if(t.hasAttribute("action-url"))iTSK2iTunesClient.genericUrlAction(this.getAnimationElementId(),t);
else if(t.hasAttribute("course-subscribe-button")){var g=function(e){iTunes.performEnrollAnimation(e)};
this.enrollInCourse(t,g)}else if(t.hasAttribute("collection-subscribe-button")){var g=function(e){iTunes.performEnrollAnimation(e)};
this.enrollInCollection(t,g);
var y=new ITSEvent(iTSK2BuyButton.Events.COLLECTION_SUBSCRIBED,this),v=this.eventData();
for(var m in v)y[m]=v[m];
this.itsDispatchEvent(y)}else if(t.hasAttribute("podcast-subscribe-button")){var b=t.parentByClassName("lockup"),w="BuyButtonAnimatedContainer";
b&&(b.querySelector("div.artwork").id=w),iTSDVBuyUtil.buyActionWithBuyButton(w,t)}else if(t.hasAttribute("href")){var E=t.getAttribute("href");
if(E.charAt(0)=="/"){var S=window.location.protocol,x=window.location.host;
E=S+"//"+x+E}var T=!0;
if(t.hasAttribute("confirm-dialog-message")){var N=t.getAttribute("confirm-dialog-message"),C=t.getAttribute("confirm-dialog-explanation"),k=t.getAttribute("confirm-dialog-action-button"),L=t.getAttribute("confirm-dialog-cancel-button"),A=t.getAttribute("is-ATB");
k==null&&(k=its.loc("OK")),L==null&&(L=its.loc("Cancel"));
var O=its.client.isRunning?iTunes:window;
A!=null?(O.alert(C,N,k),T=!1):T=O.confirm(C,N,k,L)}if(!T)return;if(its.client.isRunning&&!iTunes.viewController)window.location.href=E;
else if(iTunes.viewController)if(t.getAttribute("target")=="_overlay"){var M=iTunes.createWindow();
M.backViewController=its.client.createStorePage(E),M.show({duration:.5,srcElement:this.element,transition:"flip"})}else if(iTunes.window!=null||t.getAttribute("target")=="_self")window.location.href=E;
else{var _=iTunes.viewController.navigationController;
_.pushViewController(its.client.createStorePage(E),!0)}else alert("Load url: "+E),window.location=E}t.hasAttribute("disable-on-click")&&t.setAttribute("button-disabled","true");
if(t.hasAttribute("course-subscribe-material-button")){var D=t.getAttribute("parent-adam-id");
if(!iTSDVOnDevice.hasCourse(D)){var g=function(e){iTunes.performEnrollAnimationFromBuy(e)};
this.enrollInCourse(t,g)}}var P=its.property("cobaltBundleId"),H=iTSDVOnDevice.getAppByBundleId(P);
if(t.hasAttribute("collection-subscribe-material-button")&&its.string.compareNumerically(H.bundleVersion,"322")>0){var B=t.getAttribute("parent-adam-id");
if(!iTSDVOnDevice.hasCourse(B)){var g=function(e){iTunes.performEnrollAnimationFromBuy(e)};
this.enrollInCollection(t,g)}}this.disableOrEnableEbookButton(t,!1),n.stopPropagation(),n.preventDefault()},iTSK2BuyButton.prototype.getAnimationElementId=function(){if(!this.animateOnActionContainer)return;var e=this.animateOnActionContainer.querySelector("*[animate-on-action]");
if(!e)return;var t="animate-on-action",n=document.getElementById(t);
return n&&(n.id=""),e.id=t,t},iTSK2BuyButton.prototype.disableOrEnableEbookButton=function(e,t){var n=e.getAttribute("item-type");
n=="eBook"&&(t?e.setAttribute("button-disabled","true"):e.removeAttribute("button-disabled"))},iTSK2BuyButton.prototype.adamId=function(){return this.element.getAttribute("item-id")},iTSK2BuyButton.prototype.eventData=function(){var e={};
e.adamId=this.adamId();
var t=this.element.getAttribute("item-type");
return t=="podcast-episode"||t=="eBook"?(e.artistId=this.element.getAttribute("artist-id"),e.episodeName=this.element.getAttribute("item-title"),e.podcastName=this.element.getAttribute("collection-name"),e.podcastId=this.element.getAttribute("podcast-id"),e.podcastType=this.element.getAttribute("podcast-type-dzc"),e.episodeKind=this.element.getAttribute("episode-kind")):t=="podcast"&&(e.artistId=this.element.getAttribute("artist-id"),e.podcastName=this.element.getAttribute("collection-name"),e.podcastId=this.element.getAttribute("podcast-id"),e.podcastType=this.element.getAttribute("podcast-type-dzc")),e};
const K2BuyButtonActivationDelegate="buyButtonWasActivated";
K2BuyButton.prototype.closeButtonsEvent=function(t){var n=JSON.parse(t);
n["overlayUrl"]==window.location.href&&this.setSelected(!1);
return},K2BuyButton.createWithModelAndDelegate=function(e,t){this.buttonType=K2BuyButtonTypePrice,this.buttonAlign=K2BuyButtonAlignmentLeft,e.parentByClassName("lockup-container")||e.parentByClassName("track-list")||e.parentByClassName("lockup-list")||e.parentByClassName("salable-select")?this.buttonAlign=K2BuyButtonAlignmentRight:its.client.platformIsK2&&document.body.hasClassName("product")?document.body.hasClassName("book")||(this.buttonAlign=K2BuyButtonAlignmentCenter):its.client.platformIsP2&&document.body.hasClassName("application")?this.buttonAlign=K2BuyButtonAlignmentRight:document.body.hasClassName("manageSubscription")&&(this.buttonAlign=K2BuyButtonAlignmentRight);
var n=new K2BuyButton(this.buttonType,this.buttonAlign,e);
return n.setTitleForState(e.querySelector("div.price-text").itsInnerText(),K2BuyButtonStateNormal),n.setTitleForState(e.getAttribute("confirm-text"),K2BuyButtonStateSelected),n.computeTitleMetrics(),n.handleEvent(event),e.parentByClassName("track-list")||e.parentByClassName("lockup-list")?e.style.width=n.widths[K2BuyButtonStateNormal]+"px":e.style.width=e.getAttribute("confirm-text")?Math.max(n.widths[K2BuyButtonStateNormal],n.widths[K2BuyButtonStateSelected])+"px":"16px",document.body.hasClassName("overlay")&&e.parentByClassName("button-bar")&&(e.style.marginRight="18px"),n.wasActivated=function(){n.enabled||(t[K2BuyButtonActivationDelegate](n,e,event),n.setEnabled(!0),n.setSelected(!1))},n},K2BuyButton.prototype.createLayer=function(){this.layer=this.model.querySelector("div"),this.layer.querySelector("div.price-text").innerHTML=this.layer.querySelector("div.mid").innerHTML,this.layer.querySelector("div.mid").clear(),this.layer.addClassName("k2-buy-button"),this.layer.addClassName(this.type),this.type==K2BuyButtonTypeNonPurchasable?(this.firstLine=this.layer.appendChild(document.createElement("span")),this.secondLine=this.layer.appendChild(document.createElement("span"))):(this.left=this.layer.querySelector("div.lcap"),this.middle=this.layer.querySelector("div.mid"),this.right=this.layer.querySelector("div.rcap"),this.title=this.layer.querySelector("div.price-text")),this.capWidth=this.isFatBinary?10:6,its.client.platformIsK2&&(this.capWidth=11),this.defaultMinWidth=this.priceMinWidth=parseInt(this.middle.getComputedStyleProperty("min-width"))+this.capWidth*2},K2BuyButton.prototype.setSize=function(e){if(this.size.width==e.width)return;e.height=K2BuyButtonHeight,this.size=e,this.layer.style.width=e.width>=this.priceMinWidth?e.width+20+"px":"80px",!this.model.parentByClassName("track-list")&&!this.model.parentByClassName("lockup-list")&&(this.layer.style.height=e.height+20+"px");
if(this.type==K2BuyButtonTypeNonPurchasable)this.updateNonPurchasableTitleDisplay();
else{this.middle.style.minWidth="1px",this.middle.style.width="1px",this.middle.style.padding="0px";
var t=e.width-this.capWidth*2>=this.defaultMinWidth-this.capWidth*2,n=t?e.width-this.capWidth*2:this.defaultMinWidth-this.capWidth*2;
this.middle.style.webkitTransform="scale("+n+", 1)",t?this.right.style.webkitTransform="translateX("+(e.width-this.capWidth)+"px)":this.right.style.webkitTransform="translateX("+(e.width-this.capWidth+(this.defaultMinWidth-this.widths[K2BuyButtonStateNormal]))+"px)";
if(this.firstSizing){this.firstSizing=!1;
var r=this;
setTimeout(function(){r.activateTransitions()},0)}else this.layer.addClassName("in-transition")}},K2BuyButton.prototype.setPosition=function(e){this.position=e,this.layer.style.webkitTransform="translate("+e.x+"px, "+e.y+"px)"},K2BuyButton.prototype.computeTitleMetrics=function(){if(this.readyForDisplay||this.type==K2BuyButtonTypeNonPurchasable)return;this.readyForDisplay=!0;
for(var e=0;
e<this.titles.length;
e++){var t=this.titles[e];
t!==undefined&&(this.widths[e]=this.getWidthForTitle(t))}this.syncTitleToState()},K2BuyButton.prototype.setEnabled=function(e){if(e==this.enabled)return;this.layer[e?"removeClassName":"addClassName"](K2BuyButtonStateDisabledCSS),this.enabled=e},K2BuyButton.prototype.setSelected=function(e){if(this.selected==e)return;this.layer[e?"addClassName":"removeClassName"](K2BuyButtonStateSelectedCSS),this.layer.parentNode[e?"addClassName":"removeClassName"](K2BuyButtonStateSelectedCSS),this.selected=e;
if(!e)try{event.preventDefault(),event.stopPropagation()}catch(t){its.client.log("No event from iTunes.dispatchGlobalEvent: "+t)}document[e?"addEventListener":"removeEventListener"](K2StartEvent,this,!0),this.truncateLockupInfo(),e||this.layer&&this.layer.style&&defer(this,function(){this.layer.style.webkitBoxShadow="none"}),this.hideCMALink(),this.syncTitleToState();
if(defined("iTunes")&&iTunes.addEventListener){var n=new Object;
n.overlayUrl=window.location.href;
var r=JSON.stringify(n),i=e?"buttonOpened":"buttonClosed";
iTunes.dispatchGlobalEvent(i,r)}},K2BuyButton.prototype.getState=function(){return K2BuyButtonStateNormal|(this.highlighted?K2BuyButtonStateHighlighted:0)|(this.enabled?0:K2BuyButtonStateDisabled)|(this.selected?K2BuyButtonStateSelected:0)},K2BuyButton.prototype.handleEvent=function(e){var t=this.layer.parentByClassName("track-list")||this.layer.parentByClassName("lockup-list");
if(e.type==K2StartEvent){if(this.selected){var e=e.touches&&e.touches.length>0?e.touches[0]:e,n=window.webkitConvertPointFromPageToNode(this.layer,new WebKitPoint(e.pageX,e.pageY)),r;
t?r=n.x>=0&&n.x<=this.size.width&&n.y>=0&&n.y-15<=this.size.height:r=n.x>=-30&&n.x<=this.size.width+30&&n.y>=-30&&n.y<=this.size.height+30;
if(!r){this.setSelected(!1);
return}}}else if(e.type=="mouseup")this.firstTouch?(this.firstTouch=!1,defer(this,function(){this.setSelected(!0)})):(document.removeEventListener(K2StartEvent,this,!0),this.selected?(this.setEnabled(!1),this.wasActivated(),this.hideCMALink(1)):this.setSelected(!0));
else if(e.type=="webkitTransitionEnd"){this.layer.removeClassName("in-transition");
if(defined("iTunes")&&iTunes.addEventListener)try{its.client.accessibilityPostLayoutChange()}catch(i){its.client.log(i)}}else e.type=="click"&&(e.preventDefault(),e.stopPropagation())},K2BuyButton.prototype.wasActivated=function(){},K2BuyButton.prototype.titleForState=function(e){return this.titles[e]||""},K2BuyButton.prototype.titleWidthForState=function(e){return this.widths[e]||0},K2BuyButton.prototype.setTitleForState=function(e,t){this.titles[t]=e,this.type==K2BuyButtonTypeNonPurchasable?this.updateNonPurchasableTitleDisplay():this.readyForDisplay&&(this.widths[t]=this.getWidthForTitle(e),t==this.getState()&&this.syncTitleToState())},K2BuyButton.prototype.activateTransitions=function(){this.layer.addClassName("uses-transitions")},K2BuyButton.prototype.getWidthForTitle=function(e){var t=its.kit._controllers.iTSK2BuyButtonController.globalTextWidthDict,n=t[e];
if(n)return n;
this.title.innerText=e;
var r=this.title.offsetWidth;
return this.isFatBinary&&(r+=8),t[e]=r,r},K2BuyButton.prototype.truncateLockupInfo=function(e){try{if(this.adjacentList&&this.alignment==K2BuyButtonAlignmentRight)if(!this.selected&&!this.firstTouch){var t=this;
setTimeout(function(){t.model.style.marginLeft=-e+"px"},250)}else this.selected?this.model.style.marginLeft="0px":this.model.style.marginLeft=-e+"px";
else if(this.layer.parentByClassName("track-list"))this.layer.style.webkitBoxShadow="-20px 5px 10px "+this.layer.parentByTagName("tr").getComputedStyleProperty("background-color");
else if(this.layer.parentByClassName("lockup-list")){var n=this.layer.parentByClassName("price").previousElementSibling;
n&&n.hasClassName("price")?n.style.visibility=this.selected?"hidden":"visible":this.layer.style.webkitBoxShadow="-20px 0px 10px "+this.layer.parentByClassName("lockup").getComputedStyleProperty("background-color")}}catch(r){its.client.log(r)}},K2BuyButton.prototype.hideCMALink=function(e){try{var t=document.querySelector(".cma-view-full-album");
if(t)if(!this.selected&&!this.firstTouch){var n=this;
setTimeout(function(){n.size.width<=n.priceMinWidth&&(e-=n.capWidth),t.style.marginLeft=-e+"px",t.style.display="inline-block"},250)}else this.selected&&(t.style.display="none")}catch(r){its.client.log(r)}},K2BuyButton.prototype.syncTitleToState=function(){var e=this.getState();
this.title.innerText=this.titles[e]||this.titles[K2BuyButtonStateNormal];
var t=this.widths[e]||this.widths[K2BuyButtonStateNormal];
this.type==K2BuyButtonTypePrice&&(t=Math.max(this.priceMinWidth,Math.min(K2BuyButtonTypePriceMaxWidth,t)));
var n=parseInt(this.title.getComputedStyleProperty("max-width"));
n!=="none"&&n<=this.widths[K2BuyButtonStateSelected]?(t=n,this.title.style.marginLeft="0px"):this.title.style.marginLeft="-10px",this.setSize({width:t,height:K2BuyButtonHeight});
var r=this.widths[K2BuyButtonStateSelected]-this.widths[K2BuyButtonStateNormal];
if(this.alignment!==K2BuyButtonAlignmentLeft){this.defaultMinWidth>this.widths[K2BuyButtonStateNormal]&&(r-=this.defaultMinWidth-this.widths[K2BuyButtonStateNormal]),this.defaultMinWidth>this.widths[K2BuyButtonStateSelected]&&(r+=this.defaultMinWidth-this.widths[K2BuyButtonStateSelected]),r==0&&(this.position.x=this.widths[K2BuyButtonStateSelected]-this.widths[K2BuyButtonStateNormal]),this.alignment===K2BuyButtonAlignmentCenter&&(r/=2);
try{document.body.hasClassName("product")&&(this.layer.style.marginLeft=(170-this.widths[K2BuyButtonStateSelected])/2+"px");
if(this.layer.parentByClassName("track-list")||this.layer.parentByClassName("lockup-list"))this.layer.style.marginLeft=-r+"px",this.layer.parentByClassName("track-list")&&(this.layer.parentByClassName("price").style.paddingRight="13px")}catch(i){its.client.log(i)}this.setPosition({x:this.position.x+r*(e===K2BuyButtonStateNormal?1:-1),y:this.position.y}),this.truncateLockupInfo(r)}else this.hideCMALink(r)},K2BuyButton.prototype.updateNonPurchasableTitleDisplay=function(){var e=this.titles[this.getState()]||this.titles[K2BuyButtonStateNormal],t=e.split(" ");
t.length==2?(this.firstLine.innerText=t[0],this.secondLine.innerText=t[1]):this.firstLine.innerText=e},iTSK2BuyButton.prototype.preventDoubleClick=function(){if(this.preventDoubleClickFlag)return!0;
this.preventDoubleClickFlag=!0;
var e=this;
return setTimeout(function(){e.preventDoubleClickFlag=!1},1e3),!1},iTSK2BuyButton.prototype.enrollInCourse=function(e,t){var n=function(t){var n=its.string.xmlUnescape(e.getAttribute("course-subscribe-url")),r=ITSLogger.named("BuyButtonCourseSubscribeLogger");
iTSInclude.makeHttpRequest({url:n,formParams:{},successCallback:t,failureCallback:function(){r.error("Course subscribe button failed",{courseUrl:n},!0)},timeoutCallback:function(){r.error("Course subscribe button timed out",{courseUrl:n},!0)}})},r=function(i){var s=i.getResponseHeader("content-type");
if(s=="application/json")iTunes.authenticateForAccount(iTunes.primaryAccount,{completionCallback:function(e,t){e=="success"&&n(r)}});
else{var o=document.createElement("div"),u=e.getAttribute("course-image-src");
e.appendChild(o);
var a=i.responseText;
a=its.string.trim(a),o.setAttribute("courseUrl",a),o.setAttribute("id","courseUrl"),o.setAttribute("style","display:none");
var f='<img id="courseImage" src="'+u+'"/>';
o.innerHTML=f;
var l=document.getElementById("courseUrl");
t(l)}},i=this.shouldShowiTunesUDialog();
if(i){var s=iTunes.createDialog(),o=its.loc("SFiTunesUSubscribeDialog_message$Mobile"),u=its.loc("SFiTunesUSubscribeDialog_explanation$Mobile"),a=its.loc("OK");
s.title=o,s.body=u;
var f=new Array,l=function(e){n(r)};
f[0]=iTunes.createButton(a,l),s.buttons=f,s.show()}else n(r)},iTSK2BuyButton.prototype.enrollInCollection=function(e,t){var n=this.shouldShowiTunesUDialog();
if(n){var r=iTunes.createDialog(),i=its.loc("SFiTunesUSubscribeDialog_message$Mobile"),s=its.loc("SFiTunesUSubscribeDialog_explanation$Mobile"),o=its.loc("OK");
r.title=i,r.body=s;
var u=new Array,a=function(e){};
u[0]=iTunes.createButton(o,a),r.buttons=u,r.show()}var f=document.createElement("div"),l=e.getAttribute("course-image-src");
e.appendChild(f),f.setAttribute("itunesu-feed-url",e.getAttribute("itunesu-feed-url")),f.setAttribute("feed-name",e.getAttribute("feed-name")),f.setAttribute("provider-name",e.getAttribute("provider-name")),f.setAttribute("category",e.getAttribute("category")),f.setAttribute("store-link",e.getAttribute("store-link")),f.setAttribute("id","feedUrl"),f.setAttribute("style","display:none");
var c='<img id="feedImage" src="'+l+'"/>';
f.innerHTML=c;
var h=document.getElementById("feedUrl");
t(h)},iTSK2BuyButton.prototype.shouldShowiTunesUDialog=function(){var e="iTunesUOneTimeDialogUpsell",t=localStorage.getItem(e),n=its.client.getUserDSID(),r=!0;
if(t&&t!=undefined&&n&&n!=undefined){n=""+n,t=""+t;
var i=t.split(",");
for(var s=0;
s<i.length;
s++){var o=i[s];
if(n==o){r=!1;
break}}r&&(i.push(n),localStorage.setItem(e,i.join(",")))}else if(n&&n!=undefined){n=""+n;
var i=[];
i.push(n),localStorage.setItem(e,i.join(","))}},Element.prototype.hasClassName=function(e){return(new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)")).test(this.className)},Element.prototype.addClassName=function(e){this.hasClassName(e)||(this.className=[this.className,e].join(" "))},Element.prototype.removeClassName=function(e){if(this.hasClassName(e)){var t=this.className;
this.className=t.replace(new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)","g")," ")}},Element.prototype.toggleClassName=function(e){this[this.hasClassName(e)?"removeClassName":"addClassName"](e)};
var PKSupportsTouches="createTouch"in document,PKStartEvent=PKSupportsTouches?"touchstart":"mousedown",PKMoveEvent=PKSupportsTouches?"touchmove":"mousemove",PKEndEvent=PKSupportsTouches?"touchend":"mouseup",PKScrollViewMinimumTrackingForDrag=5,PKScrollViewPagingTransitionDuration="0.25s",PKScrollViewAcceleration=15,PKScrollViewMaxTrackingTime=100,PKScrollViewDecelerationFrictionFactor=.95,PKScrollViewDesiredAnimationFrameRate=1e3/60,PKScrollViewMinimumVelocity=.01,PKScrollViewPenetrationDeceleration=.03,PKScrollViewPenetrationAcceleration=.08,PKScrollViewMinVelocityForDeceleration=1,PKScrollViewMinVelocityForDecelerationWithPaging=4,PKScrollViewMinIndicatorLength=34,PKScrollViewMinimumVelocityToHideScrollIndicators=.05;
PKScrollView.prototype.setContentOffsetWithAnimation=function(e,t){this.contentOffset=e,this.hostingLayer.style.webkitTransform="translate3d("+this.contentOffset.x+"px, "+this.contentOffset.y+"px, 0)",t?(this.scrollTransitionsNeedRemoval=!0,this.hostingLayer.style.webkitTransitionDuration=PKScrollViewPagingTransitionDuration):(this.horizontalScrollEnabled&&this.showsHorizontalScrollIndicator&&this.updateHorizontalScrollIndicator(),this.verticalScrollEnabled&&this.showsVerticalScrollIndicator&&this.updateVerticalScrollIndicator())},PKScrollView.prototype.updateHorizontalScrollIndicator=function(){var e=this.verticalScrollEnabled&&this.showsVerticalScrollIndicator?PKScrollIndicatorEndSize*2:1,t=this.size.width-this.scrollIndicatorInsets.left-this.scrollIndicatorInsets.right,n=Math.max(PKScrollViewMinIndicatorLength,Math.round(this.size.width/this.adjustedContentSize.width*(t-e))),r=-this.contentOffset.x/(this.adjustedContentSize.width-this.size.width)*(t-e-n)+this.scrollIndicatorInsets.left,i=this.size.height-PKScrollIndicatorThickness-1-this.scrollIndicatorInsets.bottom;
this.contentOffset.x>0?(n=Math.round(Math.max(n-this.contentOffset.x,PKScrollIndicatorThickness)),r=1+this.scrollIndicatorInsets.left):this.contentOffset.x<-(this.adjustedContentSize.width-this.size.width)&&(n=Math.round(Math.max(n+this.adjustedContentSize.width-this.size.width+this.contentOffset.x,PKScrollIndicatorThickness)),r=this.size.width-n-e-this.scrollIndicatorInsets.right),this.horizontalScrollIndicator.setPosition(new PKPoint(r,i)),this.horizontalScrollIndicator.setWidth(n)},PKScrollView.prototype.updateVerticalScrollIndicator=function(){var e=this.horizontalScrollEnabled&&this.showsHorizontalScrollIndicator?PKScrollIndicatorEndSize*2:1,t=this.size.height-this.scrollIndicatorInsets.top-this.scrollIndicatorInsets.bottom,n=Math.max(PKScrollViewMinIndicatorLength,Math.round(this.size.height/this.adjustedContentSize.height*(t-e))),r=this.size.width-PKScrollIndicatorThickness-1-this.scrollIndicatorInsets.right,i=-this.contentOffset.y/(this.adjustedContentSize.height-this.size.height)*(t-e-n)+this.scrollIndicatorInsets.top;
this.contentOffset.y>0?(n=Math.round(Math.max(n-this.contentOffset.y,PKScrollIndicatorThickness)),i=1+this.scrollIndicatorInsets.top):this.contentOffset.y<-(this.adjustedContentSize.height-this.size.height)&&(n=Math.round(Math.max(n+this.adjustedContentSize.height-this.size.height+this.contentOffset.y,PKScrollIndicatorThickness)),i=this.size.height-n-e-this.scrollIndicatorInsets.bottom),this.verticalScrollIndicator.setPosition(new PKPoint(r,i)),this.verticalScrollIndicator.setHeight(n)},PKScrollView.prototype.hideScrollIndicators=function(){this.horizontalScrollIndicator.setVisible(!1),this.verticalScrollIndicator.setVisible(!1)},PKScrollView.prototype.snapContentOffsetToBounds=function(e){var t=!1,n=new PKPoint;
this.pagingEnabled?(n.x=Math.round(this.contentOffset.x/this.size.width)*this.size.width,n.y=Math.round(this.contentOffset.y/this.size.height)*this.size.height,t=!0):this.bounces&&(n.x=Math.min(Math.max(this.minPoint.x,this.contentOffset.x),0),n.y=Math.min(Math.max(this.minPoint.y,this.contentOffset.y),0),t=n.x!=this.contentOffset.x||n.y!=this.contentOffset.y),t&&this.setContentOffsetWithAnimation(n,e)},PKScrollView.prototype.adjustContentSize=function(){var e=window.getComputedStyle(this.layer);
this.size=new PKSize(parseInt(e.width),parseInt(e.height)),this.adjustedContentSize=this.contentSize.copy();
if(this.contentSize.width==0||this.contentSize.height==0)this.adjustedContentSize=new PKSize(this.hostingLayer.offsetWidth,this.hostingLayer.offsetHeight);
this.adjustedContentSize.width=Math.max(this.size.width,this.adjustedContentSize.width),this.adjustedContentSize.height=Math.max(this.size.height,this.adjustedContentSize.height),this.maxPoint=new PKPoint(this.adjustedContentSize.width-this.size.width,this.adjustedContentSize.height-this.size.height)},PKScrollView.prototype.handleEvent=function(e){switch(e.type){case PKStartEvent:this.touchesBegan(e);
break;case PKMoveEvent:this.touchesMoved(e);
break;case PKEndEvent:this.touchesEnded(e);
break;case"touchcancel":this.touchesEnded(e);
break;case"webkitTransitionEnd":this.transitionEnded(e)}},PKScrollView.prototype.touchesBegan=function(e){if(this.tracking)return;e.stopPropagation(),this.stopDecelerationAnimation(),this.hostingLayer.style.webkitTransitionDuration=0,this.adjustContentSize(),this.minPoint=new PKPoint(this.size.width-this.adjustedContentSize.width,this.size.height-this.adjustedContentSize.height),this.snapContentOffsetToBounds(!1),this.startPosition=this.contentOffset,this.startTouchPosition=PKPoint.fromEvent(e),this.startTime=e.timeStamp,this.startTimePosition=this.contentOffset.copy(),this.tracking=!0,this.dragging=!1,window.addEventListener(PKMoveEvent,this,!0),window.addEventListener(PKEndEvent,this,!0),window.addEventListener("touchcancel",this,!0),window.addEventListener(PKEndEvent,this,!1)},PKScrollView.prototype.touchesMoved=function(e){e.preventDefault();
var t=PKPoint.fromEvent(e),n=t.x-this.startTouchPosition.x,r=t.y-this.startTouchPosition.y;
!this.dragging&&(Math.abs(n)>=PKScrollViewMinimumTrackingForDrag&&this.horizontalScrollEnabled||Math.abs(r)>=PKScrollViewMinimumTrackingForDrag&&this.verticalScrollEnabled)&&(this.dragging=!0,this.firstDrag=!0,this.horizontalScrollEnabled&&this.showsHorizontalScrollIndicator&&this.adjustedContentSize.width>this.size.width&&this.horizontalScrollIndicator.setVisible(!0),this.verticalScrollEnabled&&this.showsVerticalScrollIndicator&&this.adjustedContentSize.height>this.size.height&&this.verticalScrollIndicator.setVisible(!0));
if(this.dragging){e.stopPropagation();
var i=this.horizontalScrollEnabled?this.startPosition.x+n:this.contentOffset.x,s=this.verticalScrollEnabled?this.startPosition.y+r:this.contentOffset.y;
this.bounces?(i-=(i<this.minPoint.x?i-this.minPoint.x:i>0?i:0)/2,s-=(s<this.minPoint.y?s-this.minPoint.y:s>0?s:0)/2):(i=Math.min(Math.max(this.minPoint.x,i),0),s=Math.min(Math.max(this.minPoint.y,s),0));
if(this.firstDrag){this.firstDrag=!1,this.startTouchPosition=t;
return}this.setContentOffsetWithAnimation(new PKPoint(i,s),!1),this.lastEventTime=e.timeStamp,this.lastEventTime-this.scrollStartTime>PKScrollViewMaxTrackingTime&&(this.startTime=this.lastEventTime,this.startTimePosition=this.contentOffset.copy())}},PKScrollView.prototype.touchesEnded=function(e){window.removeEventListener(PKMoveEvent,this,!0),window.removeEventListener(PKEndEvent,this,!0),window.removeEventListener("touchcancel",this,!0),this.tracking=!1,this.dragging&&(this.dragging=!1,e.stopPropagation(),e.timeStamp-this.lastEventTime<=PKScrollViewMaxTrackingTime&&(this.contentOffsetBeforeDeceleration=this.contentOffset.copy(),this.startDecelerationAnimation()),window.removeEventListener(PKEndEvent,this,!1)),this.decelerating||(this.snapContentOffsetToBounds(!0),this.hideScrollIndicators()),e.eventPhase==Event.BUBBLING_PHASE&&window.removeEventListener(PKEndEvent,this,!1)},PKScrollView.prototype.transitionEnded=function(e){this.scrollTransitionsNeedRemoval&&e.currentTarget===this.hostingLayer&&(this.scrollTransitionsNeedRemoval=!1,this.hostingLayer.style.webkitTransitionDuration=0)},PKScrollView.prototype.startDecelerationAnimation=function(){var e=new PKPoint(this.contentOffset.x-this.startTimePosition.x,this.contentOffset.y-this.startTimePosition.y),t=(event.timeStamp-this.startTime)/PKScrollViewAcceleration;
this.decelerationVelocity=new PKPoint(e.x/t,e.y/t),this.minDecelerationPoint=this.minPoint.copy(),this.maxDecelerationPoint=new PKPoint(0,0),this.pagingEnabled&&(this.minDecelerationPoint.x=Math.max(this.minPoint.x,Math.floor(this.contentOffsetBeforeDeceleration.x/this.size.width)*this.size.width),this.minDecelerationPoint.y=Math.max(this.minPoint.y,Math.floor(this.contentOffsetBeforeDeceleration.y/this.size.height)*this.size.height),this.maxDecelerationPoint.x=Math.min(0,Math.ceil(this.contentOffsetBeforeDeceleration.x/this.size.width)*this.size.width),this.maxDecelerationPoint.y=Math.min(0,Math.ceil(this.contentOffsetBeforeDeceleration.y/this.size.height)*this.size.height)),this.penetrationDeceleration=PKScrollViewPenetrationDeceleration,this.penetrationAcceleration=PKScrollViewPenetrationAcceleration,this.pagingEnabled&&(this.penetrationDeceleration*=5);
var n=this.pagingEnabled?PKScrollViewMinVelocityForDecelerationWithPaging:PKScrollViewMinVelocityForDeceleration;
if(Math.abs(this.decelerationVelocity.x)>n||Math.abs(this.decelerationVelocity.y)>n){this.decelerating=!0;
var r=this;
this.decelerationTimer=window.setTimeout(function(){r.stepThroughDecelerationAnimation()},PKScrollViewDesiredAnimationFrameRate),this.lastFrame=new Date}},PKScrollView.prototype.stopDecelerationAnimation=function(){this.decelerating=!1,clearTimeout(this.decelerationTimer)},PKScrollView.prototype.stepThroughDecelerationAnimation=function(e){if(!this.decelerating)return;var t=new Date,n=t-this.lastFrame,r=e?0:Math.round(n/PKScrollViewDesiredAnimationFrameRate)-1;
for(var i=0;
i<r;
i++)this.stepThroughDecelerationAnimation(!0);
var s=this.contentOffset.x+this.decelerationVelocity.x,o=this.contentOffset.y+this.decelerationVelocity.y;
if(!this.bounces){var u=Math.min(Math.max(this.minPoint.x,s),0);
u!=s&&(s=u,this.decelerationVelocity.x=0);
var a=Math.min(Math.max(this.minPoint.y,o),0);
a!=o&&(o=a,this.decelerationVelocity.y=0)}e?(this.contentOffset.x=s,this.contentOffset.y=o):this.setContentOffsetWithAnimation(new PKPoint(s,o),!1),this.pagingEnabled||(this.decelerationVelocity.x*=PKScrollViewDecelerationFrictionFactor,this.decelerationVelocity.y*=PKScrollViewDecelerationFrictionFactor);
var f=Math.abs(this.decelerationVelocity.x),l=Math.abs(this.decelerationVelocity.y);
if(!e&&f<=PKScrollViewMinimumVelocityToHideScrollIndicators&&l<=PKScrollViewMinimumVelocityToHideScrollIndicators){this.hideScrollIndicators();
if(f<=PKScrollViewMinimumVelocity&&l<=PKScrollViewMinimumVelocity){this.decelerating=!1;
return}}if(!e){var c=this;
this.decelerationTimer=window.setTimeout(function(){c.stepThroughDecelerationAnimation()},PKScrollViewDesiredAnimationFrameRate)}if(this.bounces){var h=new PKPoint(0,0);
s<this.minDecelerationPoint.x?h.x=this.minDecelerationPoint.x-s:s>this.maxDecelerationPoint.x&&(h.x=this.maxDecelerationPoint.x-s),o<this.minDecelerationPoint.y?h.y=this.minDecelerationPoint.y-o:o>this.maxDecelerationPoint.y&&(h.y=this.maxDecelerationPoint.y-o),h.x!=0&&(h.x*this.decelerationVelocity.x<=0?this.decelerationVelocity.x+=h.x*this.penetrationDeceleration:this.decelerationVelocity.x=h.x*this.penetrationAcceleration),h.y!=0&&(h.y*this.decelerationVelocity.y<=0?this.decelerationVelocity.y+=h.y*this.penetrationDeceleration:this.decelerationVelocity.y=h.y*this.penetrationAcceleration)}e||(this.lastFrame=t)},PKScrollView.scanDocumentForElements=function(){var e=document.querySelectorAll(".scrollable-layer, #parent-page");
for(var t=0;
t<e.length;
t++){var n=e[t];
if(n._controller===undefined){var r=window.getComputedStyle(n),i=new PKScrollView(n,n.querySelector(".scrollable-hosting-layer"));
n._view=i}}},window.addEventListener("DOMContentLoaded",PKScrollView.scanDocumentForElements,!1);
var PKScrollIndicatorThickness=7,PKScrollIndicatorEndSize=3,PKScrollIndicatorTypeHorizontal="horizontal",PKScrollIndicatorTypeVertical="vertical";
PKScrollIndicator.prototype.createLayer=function(){this.layer=document.createElement("div"),this.layer.addClassName("scroll-indicator "+this.type),this.layer.addEventListener("webkitTransitionEnd",this,!1),this.start=this.layer.appendChild(document.createElement("div")),this.middle=this.layer.appendChild(document.createElement("img")),this.end=this.layer.appendChild(document.createElement("div"));
var e=this.type===PKScrollIndicatorTypeHorizontal?"Horizontal":"Vertical";
this.middle.src=its.ui.pathForImage("frameworks","mobile/UIScrollerIndicatorDefault"+e+"Middle.png")},PKScrollIndicator.prototype.setPosition=function(e){e.x=Math.round(e.x),e.y=Math.round(e.y),this.layer.style.webkitTransform="translate3d("+e.x+"px, "+e.y+"px, 0)",this.lastPositionUpdateInHide=!1},PKScrollIndicator.prototype.setSize=function(e){this.setWidth(e.width),this.sHeight(e.height),this.size=e},PKScrollIndicator.prototype.setWidth=function(e){this.middle.style.webkitTransform="translate3d(0,0,0) scale("+(e-PKScrollIndicatorEndSize*2)+",1)",this.end.style.webkitTransform="translate3d("+(e-PKScrollIndicatorEndSize)+"px,0,0)",this.width=e},PKScrollIndicator.prototype.setHeight=function(e){this.middle.style.webkitTransform="translate3d(0,0,0) scale(1,"+(e-PKScrollIndicatorEndSize*2)+")",this.end.style.webkitTransform="translate3d(0,"+(e-PKScrollIndicatorEndSize)+"px,0)",this.height=e},PKScrollIndicator.prototype.setVisible=function(e){e?(this.fading=!1,this.layer.style.opacity=1):this.fading||(this.fading=!0,this.layer.style.opacity=0,this.lastPositionUpdateInHide=!0,this.positionBeforeHide=this.position),this.visible=e},PKScrollIndicator.prototype.handleEvent=function(e){if(e.type!="webkitTransitionEnd")return;this.fading&&(this.fading=!1)},PKPoint.fromEvent=function(e){var e=e.touches&&e.touches.length>0?e.touches[0]:e;
return new PKPoint(e.pageX,e.pageY)},PKPoint.prototype.copy=function(){return new PKPoint(this.x,this.y)},PKSize.prototype.copy=function(){return new PKSize(this.width,this.height)},its.kit.createController("iTSCharLimitedField",{binding:"textarea[max-length]"}),iTSCharLimitedField.prototype.init=function(){var e=this.element;
this.updateFeedbackEnabled=!1,this.focused=!1,this.charcount=this.element.value.length>0?this.element.value.length:0,e&&(this.maxlength=parseInt(e.getAttribute("max-length")),e.getAttribute("feedbackid")?this.feedbackWrapper=document.getElementById(e.getAttribute("feedbackid")):this.feedbackWrapper=document.getElementById("message-feedback"),this.maxlength>0&&this.feedbackWrapper&&(this.defaultFeedbackText=this.feedbackWrapper.querySelector(".default-feedback"),this.updateFeedbackText=this.feedbackWrapper.querySelector(".update-feedback"),this.feedback=this.updateFeedbackText.innerHTML,e.addEventListener("keydown",this,!1),e.addEventListener("keypress",this,!1),e.addEventListener("blur",this,!1),e.addEventListener("focus",this,!1),e.value.length>0&&e.value!=e.getAttribute("placeholder")&&this.updateFeedback()))},iTSCharLimitedField.prototype.handleEvent=function(e){if(e.type=="keydown"||e.type=="keypress"){var t=e.keyCode?e.keyCode:e.charCode,n=t==8,r=t==37||t==38||t==39|t==40;
e.type=="keypress"&&!n&&!r&&this.element.value.length+1>this.maxlength?e.preventDefault():n&&this.element.value.length-1>-1?(this.charcount=this.element.value.length-1,this.updateFeedback()):e.type=="keypress"&&!r&&(this.charcount=this.element.value.length+1,this.updateFeedback())}e.type=="focus"&&(this.focused=!0),e.type=="blur"&&(this.focused=!1)},iTSCharLimitedField.prototype.updateFeedback=function(){this.element.value.length>this.maxlength&&(this.element.value=this.element.value.substring(0,this.maxlength)),this.charcount!=this.element.value.length&&this.charcount!=this.element.value.length-1&&this.charcount!=this.element.value.length+1&&(this.charcount=this.element.value.length);
if(this.charcount<=0)this.updateFeedbackText.style.display="none",this.defaultFeedbackText.style.display=this.defaultFeedbackText.nodeName=="SPAN"?"inline":"block",this.updateFeedbackEnabled=!1;
else{var e=this.feedback.replace("@@characterscount@@",this.maxlength-this.charcount);
this.updateFeedbackText.innerHTML=e,this.updateFeedbackEnabled||(this.updateFeedbackEnabled=!0,this.defaultFeedbackText.style.display="none",this.updateFeedbackText.style.display=this.updateFeedbackText.nodeName=="SPAN"?"inline":"block")}this.timer&&(clearTimeout(this.timer),delete this.timer),this.focused&&(this.timer=setTimeout(bind(this,"updateFeedback"),800))},its.kit.onDomReady(function(){if(its.client.isRunning&&iTunes.viewController)try{var t=iTunes.viewController,n=document.body,r=n.getComputedStyleProperty("background-color");
t.showsBackgroundShadow=!1,r=="rgba(0, 0, 0, 0)"&&(n=document.documentElement,r=n.getComputedStyleProperty("background-color"),r=="rgba(0, 0, 0, 0)"&&(its.client.platformIsP2?r="rgb(197,204,212)":its.client.platformIsK2&&(r="rgb(211,214,219)")));
var i=n.getComputedStyleProperty("background-image");
if(i=="none"||i.indexOf("gradient")==-1)t.topBackgroundColor=r;
else if(i.indexOf("gradient")!=-1){var s=i.indexOf("from(rgba")>-1?19:18,o=i.indexOf("from")+5,u=i.substring(o,o+s);
t.topBackgroundColor=u}t.backgroundColor=r,iTunes.viewController.showsLibraryButton&&(iTunes.viewController.showsLibraryButton=!1)}catch(a){console.log(a)}});
var iTunesMobileToolbarHelper={};
iTunesMobileToolbarHelper.buttonFactory=function(e){if(e.systemButtonName){var t;
typeof iTunes[e.systemButtonName]!="undefined"?t=iTunes[e.systemButtonName]:t=iTunes.getStringForSystemButton(e.systemButtonName);
if(t)return iTunes.createSystemButton(t)}else if(e.title){var n=iTunes.createButton();
return typeof n.title=="undefined"?(n.setTitle(e.title),n.setStyle(e.style),n.setEnabled(e.enabled),n.setAction(""+e.action+""),n.setHiddenField(e.hiddenField)):(n.title=e.title,n.style=e.style,n.enabled=e.enabled,n.action=e.action),n}return null},iTunesMobileToolbarHelper.addButtons=function(e){if(!e||!e.length)return;var t=nativeiTunes.viewController,n=t.navigationController,r=t.toolbarItems;
typeof n.toolbarHidden!="function"?n.toolbarHidden=!1:n.setToolbarHidden(!1),r.length||(r=[]);
var i=[];
for(var s=0,o=e.length;
s<o;
s++)r.push(e[s]),i[s]=e[s].toString();
t.setToolbarItems(r,i)},iTunesMobileToolbarHelper.hideToolbar=function(e){var t=nativeiTunes.viewController;
if(t){var n=t.navigationController;
typeof n.toolbarHidden!="function"?n.toolbarHidden=!0:n.setToolbarHidden(!0)}},its.kit.createController("iTSFinanceLink",{binding:"a[target=_blank], a[js-controlled]"}),iTSFinanceLink.prototype.init=function(){this.target=this.element.getAttribute("target"),this.href=this.element.href,this.element.addEventListener("click",this,!1)},iTSFinanceLink.prototype.clickEvent=function(t){if(!its.client.isRunning){window.location.href=this.href,t.preventDefault();
return}switch(this.target){case"_blank":t.stopPropagation(),t.preventDefault(),iTunes.openURL(this.href);
break;default:t.stopPropagation(),t.preventDefault();
if(iTunes.viewController)if(its.client.platformIsK2)if(iTunes.window){iTunes.window.parentViewController.navigationController.pushViewController(iTunes.createStorePage(this.href),!0);
var n=new Object;
n.animate=!0,iTunes.window.dismiss(n)}else{var r=its.url.appendUrlParameter(this.href,"sheet","true"),i=iTunes.createStorePage(r);
i.flashesScrollIndicators=!1;
var s=iTunes.createButton(its.loc("Close"));
i.navigationItem.leftItem=s,s.action=function(){iTunes.viewController.dismissModalViewController("hide-sheet")};
var o=iTunes.createNavigationController(i);
o.showsLibraryButton=!1,o.modalPresentationStyle=o.MODAL_FULL_SCREEN,iTunes.viewController.presentModalViewController(o,"show-sheet")}else{var u=iTunes.viewController.navigationController;
u.pushViewController(its.client.createStorePage(this.href),!0)}else iTunes.gotoURL(this.href)}},its.kit.createController("iTSQuestionPicker",{binding:"div.questions div.more-button",controller:{domReady:function(){if(this._components.length>0){questionsDictionary!=undefined&&questionsDictionary!=null&&(this.data=questionsDictionary),this.formPage=document.forms[0],this.questionElements=document.querySelectorAll("div.questions div.more-button.question"),this.questionTitle=its.loc("JS.MHSecondFactorAuthHarvestPanel.questionField");
if(typeof iTunes!="undefined"&&typeof nativeiTunes.viewController!="undefined"&&typeof nativeiTunes.viewController.navigationController!="undefined"){var e=nativeiTunes.viewController.navigationItem;
this.pageTitle=e.title,this.leftButton=e.leftItem,this.rightButton=e.rightItem,typeof nativeiTunes.viewController.navigationController.toolbarHidden!="undefined"&&(this.hasToolbar=!nativeiTunes.viewController.navigationController.toolbarHidden)}else this.navbar=document.querySelector("div.navigation-bar.pk-toolbar");
if(this.data!==null){this.questionsPerPage=this.data.securityQuestionsPerPage,this.questionPageCount=Math.ceil(this.data.securityQuestions.length/this.questionsPerPage);
if(this.questionPageCount>0){this.questionSets={};
for(var t=0;
t<this.questionPageCount;
t++){var n=this.questionElements[t];
n.setAttribute("role","button"),n.setAttribute("aria-haspopup","true");
var r=this.questionElements[t].querySelector("span.value").id;
this.questionSets[r]={},this.questionSets[r].questions=this.data.securityQuestions.slice(this.questionsPerPage*(t+1)-this.questionsPerPage,this.questionsPerPage*(t+1)),this.questionSets[r].inputId=this.questionElements[t].querySelector("input.question").id}var i=this.questionElements[0].querySelector("span.value").id,s=this.questionElements[0].querySelector("input.question").value;
this.createQuestionPage(i,s)}}}},createQuestionPage:function(e,t){if(this.questionSets!=null){var n=this.questionSets[e].questions;
this.selectQuestionPage=document.querySelector("div#questionSelect");
if(this.selectQuestionPage==null){this.selectQuestionPage=document.createElement("div"),this.selectQuestionPage.addClassName("password-question-picker"),this.selectQuestionPage.addClassName("table-view"),this.selectQuestionPage.addClassName("hidden"),this.selectQuestionPage.id="questionSelect";
var r=document.createElement("h2"),i=document.createTextNode(its.loc("JS.MHEditAccount.SelectQuestionTitle"));
r.appendChild(i),this.picker=document.createElement("div"),this.picker.id=e+"Picker",this.picker.addClassName("boxed"),this.picker.addClassName("inset"),this.picker.addClassName("option-picker"),this.picker.addClassName("question"),this.picker.setAttribute("role","radiogroup"),this.selectQuestionPage.appendChild(r),this.selectQuestionPage.appendChild(this.picker),document.forms[0].insertAdjacentElement("afterEnd",this.selectQuestionPage),this.selectQuestionPage.style.setProperty("visibility","hidden")}else this.picker||(this.picker=this.selectQuestionPage.querySelector("div.option-picker"));
(its&&its.x&&its.x.isAndroid()||navigator.userAgent.indexOf("Android")!=-1)&&this.selectQuestionPage.addClassName("no-transition");
var s=this.picker.querySelectorAll("div.field.option");
this.picker.id=e+"Picker",this.picker.innerHTML="";
var o=document.createElement("div");
o.setAttribute("role","radio"),o.setAttribute("aria-checked","false"),o.addClassName("field"),o.addClassName("option"),o.addClassName("multi-cell");
var u=document.createElement("label");
u.addClassName("option");
var a=document.createElement("span");
for(var f=0;
f<n.length;
f++){var l=o.cloneNode(),c=u.cloneNode(),h=a.cloneNode(),p=n[f]!=null?n[f].id:"",d=n[f]!=null?n[f].question:"";
l.setAttribute("input-value",p),p==t&&(l.addClassName("selected"),l.setAttribute("aria-checked","true")),h.innerText=d,f+1==n.length&&l.addClassName("last"),c.appendChild(h),l.appendChild(c),this.picker.appendChild(l)}this.navbar!=null&&this.htmlnavbar==null&&(this.htmlnavbar=this.navbar.cloneNode(!0),this.htmlnavbar.backbutton=this.htmlnavbar.querySelector("div.pk-bar-button-item.square input"),this.htmlnavbar.backbutton.setAttribute("class","pk-navbar-left"),this.htmlnavbar.backbutton.setAttribute("name","back"),this.htmlnavbar.backbutton.setAttribute("value",localize("Back")),this.htmlnavbar.backbutton.removeAttribute("onclick"),this.htmlnavbar.backbutton.addEventListener("click",bind(this,function(){this._components[0].hideQuestionPage(!1)}),!1),this.htmlnavbar.titleelement=this.htmlnavbar.querySelector("div.pk-control.plain.default"),this.htmlnavbar.titleelement.removeClassName("right-long"),this.htmlnavbar.titleelement.removeClassName("right-short"),this.htmlnavbar.titleelement.addClassName("left-short"),this.htmlnavbar.titleelement.firstElementChild.innerText=this.questionTitle,this.selectQuestionPage.insertAdjacentElement("afterBegin",this.htmlnavbar)),its.kit.rebind()}}},component:{init:function(){this.touchListener=this.listen("iTSMobileTouchManager.event.pressed","selectQuestion"),this.value=this.element.querySelector("span.value[id]"),this.input=this.element.querySelector("input.question"),this.answerFieldId=this.element.getAttribute("answer-id"),this.answerFieldId!=null&&this.answerFieldId!=""&&(this.answerField=this.element.parentNode.querySelector("input#"+this.answerFieldId)),this.id=this.value!==null?this.value.id:"",this.inputId=this.input!==null?this.input.id:"",this.input.value==""?this.value.addClassName("placeholder"):this.value.removeClassName("placeholder")},selectQuestion:function(e){this.controller.createQuestionPage(this.id,this.input.value);
var t=this.controller.formPage.querySelectorAll("input,select,textarea");
for(var n=t.length-1;
n>=0;
n--)t[n].blur();
this.controller.formPage.addClassName("hidden"),this.controller.formPage.setAttribute("aria-hidden","true"),this.controller.formPage.style.setProperty("visibility","hidden");
if(typeof iTunes!="undefined"&&typeof nativeiTunes.viewController!="undefined"&&typeof nativeiTunes.viewController.navigationController!="undefined"){this.controller.pageTitle==null&&(this.controller.pageTitle=nativeiTunes.viewController.navigationItem.title),this.controller.leftButton!=null&&(this.controller.leftButton.title==null||this.controller.leftButton.action==null||!this.controller.leftButton.enabled)&&(this.controller.leftButton=nativeiTunes.viewController.navigationItem.leftItem,typeof this.controller.leftButton.setEnabled!="undefined"?this.controller.leftButton.setEnabled(1):this.controller.leftButton.enabled=1),this.controller.rightButton!=null&&this.controller.rightButton.title==null&&(this.controller.rightButton=nativeiTunes.viewController.navigationItem.rightItem),!this.controller.hasToolbar&&typeof nativeiTunes.viewController.navigationController.toolbarHidden!="undefined"&&(this.controller.hasToolbar=!nativeiTunes.viewController.navigationController.toolbarHidden);
var r=iTunes.createButton(localize("Back"),bind(this,function(){this.hideQuestionPage(!1)}));
r.style="back",typeof nativeiTunes.viewController.navigationItem.setTitle=="function"?nativeiTunes.viewController.navigationItem.setTitle(this.controller.questionTitle):nativeiTunes.viewController.navigationItem.title=this.controller.questionTitle,nativeiTunes.viewController.navigationItem.setLeftItem(r,!0),nativeiTunes.viewController.navigationItem.setRightItem(null,!0),this.controller.hasToolbar&&typeof nativeiTunes.viewController.navigationController.toolbarHidden!="undefined"&&nativeiTunes.viewController.navigationController.setToolbarHidden(!0,!0)}else typeof this.controller.htmlnavbar!="undefined"&&this.controller.htmlnavbar.backbutton.addEventListener("click",bind(this,function(){this.hideQuestionPage(!1)}),!1);
this.controller.selectQuestionPage.removeClassName("hidden"),this.controller.selectQuestionPage.removeAttribute("aria-hidden"),this.controller.selectQuestionPage.style.setProperty("visibility","visible"),window.scrollTo(0,0),this.controller.selectQuestionPage.querySelector("h2").focus(),this.optionSelectedListener=this.listen(document,"iTSOptionpicker.event.optionSelected",this.hideQuestion)},hideQuestion:function(e){e.value!=this.value.innerText&&(this.value.innerText=e.displayString,this.value.removeClassName("placeholder"),this.input.value=e.value,this.hideQuestionPage(!0))},hideQuestionPage:function(e){this.optionSelectedListener.remove(),this.controller.selectQuestionPage.addClassName("hidden"),this.controller.selectQuestionPage.setAttribute("aria-hidden","true"),this.controller.selectQuestionPage.style.setProperty("visibility","hidden"),this.controller.formPage.removeAttribute("aria-hidden"),this.controller.formPage.style.setProperty("visibility","visible"),e&&this.answerField!=null&&this.answerField!=undefined?this.answerField.focus():this.controller.formPage.removeClassName("hidden");
var t=its.client==null||this.answerField!=null&&e!=0&&!its.client.platformIsK2?this.answerField:this.controller.formPage.querySelector("#securityQuestions"),n=this.getPositionOfObjectInPage(t);
typeof n!="undefined"?n=e==0&&!its.client.platformIsK2?n.y+8:n.y-52:n=0,defer(this,function(){window.scrollTo(0,n),this.controller.formPage.removeClassName("hidden"),this.answerField.focus(),this.element.hasClassName("pressed")&&this.element.removeClassName("pressed")},100),defer(this,function(){typeof iTunes!="undefined"&&typeof nativeiTunes.viewController!="undefined"&&typeof nativeiTunes.viewController.navigationController!="undefined"&&(typeof nativeiTunes.viewController.navigationItem.setTitle=="function"?nativeiTunes.viewController.navigationItem.setTitle(this.controller.pageTitle):nativeiTunes.viewController.navigationItem.title=this.controller.pageTitle,nativeiTunes.viewController.navigationItem.setLeftItem(this.controller.leftButton,!0),nativeiTunes.viewController.navigationItem.setRightItem(this.controller.rightButton,!0),this.controller.hasToolbar&&typeof nativeiTunes.viewController.navigationController.toolbarHidden!="undefined"&&nativeiTunes.viewController.navigationController.setToolbarHidden(!1,!0))})},getPositionOfObjectInPage:function(e){var t={x:0,y:0};
if(e!=null){var n=curtop=0;
if(e.offsetParent)do n+=e.offsetLeft,curtop+=e.offsetTop;
while(e=e.offsetParent);
t.x=n,t.y=curtop}return t}}}),its.kit.createController("iTSOptionPicker",{binding:".option-picker",initAfter:"iTSMobileTouchManager",component:{init:function(){this.group=this.element,this.inputId=this.element.getAttribute("input-id"),this.input=this.inputId!==null?document.querySelector("#"+this.inputId):null,this.listen("DOMNodeInserted","optionCountChangedEvent"),this.bindOptions()},pressedEvent:function(e){this.selectOption(e)},optionCountChangedEvent:function(e){e.target.nodeName==="DIV"&&this.bindOptions()},bindOptions:function(){this.options=this.group.querySelectorAll("div.option");
if(this.options.length>0){this.totalOptions=this.options.length;
var e=typeof metricsConfig!="undefined"?metricsConfig:its.sf.Metrics.config;
e&&its.sf.Metrics.setConfig(e);
for(i=this.options.length-1;
i>=0;
i--){var t=this.options[i];
t._picker=this,t.label=t.querySelector("label"),t.labelText=t.label.querySelector("span"),t.inputValue=t.getAttribute("input-value"),t.callback=t.getAttribute("select-callback"),t.selected=t.hasClassName("selected"),t.selected&&this.inputId!=null&&(this.inputId.value==null||this.inputId.value=="")&&this.setValue(t.inputValue),its.sf.Metrics.setTargetInfo(t,t.id,"select_option",its.sf.Metrics.ActionType.SELECT,null,{selectedIndex:i});
if(t.querySelector("span.selected-mark")==null){var n=document.createElement("SPAN");
n.addClassName("selected-mark"),n.setAttribute("role","presentation"),t.appendChild(n)}t.touchmanagerlistener=this.listen(t,"iTSMobileTouchManager.event.pressed","pressedEvent")}}},selectOption:function(e){var t=e instanceof Event?e.target.elementOrAncestorByFunction(function(e){return e.nodeName=="DIV"&&e.hasClassName("option")}):e;
if(!t.hasClassName("selected")){var n=this,r=t.inputValue!=null&&t.inputValue!=""?t.inputValue:t.getAttribute("input-value"),i=t.querySelector("label.option span").innerText,s=t.id;
this.dispatchCustomEvent(t,"iTSOptionpicker.event.optionSelected",{value:r,optionId:s,displayString:i,pressedevent:e});
if(!t.needsConfirmation){this.unselectOption(),t.addClassName("selected"),t.setAttribute("aria-checked","true"),this.input!=null&&n.setValue(r);
if(e.touchevent){var o=its.sf.Metrics.Events.Click.clickDataFromElement(t,null,e.touchevent.pageX,e.touchevent.pageY);
o&&its.sf.Metrics.recordEvent(new its.sf.Metrics.Events.Click(o),null,!0)}t.callback!=null&&n.executeFunctionByName(t.callback,window,t)}}},unselectOption:function(){for(i=this.options.length-1;
i>=0;
i--){var e=this.options[i];
e.hasClassName("selected")&&(e.removeClassName("selected"),e.removeAttribute("aria-checked"),e.removeAttribute("selected"),e.needsConfirmation!=null&&e.needsConfirmation==0&&(e.needsConfirmation=!0))}this.input!=null&&this.setValue("")},setValue:function(e){e!==this.input.value&&(this.input.value=e)},executeFunctionByName:function(e,t){var n=Array.prototype.slice.call(arguments).splice(2),r=e.split("."),i=r.pop();
for(var s=0;
s<r.length;
s++)t=t[r[s]];
return t[i].apply(this,n)}}}),its.kit.createController("iTSManageSubscription",{binding:".manageSubscription",initAfter:"iTSOptionPicker",component:{init:function(){this.picker=this.element.querySelector("div.option-picker.subscriptions");
if(this.picker!=null){this.options=this.picker.querySelectorAll("div.option");
for(i=0;
i<this.options.length;
i++){var e=this.options[i];
e.needsConfirmation=!0,e.subscriptionChangedListener=this.listen(e,"iTSOptionpicker.event.optionSelected","subscriptionChangedEvent"),e.statusElement=e.querySelector("span.status.value"),e.hasClassName("selected")&&e.statusElement!=null?(this.statusDisplayText=e.statusElement.innerText,this.selectedSubscription=e):e._sticky=!0,e.getAttribute("previously-selected")&&(this.previouslySelectedPlan=e),e.getAttribute("show-dialog-now")&&this.showConfirmationDialogOnLoad(e)}this.verifyStudentAction=this.element.querySelector("div.verify-student.external-action"),this.verifyStudentAction&&this.listen(this.verifyStudentAction,"click","handleVerifyStudentAction"),this.buyButtons=this.element.querySelectorAll("div.buy-button div.buy");
if(this.buyButtons)for(i=0;
i<this.buyButtons.length;
i++){var t=this.buyButtons[i];
t.getAttribute("show-dialog-now")&&this.showConfirmationDialogOnLoad(t)}}},handleVerifyStudentAction:function(e){var t=e.target;
if(t){var n=t.getAttribute("href");
iTunes.addEventListener("diddisappear",function(){iTunes.openURL(n)}),its.client.dismissCurrentPage()}},showConfirmationDialogOnLoad:function(e){if(!e)return;var t=e.getAttribute("action-url")||e.getAttribute("href");
if(t.charAt(0)=="/"){var n=window.location.protocol,r=window.location.host;
t=n+"//"+r+t}var i=e.getAttribute("confirm-dialog-message")||its.loc("JS.MZCommerce.PurchaseNewSubscription_message"),s=e.getAttribute("confirm-dialog-explanation"),o=e.getAttribute("confirm-dialog-action-button")||its.loc("JS.MZFinance.ConfirmButton"),u=e.getAttribute("confirm-dialog-cancel-button")||its.loc("JS.MZFinance.CancelButton"),a=e.getAttribute("is-ATB"),f=!1;
s&&(a!=null?alerter.alert(s):f=alerter.confirm(s,i,o,u),f?window.location.href=t:(e.statusElement.innerHTML="",e.statusElement.innerText="",e.removeClassName("selected"),this.previouslySelectedPlan&&(this.selectedSubscription=this.previouslySelectedPlan,this.previouslySelectedPlan.removeAttribute("previously-selected"),this.previouslySelectedPlan.addClassName("selected"),this.previouslySelectedPlan.statusElement.innerText=this.statusDisplayText)))},subscriptionChangedEvent:function(e){var t=e instanceof Event?e.target.elementOrAncestorByFunction(function(e){return e.nodeName=="DIV"&&e.hasClassName("option")}):e;
if(t.statusElement!=null&&t.hasAttribute("action-url")){var n=t.getAttribute("action-url");
if(n.charAt(0)=="/"){var r=window.location.protocol,i=window.location.host;
n=r+"//"+i+n}if(t.needsConfirmation&&t.hasAttribute("confirm-dialog-explanation")){var s=!0,o=its.loc("JS.MZCommerce.PurchaseNewSubscription_message"),u=t.getAttribute("confirm-dialog-explanation"),a=its.loc("JS.MZFinance.ConfirmButton"),f=its.loc("JS.MZFinance.CancelButton"),l=t.getAttribute("is-ATB"),c=its.client.running?iTunes:window;
l!=null?(s=!1,c.alert(u)):s=c.confirm(u,o,a,f);
if(!s){t.hasClassName("pressed")?t.removeClassName("pressed"):(this.tmptgt=t,defer(this,function(){this.tmptgt.hasClassName("pressed")&&this.tmptgt.removeClassName("pressed")},50));
return}t._sticky=!1,t.needsConfirmation=!1,t.hasClassName("pressed")&&t.removeClassName("pressed"),t!==this.selectedSubscription&&(this.selectedSubscription.statusElement.innerHTML="",this.selectedSubscription.statusElement.innerText="",t.statusElement.innerText=this.statusDisplayText,this.selectedSubscription=t),its.client.isRunning&&(!iTunes.viewController||iTunes.window!=null)?window.location.href=n:window.location.href=n}}else if(t){var h=t.querySelector("div.verify-student");
if(h){var n=h.getAttribute("href");
its.client.dismissCurrentPage(),iTunes.addEventListener("diddisappear",function(){iTunes.openURL(n)}),t.hasClassName("pressed")&&t.removeClassName("pressed"),t._sticky=!1}}}}}),its.kit.createController("iTSFinancePayEaseAddMoneySend",{binding:"body#MHPayEaseAddMoneySend"}),iTSFinancePayEaseAddMoneySend.AttemptStatus={Ok:1,PrepaidStoreCreditInquiring:13,BadPaymentStatus:7,PrepaidStoreCreditError:12},iTSFinancePayEaseAddMoneySend.prototype.init=function(){this.addMoneyLink=this.element.querySelector("#addMoneyLink"),this.addMoneyLink&&(this.isAddMoneyRequestSubmitted=!1,this.addMoneyLink.addEventListener("click",bind(this,this.addMoneyClickHandler))),attemptCheckerData&&this.scheduleCheckAttemptStatus()},iTSFinancePayEaseAddMoneySend.prototype.checkAttemptStatus=function(){iTSInclude.makeHttpRequest({method:"get",url:attemptCheckerData.url,timeout:attemptCheckerData.timeout,successCallback:bind(this,this.checkAttemptStatusSuccessHandler),failureCallback:bind(this,this.checkAttemptStatusFailureHandler)})},iTSFinancePayEaseAddMoneySend.prototype.checkAttemptStatusSuccessHandler=function(e){if(e&&iTSInclude.isJsonResponse(e))try{var t=its.string.evalJson(e.responseText);
if(t&&t.status){var n=its.string.toInt(t.status);
switch(n){case iTSFinancePayEaseAddMoneySend.AttemptStatus.Ok:case iTSFinancePayEaseAddMoneySend.AttemptStatus.PrepaidStoreCreditInquiring:this.updatePageInstruction(n);
break;case iTSFinancePayEaseAddMoneySend.AttemptStatus.BadPaymentStatus:case iTSFinancePayEaseAddMoneySend.AttemptStatus.PrepaidStoreCreditError:this.updatePageInstruction(n);
break;default:this.scheduleCheckAttemptStatus()}return}}catch(r){console.log(r)}return this.checkAttemptStatusFailureHandler(e)},iTSFinancePayEaseAddMoneySend.prototype.updatePageInstruction=function(e){var t=document.querySelector("#page-instruction"),n=document.querySelector("#page-sub-instruction");
switch(e){case iTSFinancePayEaseAddMoneySend.AttemptStatus.Ok:case iTSFinancePayEaseAddMoneySend.AttemptStatus.PrepaidStoreCreditInquiring:t.innerText=its.loc("MHPayEaseAddMoneySend.PageInstruction"),n.innerText=its.loc("MHPayEaseAddMoneySend.SubPageInstruction_MobilePhone");
break;case iTSFinancePayEaseAddMoneySend.AttemptStatus.BadPaymentStatus:case iTSFinancePayEaseAddMoneySend.AttemptStatus.PrepaidStoreCreditError:t.innerText=its.loc("MHPayEaseAddMoneySend.PageInstruction_MobilePhone.BadPayment"),n.innerText=its.loc("MHPayEaseAddMoneySend.SubPageInstruction_MobilePhone.BadPayment")}},iTSFinancePayEaseAddMoneySend.prototype.scheduleCheckAttemptStatus=function(){attemptCheckerData.counter++,attemptCheckerData.timerId=setTimeout(bind(this,this.checkAttemptStatus),attemptCheckerData.retry)},iTSFinancePayEaseAddMoneySend.prototype.checkAttemptStatusFailureHandler=function(e){this.isSessionTimeoutResponse(e)?its.client.alert(localize("Js.SessionTimeoutErrorMessage")):its.client.alert(localize("Js.GenericErrorMessage")),its.client.dismissCurrentPage()},iTSFinancePayEaseAddMoneySend.prototype.addMoneyClickHandler=function(e){e.preventDefault(),this.isAddMoneyRequestSubmitted||(this.isAddMoneyRequestSubmitted=!0,iTSInclude.makeHttpRequest({method:"get",url:this.addMoneyLink.href,timeout:6e4,successCallback:bind(this,this.addMoneySuccessHandler),failureCallback:bind(this,this.addMoneyFailureHandler)}))},iTSFinancePayEaseAddMoneySend.prototype.addMoneySuccessHandler=function(e){if(e&&iTSInclude.isJsonResponse(e))try{var t=its.string.evalJson(e.responseText).url;
if(t&&t.length){iTunes.openURL(t),its.client.dismissCurrentPage();
return}}catch(n){console.log(n)}this.addMoneyFailureHandler(e)},iTSFinancePayEaseAddMoneySend.prototype.isSessionTimeoutResponse=function(e){return!1},iTSFinancePayEaseAddMoneySend.prototype.addMoneyFailureHandler=function(e){this.isSessionTimeoutResponse(e)?its.client.alert(localize("Js.SessionTimeoutErrorMessage")):its.client.alert(localize("Js.GenericErrorMessage")),its.client.dismissCurrentPage()},its.kit.createController("iTSFinanceBuyStoreCredit",{binding:"body#MHPayEasePaymentMobileDna"}),iTSFinanceBuyStoreCredit.prototype.init=function(){this.data=payEaseMobileDnaData!=null?payEaseMobileDnaData:null,this.provinceSelector=this.element.querySelector("select#BranchProvince"),this.provinceSelector._buycreditcontroller=this,this.defaultCitySelector=this.element.querySelector("select#BranchCity"),this.citySelectorDefaultId="BranchCity",this.currentCitySelector=this.defaultCitySelector,this.backButtonPressed=!1;
if(this.provinceSelector!=null&&this.currentCitySelector!=null){this.noSelectionOption=this.provinceSelector.options[0],this.citiesByProvince=this.data!=null?this.data.citiesByProvince:{},this.citiesByProvince[this.noSelectionOption.value]=[""],this.cityKeysByProvince=this.data!=null?this.data.cityKeysByProvince:{};
var e=document.createTextNode(its.loc("MHPayEasePaymentMobileDna.NoSelectionLabel.City"));
this.cityNoSelectionOption=document.createElement("option"),this.cityNoSelectionOption.setAttribute("value",this.noSelectionOption.value),this.cityNoSelectionOption.appendChild(e),this.provinceSelector.addEventListener("focus",bind(this,function(e){this.provinceSelector._polltimer=setInterval(bind(this,function(e){bind(this,this.provinceSelectorChangeHandler(e))},100))}),!1),this.provinceSelector.addEventListener("blur",bind(this,function(e){var t=this.provinceSelector.options[this.provinceSelector.selectedIndex],n=t.getAttribute("value");
clearInterval(this.provinceSelector._polltimer),delete this.provinceSelector._polltimer,this.provinceSelectorChangeHandler(e)}),!1)}this.idNumberInput=this.element.querySelector("input#IdNumber"),this.idAddressInput=this.element.querySelector("input#IdAddress"),this.idTypeSelector=this.element.querySelector("#IdType");
if(this.idTypeSelector!=null){this.idTypeSelector.input=this.idTypeSelector.querySelector("input#"+this.idTypeSelector.getAttribute("input-id")),this.idTypeOptions=this.idTypeSelector.querySelectorAll("div.option"),this.idTypeData=this.data!=null?this.data.idsByIdType:{};
for(var t=this.idTypeOptions.length-1;
t>=0;
t--){var n=this.idTypeOptions[t];
n.addEventListener("click",bind(this,this.idTypeChangeHandler),!1);
var r=this.data!=null&&this.data.idsByIdType!=null?this.data.idsByIdType[n.id.replace(/(ID)/,"")]:null;
r!=null&&(n.idData=r,n.defaultIDNumber=r.number,n.defaultAddress=r.address,n.addressPlaceholder=r.addressPlaceholder,n.requiresIdAddress=r.requiresIdAddress,n.groupWrapper=this.idTypeSelector)}}this.validationData=validators!=null?validators:null,this.validationFields=this.element.querySelectorAll("input, select"),this.element.querySelector("input#hiddenSecondButtonId").addEventListener("click",bind(this,this.backButtonClickEvent),!1),this.element.querySelector("form").addEventListener("submit",bind(this,this.submit),!1)},iTSFinanceBuyStoreCredit.BRANCH_CITY_OPTION_TAG_TEMPLATE='<option value="@@CITY_VALUE@@">@@CITY_NAME@@</option>',iTSFinanceBuyStoreCredit.prototype.provinceSelectorChangeHandler=function(e){var t=this.provinceSelector.options[this.provinceSelector.selectedIndex],n=t.getAttribute("value"),r=this.citySelectorDefaultId+this.newIdFromString(n);
if(this.currentCitySelector.id!==r){var i=this.citiesByProvince[n],s=this.cityKeysByProvince[n]||[];
if(i&&i.length){var o=[];
for(var u=0,a=i.length;
u<a;
u++){var f=iTSFinanceBuyStoreCredit.BRANCH_CITY_OPTION_TAG_TEMPLATE,l=i[u],c=null;
n=="WONoSelectionString"?c=n:c=s[u]!=null?s[u]:l,l!=null&&l!=""&&o.push('<option value="'+c+'">'+l+"</option>")}this.currentCitySelector.innerHTML=o.join(""),this.currentCitySelector.id=r;
var h=this.currentCitySelector.elementOrAncestorByFunction(function(e){return e.nodeName=="DIV"&&e.hasClassName("field")});
n!=this.noSelectionOption.value?(h.removeClassName("disabled"),this.currentCitySelector.insertBefore(this.cityNoSelectionOption,this.currentCitySelector.firstChild)):h.addClassName("disabled"),!this.currentCitySelector.hasClassName("noselection")&&this.currentCitySelector.selectedIndex==0&&this.currentCitySelector.addClassName("noselection")}}},iTSFinanceBuyStoreCredit.prototype.citySelectorChangeHandler=function(e){e.target.options[e.target.selectedIndex].value===this.noSelectionOption.value?e.target.addClassName("noselection"):e.target.removeClassName("noselection")},iTSFinanceBuyStoreCredit.prototype.newIdFromString=function(t){return t.replace(/\s/,"")},iTSFinanceBuyStoreCredit.prototype.idTypeDropdownChangeHanlder=function(e){var t=this.idTypeSelector.options[this.idTypeSelector.selectedIndex],n=t.getAttribute("value"),r=this.idNumbersByIdType[n];
r?this.idNumberInput.value=r:this.idNumberInput.value="";
if(this.idAddressInput){var i=this.idAddressesByIdType[n];
i?this.idAddressInput.value=i:this.idAddressInput.value=""}},iTSFinanceBuyStoreCredit.prototype.idTypeChangeHandler=function(t){var n=t.target.elementOrAncestorByFunction(function(e){return e.nodeName=="DIV"&&e.hasClassName("option")}),r=n.idData,i=r.number,s=r.numberPlaceholder,o=r.address,u=r.addressPlaceholder;
this.idNumberInput!=null&&(this.idNumberInput.value=i!=null?i:"",s!=null&&this.idNumberInput.getAttribute("placeholder")!=s&&this.idNumberInput.setAttribute("placeholder",s)),this.idAddressInput!=null&&(this.idAddressInput.value=o!=null?o:"",u!=null&&this.idAddressInput.getAttribute("placeholder")!=u&&this.idAddressInput.setAttribute("placeholder",u))},iTSFinanceBuyStoreCredit.prototype.backButtonClickEvent=function(e){this.backButtonPressed=!0},iTSFinanceBuyStoreCredit.prototype.submit=function(e){if(!this.backButtonPressed){this.dnaValidate(e.target);
var t=this.element.querySelector("form");
this.errorElement=t.querySelector("p.error");
if(!this.isValid){e.preventDefault();
if(this.errorMsg!=""){var n=this.errorMsg;
this.errorElement==null?(this.errorElement=document.createElement("p"),this.errorElement.addClassName("error"),this.errorElement.appendChild(document.createTextNode(n)),t.querySelector("p.instruction, h2, div.boxed").insertAdjacentElement("beforeBegin",this.errorElement)):this.errorElement.innerText=n}}else this.errorElement!=null&&t.removeChild(this.errorElement)}},iTSFinanceBuyStoreCredit.prototype.dnaValidate=function(e){if(this.validationData==null){this.isValid=!0;
return}e.validated&&(e.validated=!1),this.errorTitle=its.loc("invalidFieldsTitle"),this.errorMsg="";
var t=!0;
this.isValid=!0,this.errorCount=0;
for(var n=0,r=this.validationFields.length-1;
n<r;
n++){t=!0;
var i=this.validationFields[n],s=i.id.indexOf("Field")>0?i.id.substring(0,i.id.indexOf("Field")):i.id;
if(this.validationData[s]!=null){var o=this.validationData[s],u=o.minLength,a=o.isRequired?!0:!1,f=o["pattern"]!=null?new RegExp(o.pattern):null;
i.value.length>0&&f!=null?(t=f.test(i.value),t||(this.errorMsg=its.loc(i.id))):i.value.length<u&&(t=!1);
var l=i.elementOrAncestorByFunction(function(e){return e.nodeName=="DIV"&&e.hasClassName("field")||e.nodeName=="LABEL"});
i.value.length>u&&i.value!=""&&i.value!="WONoSelectionString"&&l.removeClassName("error"),t?(l.removeClassName("validate"),l.addClassName("validated")):(this.isValid=!1,l.hasClassName("error")||l.addClassName("error"),this.errorCount++)}}this.errorCount>1&&(this.errorTitle=its.loc("invalidFieldsTitle"),this.errorMsg=its.loc("invalidFieldsDesc")),e.validated=this.isValid},its.kit.createController("iTSAccountSummaryBankCard",{binding:"#view-prepaid-orders-button"}),iTSAccountSummaryBankCard.prototype.init=function(){typeof this.element!="undefined"&&this.element.addEventListener("click",bind(this,this.viewPrepaidOrdersClickHanlder),!1)},iTSAccountSummaryBankCard.prototype.viewPrepaidOrdersClickHanlder=function(e){e.preventDefault();
var t=this.element.getAttribute("href");
if(typeof iTunes!="undefined")if(iTunes.viewController!=null){var n=iTunes.viewController.navigationController;
n.pushViewController(its.client.createStorePage(t),!0)}else iTunes.gotoURL(t)},its.kit.createController("iTSEditBillingInfoBankCard",{binding:"body#MXEditAddressWizard"}),iTSEditBillingInfoBankCard.prototype.init=function(){if(!this.hasStoreCreditBalance()){var e=this.element.querySelector("#paymentType");
if(e){var t=e.querySelector("div.option.selected");
if(t&&t.inputValue!="PEAS"){var n=bind(this,this.paymentTypeClickHandler);
e.querySelectorAll("div.option").each(function(e){e.addEventListener("click",n,!0)})}}}},iTSEditBillingInfoBankCard.prototype.paymentTypeClickHandler=function(e){var t=e.currentTarget.inputValue;
t=="PEAS"?this.changeRightButtonName(localize("Next")):this.changeRightButtonName(localize("Done"))},iTSEditBillingInfoBankCard.prototype.changeRightButtonName=function(e){if(typeof iTunes!="undefined"&&iTunes.viewController){var t=iTunes.viewController.navigationItem;
t&&t.rightItem&&(t.rightItem.title=e)}},iTSEditBillingInfoBankCard.prototype.hasStoreCreditBalance=function(){if(typeof pageData!="undefined"&&pageData.storeCreditBalance!=null){var e=parseFloat(pageData.storeCreditBalance);
if(!isNaN(e))return e>0}return!1};
var formatProperties={usa:{pattern:"^([0-9]{3})-*([0-9]{1,4}).*",format:"$1-$2"}};
its.kit.createController("iTSPhoneFormatter",{binding:"body.usa div.field.phone",component:{init:function(){this.areacodefield=this.element.querySelector("input.area-code"),this.phonefield=this.element.querySelector("input.phone"),this.pattern="^[0-9]{3}[0-9]{1,4}",this.nationalpattern="^[0-9]{3}[0-9]{3}-[0-9]{1,}$",this.phonefield.addEventListener("keydown",this,!1),this.phonefield.addEventListener("keypress",this,!1),this.phonefield.addEventListener("keyup",this,!1),this.phonefield.addEventListener("input",this,!1)},keypressEvent:function(e){var t=e.keyCode?e.keyCode:e.charCode,n=e.target,r=n.value,i=r.indexOf("-"),s={start:n.selectionStart,end:n.selectionEnd};
i==-1&&r.length==3&&(n.value+="-",n.selectionStart=s.start+1,n.selectionEnd=s.end+1)},keydownEvent:function(e){var t=e.keyCode?e.keyCode:e.charCode,n=e.target,r=n.value,i=r.indexOf("-"),s={start:n.selectionStart,end:n.selectionEnd};
if(t===8&&i>-1&&r.length==5){var o=this._formattedValue(r.substr(0,4),formatProperties.usa.pattern,formatProperties.usa.format);
n.value=o,n.selectionStart=s.start-1,n.selectionEnd=s.end-1}},keyupEvent:function(e){var t=e.keyCode?e.keyCode:e.charCode,n=e.target,r={start:n.selectionStart,end:n.selectionEnd}},blurEvent:function(e){},changeEvent:function(e){},inputEvent:function(e){var t=e.target,n=t.value,r=n.indexOf("-");
if(n.length>3){var i={start:t.selectionStart,end:t.selectionEnd},s=this._formattedValue(n.split("-").join(""),formatProperties.usa.pattern,formatProperties.usa.format);
console.log(s),t.value=s}},_formattedValue:function(e,t,n){var r=new RegExp(t),i=e.replace(r,n);
return i}}}),its.kit.createController("DTMarketingOffers",{binding:"body.accountManagement div.MHEditAccount.signup",component:{init:function(){this.updatedMarketing=!1,this.month=this.element.querySelector("select#birthMonthPopup"),this.day=this.element.querySelector("select#birthDayPopup"),this.year=this.element.querySelector("input#birthYear"),this.month!==null&&this.day!==null&&this.year!==null&&(this.listen(this.month,"change","changeEvent"),this.listen(this.day,"change","changeEvent"),this.listen(this.year,"input","inputEvent"))},changeEvent:function(e){this.checkBirthday(e.target)},inputEvent:function(e){this.checkBirthday(e.target)},checkBirthday:function(e){var t=this.month.options[this.month.selectedIndex].value,n=this.day.options[this.day.selectedIndex].value,r=this.year.value;
if(this.updatedMarketing===!1&&t!=="WONoSelectionString"&&n!=="WONoSelectionString"&&r!==null&&r!==""){t=parseInt(t),n=parseInt(n)+1,r=parseInt(r)+18;
if(!isNaN(r)&&r.toString().length===4){var i=new Date(its.currentTime()),s=new Date(r,t,n);
if(!isNaN(s)&&s>i){var o=this.element.querySelector("div#subscribeAppleNewsCheckbox.ad-switch");
if(o!==null){var u=o._view;
u!==null&&u.setOnAnimated(!1,!1)}var a=this.element.querySelector("div#subscribeAppleMarketingCheckbox.ad-switch");
if(a!==null){var f=a._view;
f!==null&&f.setOnAnimated(!1,!1)}this.updatedMarketing=!0}}}}}}),its.kit.createController("iTSDeviceSignupBillingForm",{binding:"body#MHSignupAddressWizard.accountManagement form",controller:{submitEvent:function(){this.applyToComponents("submitEvent")}},component:{init:function(){this.firstName=this.element.querySelector("#firstNameField"),this.lastName=this.element.querySelector("#lastNameField"),this.longName=this.element.querySelector("#longName")},submitEvent:function(e){this.firstName&&this.lastName&&this.longName&&(this.firstName.hasClassName("required")?this.longName.value=this.lastName.value.substr(0,1).toUpperCase()+this.lastName.value.substr(1).toLowerCase()+","+this.firstName.value.substr(0,1).toUpperCase()+this.firstName.value.substr(1).toLowerCase():this.longName.value=firstName+lastName)}}}),its.kit.createController("iTSPersonalRecommendationsSwitch",{binding:"#personalRecommendationsToggle",component:{init:function(){this.listen(this.element,"click","toggleClicked"),this.serviceUrl=this.element.getAttribute("personalRecommendationsUrl")},toggleClicked:function(e){typeof this.serviceUrl!="undefined"&&(e.preventDefault(),this.element.hasClassName("checked")?iTSInclude.makeHttpRequest({url:this.serviceUrl+"?flag=false",timeout:6e4,successCallback:bind(this,this.turnOffPersonalRecommendationsSuccessHandler),failureCallback:bind(this,this.recommendationsFailureHandler)}):iTSInclude.makeHttpRequest({url:this.serviceUrl+"?flag=true",timeout:6e4,successCallback:bind(this,this.turnOnPersonalRecommendationsSuccessHandler),failureCallback:bind(this,this.recommendationsFailureHandler)}),this.element.style.opacity=.5)},turnOffPersonalRecommendationsSuccessHandler:function(e){var t=JSON.parse(e.responseText);
this.element.style.opacity=1,t.status==0?this.element.removeClassName("checked"):this.showError()},turnOnPersonalRecommendationsSuccessHandler:function(e){this.element.style.opacity=1;
var t=JSON.parse(e.responseText);
t.status==0?this.element.addClassName("checked"):this.showError()},recommendationsFailureHandler:function(e){this.element.style.opacity=1,this.showError()},showError:function(){its.client.alert(its.loc("JS.ExceptionThrown.Mobile_message"))}}}),its.kit.createController("iTSCaptcha",{binding:"div.captcha-container",component:{init:function(){try{if(typeof nucaptcha!="undefined"&&nucaptcha!=null&&typeof nucaptcha.getInterface!="undefined"){this.nci=nucaptcha.getInterface(1);
if(this.nci){this.addCaptchaListeners();
if(this.nci.getPlayerMode()==="PLAYERMODE_NOCAPTCHA"){this.element.addClassName("none");
return}this.hiddenCaptchaPlayerMode=this.element.querySelector("input#hidden-captcha-player-mode"),this.nci.addListener(this),this.isCaptchaInAudioMode()?(this.playAudioOnSetup=!1,this.nci.cmdSetPlayerMode(this.nci.PLAYERMODE_AUDIO)):this.setup()}}}catch(e){console.log("Error: "+e)}},setup:function(){this.refreshButton=this.element.querySelector("button#new-challenge"),this.textCaptchaButton=this.element.querySelector("button#player-mode-video"),this.audioCaptchaButton=this.element.querySelector("button#player-mode-audio"),this.instructionElement=this.element.querySelector("p.captcha-instruction"),this.captchaInput=this.element.querySelector("#"+this.nci.ID_NUCAPTCHA_ANSWER),this.mediaContainer=this.element.querySelector("#"+this.nci.ID_NUCAPTCHA_MEDIACONTAINER),this.audioCaptcha=this.element.querySelector("audio#nucaptcha-media"),this.captchaInput&&(this.listen(this.captchaInput,"keypress","keypressEvent"),its.client.platformIsP2&&this.listen(this.captchaInput,"focus","focusCaptchaInputEvent"),this.captchaInput.setAttribute("placeholder",its.loc("JS.MZFinance.Required")));
if(!this.textCaptchaButton||!this.audioCaptchaButton)return;this.refreshButton&&this.listen(this.refreshButton,"click","getNewCaptcha"),this.textCaptchaButton&&this.listen(this.textCaptchaButton,"click","togglePlayerModeText"),this.audioCaptchaButton&&this.listen(this.audioCaptchaButton,"click","togglePlayerModeAudio"),this.audioCaptcha&&this.listen(this.audioCaptcha,"ended","audioFinished");
var e=this.element.querySelector("div.pill");
e&&e.setAttribute("role","radio-group"),this.textCaptchaButton.setAttribute("role","radio"),this.audioCaptchaButton.setAttribute("role","radio");
if(!this.isCaptchaInAudioMode()){this.textCaptchaButton.hasClassName("active")||(this.textCaptchaButton.addClassName("active"),this.audioCaptchaButton.removeClassName("active"),this.textCaptchaButton.setAttribute("aria-checked","true"),this.audioCaptchaButton.setAttribute("aria-checked","false")),this.element.removeClassName("audio");
if(this.instructionElement){var t=its.loc("JS.MZFinance.EditAccount.CaptchaTitle.Text");
this.instructionElement.innerHTML=t,this.captchaInput.setAttribute("title",t);
var n=this.mediaContainer.firstElementChild;
n&&(n.setAttribute("alt",t),n.removeAttribute("title"))}}else if(this.isCaptchaInAudioMode()){this.audioCaptchaButton.hasClassName("active")||(this.audioCaptchaButton.addClassName("active"),this.textCaptchaButton.removeClassName("active"),this.textCaptchaButton.setAttribute("aria-checked","false"),this.audioCaptchaButton.setAttribute("aria-checked","true")),this.element.hasClassName("audio")||this.element.addClassName("audio");
if(this.instructionElement){var t=its.loc("JS.MZFinance.EditAccount.CaptchaTitle.Audio");
this.instructionElement.innerHTML=t,this.captchaInput.setAttribute("title",t),this.audioCaptcha&&(this.audioCaptcha.parentNode.setAttribute("aria-label",t),this.audioCaptcha.parentNode.setAttribute("tabindex","0"),this.audioCaptcha.setAttribute("aria-label",t),this.audioCaptcha.setAttribute("tabindex","0"))}this.captchaAudioInFinalRender()&&(this.playAudioOnSetup===!0?(this.element.hasClassName("audio-finished")&&this.element.removeClassName("audio-finished"),this.nci.cmdReplay()):this.setCaptchaAudioToReplayMode())}this.captchaInFinalRender()&&(this.playAudioOnSetup=!0)},addCaptchaListeners:function(){var e=document.forms[0].elements;
for(i=0,x=e.length;
i<x;
i++)e[i].type!="hidden"&&e[i].type!="submit"&&(this.listen(e[i],"focus","onPageInputFocus"),this.listen(e[i],"blur","onPageInputBlur"));
this.listen(document,"keypress","onPageKeyPress"),this.listen(document,"click","onPageMouseClick"),this.listen(document,"touchstart","onPageTouchEvent")},captchaAudioInFinalRender:function(){return this.nci.getPlayerMode()==this.nci.PLAYERMODE_AUDIO&&this.nci.getReadyState()},captchaVideoInFinalRender:function(){return this.nci.getPlayerMode()==this.nci.PLAYERMODE_VIDEO&&this.nci.getReadyState()},captchaInFinalRender:function(){return this.captchaAudioInFinalRender()||this.captchaVideoInFinalRender()},isCaptchaInAudioMode:function(){return this.hiddenCaptchaPlayerMode&&this.hiddenCaptchaPlayerMode.value==="AUDIO"?!0:!1},setPlayerMode:function(e){this.hiddenCaptchaPlayerMode.value=e},setCaptchaAudioToReplayMode:function(){if(!this.element.hasClassName("audio-finished")){this.element.addClassName("audio-finished"),this.replayButton=this.element.querySelector("button.replay-button"),this.replayButton&&this.listen(this.replayButton,"click","replayChallenge"),typeof this.audioCaptcha!="undefined"&&this.audioCaptcha!=null&&this.audioCaptcha.setAttribute("aria-label",its.loc("JS.MZFinance.Captcha.ReplayAudioCaptcha"));
if(defined("iTunes")&&iTunes.addEventListener)try{its.client.accessibilityPostLayoutChange()}catch(e){its.client.log(e)}}},setCaptchaAudioToPlayingMode:function(){this.mediaContainer&&(this.element.removeClassName("audio-finished"),this.replayButton.removeEventListener("click"),this.mediaContainer.setAttribute("aria-label",its.loc("JS.MZFinance.EditAccount.CaptchaTitle.Audio")),typeof this.audioCaptcha!="undefined"&&this.audioCaptcha!=null&&this.audioCaptcha.setAttribute("aria-label",its.loc("JS.MZFinance.EditAccount.CaptchaTitle.Audio")))},onNuCaptchaEvent:function(e,t){try{e===this.nci.EVENT_REFRESH_HTML?(this.setup(),its.client.screenReaderRunning()&&this.captchaInput.focus()):e===this.nci.EVENT_MEDIA_DOWNLOAD_WAIT?this.updateStatusMessage(its.loc("JS.MZFinance.Captcha.Loading")):e===this.nci.EVENT_MEDIA_DOWNLOAD_WAIT_TIMEOUT&&this.updateStatusMessage(its.loc("JS.MZFinance.Captcha.ServerTimeout"))}catch(n){console.log("Error: "+n)}},audioFinished:function(e){this.setCaptchaAudioToReplayMode()},replayChallenge:function(e){try{this.nci.cmdRefreshChallenge()}catch(t){console.log("Error: "+t)}},getNewCaptcha:function(e){e.preventDefault();
try{this.nci.cmdGetANewChallenge()}catch(t){console.log("Error: "+t)}},togglePlayerModeText:function(e){try{e.preventDefault();
if(!this.isCaptchaInAudioMode())return;this.setPlayerMode("VIDEO"),this.nci.cmdSetPlayerMode(this.nci.PLAYERMODE_VIDEO)}catch(t){console.log("Error: "+t)}},togglePlayerModeAudio:function(e){try{e.preventDefault();
if(this.isCaptchaInAudioMode())return;this.setPlayerMode("AUDIO"),this.nci.cmdSetPlayerMode(this.nci.PLAYERMODE_AUDIO)}catch(t){console.log("Error: "+t)}},keypressEvent:function(e){if(e.keyCode==13){var t=document.querySelector("input.continue");
t&&(e.preventDefault(),e.stopPropagation(),t.click())}},focusCaptchaInputEvent:function(e){var t=e.target.getPosition();
t.top>10&&(t.top-=10,document.body.scrollTop=t.top)},updateStatusMessage:function(e){e&&this.mediaContainer&&(this.mediaContainer.innerHTML='<span class="media-status">'+e+"</span>")},onPageInputFocus:function(e){try{this.nci.logInputEvent(this.nci.INPUTEVENT_FORMFIELDFOCUS,[e.target.id])}catch(t){console.log("Error: "+t)}},onPageInputBlur:function(e){try{this.nci.logInputEvent(this.nci.INPUTEVENT_FORMFIELDBLUR,[e.target.id])}catch(t){console.log("Error: "+t)}},onPageKeyPress:function(){try{this.nci.logInputEvent(this.nci.INPUTEVENT_KEYDOWN)}catch(e){console.log("Error: "+e)}},onPageMouseClick:function(e){try{this.nci.logInputEvent(this.nci.INPUTEVENT_MOUSECLICK,[e.pageX,e.pageY])}catch(t){console.log("Error: "+t)}},onPageTouchEvent:function(e){try{this.nci.logInputEvent(this.nci.INPUTEVENT_TOUCHEVENT,[e.pageX,e.pageY])}catch(t){console.log("Error: "+t)}}}}),OnNuCaptchaJSError=function(e){var t=document.querySelector("div#nucaptcha-error-message");
if(t){var n=its.loc("JS.MZFinance.Captcha.LoadError");
t.innerHTML=n}},iTSDeviceRedeemDialog=function(){var e=function(e){return e*Math.PI/180},t=function(t){return function(n,r){var i=iTunes.createCanvas(n,r);
return i.beginPath(),i.moveTo(n/2,0),i.arc(n-t,t,t,e(270),e(360),!0),i.arc(n-t,r-t,t,e(0),e(90),!0),i.arc(t,r-t,t,e(90),e(180),!0),i.arc(t,t,t,e(180),e(270),!0),i.closePath(),i.fillStyle="rgb(0, 0, 0)",i.fill(),i}},n=function(e){return e.width=540,e.height=620,e.maskFunction=t(10),e.shouldDismissFunction=function(){return!1},e},r=function(){var e=iTunes.createAccountPage(its.deviceRedeemDialog.createAccountUrl);
e.style=e.STYLE_SIGN_UP;
var t=iTunes.createNavigationController(e);
if(its.deviceRedeemDialog.isIPad()){var r=iTunes.createWindow();
r.backViewController=t,n(r),r.show({duration:.5,transition:"slide-from-bottom"})}else iTunes.addEventListener("redeemDismissSheet",iTSDeviceRedeemDialog.redeemDismissSheet,!1),t.navigationBarHidden=!1,iTunes.viewController.presentModalViewController(t,"show-sheet")},i=function(){iTunes.removeEventListener("redeemDismissSheet",iTSDeviceRedeemDialog.redeemDismissSheet,!1);
var e=iTunes.createDialog();
e.title=its.loc("Js.MZFinance.SignIn");
var t=iTunes.createButton(its.loc("Js.MZFinance.SignIn_okButton"),function(e){s(!1);
var t=new Object;
t.completionCallback=function(e,t){e=="success"?document.forms[0].submit():s(!0)},t.forced=!0,iTunes.authenticateForAccount(iTunes.primaryAccount,t)}),n=iTunes.createButton(its.loc("Js.MZFinance.SignIn_newAccountButton"),function(e){r()}),i=iTunes.createButton(its.loc("Cancel"),null);
return e.buttons=Array(t,n,i),e.cancelButtonIndex=2,e},s=function(e){var t=iTunes.createButton(its.loc("MZFinance.RedeemButton"),iTSDeviceRedeem.prototype.redeemCode);
e?t.style="done":t.style="plain",iTunes.navigationBar.rightItem=t,iTunes.navigationBar.rightItem.enabled=e},o=function(){iTunes.viewController.dismissModalViewController()};
return{createSignInDialog:i,redeemDismissSheet:o}}(),its.kit.createController("iTSEditBillingInfoCCNumber",{binding:".cup #creditCardNumberField, .buy-store-credit #creditCardNumberField"}),iTSEditBillingInfoCCNumber.prototype.init=function(){this.upcc=document.querySelector("div#UPCC"),this.visa=document.querySelector("div#VISA"),this.amex=document.querySelector("div#AMEX"),this.mast=document.querySelector("div#MAST"),this.peas=document.querySelector("div#PEAS"),this.apwc=document.querySelector("div#APWC"),this.ccNum=document.querySelector("input#creditCardNumberField"),this.selectedCardLogo=document.querySelector(".selected-card-logo"),this.phone=document.querySelector("div.field.phone"),this.phoneNumberField=document.querySelector("input#phoneNumberField"),this.expiration=document.querySelector("div.field.expiration"),this.cvn=document.querySelector("div.field.creditVerificationNumber"),this.mobilePhone=document.querySelector("div#mobile-title"),this.mobileInputs=document.querySelector("div#mobile-inputs"),this.mobileNumberField=document.querySelector("input#mobileNumberField"),this.optionPicker=document.querySelector(".option-picker.payment-type"),this.bankField=document.querySelector("#bankField"),this.card_type_id=document.querySelector("#card_type_id"),this.selectedCardType="",this.cupMessage=document.querySelector("#cup-message"),this.cupMobileMessage=document.querySelector("#cup-mobile-message"),this.ccEditor=document.querySelector("#MHCCEditorGeneric"),this.isEditing=this.ccEditor&&this.ccEditor.classList.contains("edit"),this.submitButton=document.querySelector("#hiddenBottomRightButtonId, #hiddenFirstButtonId, #navNextButton"),this.cardNumberChanged=!1,this.cupAutoDetectionDisabled=this.element.hasClassName("cup-auto-detection-disabled");
if(this.optionPicker){this.options=this.optionPicker.querySelectorAll("div.option");
for(n=0;
n<this.options.length;
n++){var e=this.options[n];
e.subscriptionChangedListener=this.listen(e,"iTSOptionpicker.event.optionSelected",this.paymentMethodChangedEvent.bind(this)),e.hasClassName("selected")&&(this.selectedCardType=e.id)}}this.cupAutoDetectionDisabled||this.element.addEventListener("input",bind(this,this.ccNumberClickHandler),!1),this.update(this.selectedCardType,this.shouldShowCreditExp(this.card_type_id),this.shouldShowCreditCvm(this.card_type_id),this.shouldShowCUPFields(this.card_type_id)),this.useClientKddrStd=!0,this.kddrStd=document.querySelector("#kddr-std"),this.kddrStd?(this.kddrStd=this.kddrStd.value.replace(/([0-9]):/g,'"$1":'),this.trie=JSON.parse(this.kddrStd),delete this.kddrStd):(this.getCardTypeUrl=document.querySelector("#getCardTypeUrl").value,this.useClientKddrStd=!1);
if(!this.selectedCardType&&this.optionPicker&&this.optionPicker.iTSOptionPicker&&this.optionPicker.iTSOptionPicker.unselectOption){var t=document.querySelectorAll("input[type=text].clearoncardchange, input[type=password].clearoncardchange");
for(var n=0;
n<t.length;
n++)t[n].removeClassName("clearoncardchange");
this.optionPicker.iTSOptionPicker.selectOption(this.upcc),(this.card_type_id.value==19||this.card_type_id.value==18&&this.cupAutoDetectionDisabled)&&this.update("UPCC",!1,!1,!0);
for(var n=0;
n<t.length;
n++)t[n].addClassName("clearoncardchange")}},iTSEditBillingInfoCCNumber.prototype.shouldShowCUPFields=function(e){return e&&(e.value==18||e.value==19)},iTSEditBillingInfoCCNumber.prototype.shouldShowCreditCvm=function(e){return this.shouldShowCreditExp(e)},iTSEditBillingInfoCCNumber.prototype.shouldShowCreditExp=function(e){return e&&e.value==18},iTSEditBillingInfoCCNumber.prototype.showCupFields=function(e){e?(this.mobileInputs.setAttribute("style","display: block;"),this.mobilePhone.setAttribute("style","display: block;"),this.setMobilePhoneRequired(!0),this.cupMessage&&this.cupMessage.setAttribute("style","display: block;"),this.cupMobileMessage&&this.cupMobileMessage.setAttribute("style","display: block;")):(this.mobileInputs.setAttribute("style","display: none;"),this.mobilePhone.setAttribute("style","display: none;"),this.setMobilePhoneRequired(!1),this.cupMessage&&this.cupMessage.setAttribute("style","display: none;"),this.cupMobileMessage&&this.cupMobileMessage.setAttribute("style","display: none;"))},iTSEditBillingInfoCCNumber.prototype.showCreditCardFields=function(e,t){e&&this.expiration?this.expiration.setAttribute("style","display: block;"):this.expiration.setAttribute("style","display: none;"),this.cvn&&(t?this.cvn.setAttribute("style","display: -webkit-box;"):this.cvn.setAttribute("style","display: none;"))},iTSEditBillingInfoCCNumber.prototype.paymentMethodChangedEvent=function(e){var t=e.value==="UPCC",n=e.value==="APWC";
this.update(e.value,!1,!1,t,n),its.sf.Metrics&&its.sf.Metrics.setTargetInfo(this.submitButton,this.submitButton.id,"button",its.sf.Metrics.ActionType.CLICK,null,{paymentType:e.value}),this.updateSelectedCardLogo()},iTSEditBillingInfoCCNumber.prototype.updateRequiredFields=function(e){if(!this.bankField)return;e==="PEAS"?this.bankField.hasClassName("required")||this.bankField.addClassName("required"):this.bankField.removeClassName("required")},iTSEditBillingInfoCCNumber.prototype.update=function(e,t,n,r,i){i?this.showCreditCardFields(!1,!1):this.showCreditCardFields(t,n),r?this.showCupFields(!0):i||this.showCupFields(!1),this.updateRequiredFields(e)},iTSEditBillingInfoCCNumber.prototype.setMobilePhoneRequired=function(e){e?(this.mobileNumberField.hasClassName("required")||this.mobileNumberField.addClassName("required"),this.phone&&this.phoneNumberField&&(this.phone.setAttribute("style","display: none;"),this.phoneNumberField.removeClassName("required"))):(this.mobileNumberField.removeClassName("required"),this.phone&&this.phoneNumberField&&(this.phone.setAttribute("style","display: -webkit-box;"),this.phoneNumberField.hasClassName("required")||this.phoneNumberField.addClassName("required")))},iTSEditBillingInfoCCNumber.prototype.selectPaymentMethod=function(e){e?this.optionPicker&&this.optionPicker.iTSOptionPicker&&this.optionPicker.iTSOptionPicker.selectOption&&(e.paymentWasAutoSelected=!0,this.optionPicker.iTSOptionPicker.selectOption(e),logoUrl=e.getAttribute("logo-url"),this.updateSelectedCardLogo(logoUrl,e.id)):(this.optionPicker&&this.optionPicker.iTSOptionPicker&&this.optionPicker.iTSOptionPicker.selectOption&&(this.upcc.paymentWasAutoSelected=!0,this.optionPicker.iTSOptionPicker.selectOption(this.upcc)),this.updateSelectedCardLogo())},iTSEditBillingInfoCCNumber.prototype.updateSelectedCardLogo=function(e,t){if(!this.selectedCardLogo)return;e?(this.selectedCardLogo.style.backgroundImage="url('"+e+"')",this.selectedCardLogo.className="selected-card-logo "+t):this.selectedCardLogo.style.backgroundImage="none"},iTSEditBillingInfoCCNumber.prototype.ccNumberClickHandler=function(e){var t=this.ccNum.value+"";
if(!t||t=="")return;if(this.useClientKddrStd){if(this.trie){var n=this.findRange(t,this.trie);
if(n===0)this.selectPaymentMethod(this.upcc),this.card_type_id.value=19,this.update("UPCC",!1,!1,!0);
else if(n===1)this.selectPaymentMethod(this.upcc),this.card_type_id.value=18,this.update("UPCC",!0,!0,!0);
else if(t.indexOf("4")==0)this.selectPaymentMethod(this.visa),this.card_type_id.value=1,this.update("VISA",!0,!0);
else if(t.indexOf("50")==0||t.indexOf("51")==0||t.indexOf("52")==0||t.indexOf("53")==0||t.indexOf("54")==0||t.indexOf("55")==0)this.selectPaymentMethod(this.mast),this.card_type_id.value=4,this.update("MAST",!0,!0);
else if(t.indexOf("34")==0||t.indexOf("37")==0)this.selectPaymentMethod(this.amex),this.card_type_id.value=2,this.update("AMEX",!0,!0);
else if(!t||t==""||n===-1)this.selectPaymentMethod(),this.card_type_id.value=null,this.update("",!1,!1,!0)}else if(!t||t=="")this.selectPaymentMethod(),this.update("",!1,!1,!0)}else{if(t&&t.length>8&&t.length<12)return;if(t&&t.length<5)t.indexOf("4")==0?(this.selectPaymentMethod(this.visa),this.card_type_id.value=1,this.update("VISA",!0,!0)):t.indexOf("50")==0||t.indexOf("51")==0||t.indexOf("52")==0||t.indexOf("53")==0||t.indexOf("54")==0||t.indexOf("55")==0?(this.selectPaymentMethod(this.mast),this.card_type_id.value=4,this.update("MAST",!0,!0)):t.indexOf("34")==0||t.indexOf("37")==0?(this.selectPaymentMethod(this.amex),this.card_type_id.value=2,this.update("AMEX",!0,!0)):(this.selectPaymentMethod(),this.card_type_id.value=null,this.update("",!1,!1,!0));
else if(this.getCardTypeUrl){var r={};
r.ccNumber=t;
var i={url:this.getCardTypeUrl,method:"post",successCallback:function(e){var t=JSON.parse(e.responseText);
t.status===0?t.cardType&&(this.findResult=t.cardType,this.findResult==="19"?(this.selectPaymentMethod(this.upcc),this.card_type_id.value=19,this.update("UPCC",!1,!1,!0)):this.findResult==="18"?(this.selectPaymentMethod(this.upcc),this.card_type_id.value=18,this.update("UPCC",!0,!0,!0)):this.findResult==="1"?(this.selectPaymentMethod(this.visa),this.card_type_id.value=1,this.update("VISA",!0,!0)):this.findResult==="4"?(this.selectPaymentMethod(this.mast),this.card_type_id.value=4,this.update("MAST",!0,!0)):this.findResult==="2"?(this.selectPaymentMethod(this.amex),this.card_type_id.value=2,this.update("AMEX",!0,!0)):this.findResult==="0"&&(console.log("getCardTypeUrl: result is 0"),this.selectPaymentMethod(this.upcc),this.card_type_id.value=null,this.update("UPCC",!0,!0,!0))):(console.log("getCardTypeUrl: status is not 0"),this.selectPaymentMethod(this.upcc),this.update("UPCC",!0,!0,!0),this.card_type_id.value=null)}.bind(this),failureCallback:function(e){console.log("getCardTypeUrl: call failed."),this.selectPaymentMethod(this.upcc),this.card_type_id.value=null,this.update("UPCC",!0,!0,!0)}.bind(this),timeout:5e3,formParams:r};
iTSInclude.makeHttpRequest(i)}}},iTSEditBillingInfoCCNumber.prototype.findRange=function(e,t){if(!e||e.length===0)return-1;
var n=e.substring(0,1),r=t[n];
return typeof r=="number"?r:r===undefined?-1:this.findRange(e.slice(1),t[n])},its.kit.createController("iTSSMSEnterCode",{binding:"#enter-code-page"}),iTSSMSEnterCode.prototype.init=function(){iTunes.navigationBar.rightItem.enabled=!1,this.maxcodelength=6,this.resendLink=document.querySelector("#resend-code"),this.input=document.querySelector("#sms-code"),this.input&&(this.input.focus(),this.listen(this.input,"keyup","handleKeyPress")),this.resendLink&&(this.listen(this.resendLink,"click","resendClick"),afterOneMinute=!1,setTimeout(function(){afterOneMinute=!0},6e4))},iTSSMSEnterCode.prototype.handleKeyPress=function(){var e=this.input.value;
this.input.value.length==this.maxcodelength?iTunes.navigationBar.rightItem.enabled=!0:this.submitButton.hasClassName("disabled")||(iTunes.navigationBar.rightItem.enabled=!1)},iTSSMSEnterCode.prototype.resendClick=function(){if(!afterOneMinute){event.preventDefault();
var e=iTunes.createDialog();
e.title=its.loc("JS.DTHCCEditorCup.CodeAlreadySent_message"),e.body=its.loc("JS.DTHCCEditorCup.CodeAlreadySent_explanation");
var t=iTunes.createButton(its.loc("Ok"),null);
return e.buttons=Array(t),e.show(),!1}return!0},its.kit.createController("iTSK2FinanceOpenMail",{binding:"a.open-mail"}),iTSK2FinanceOpenMail.prototype.init=function(){this.element.addEventListener("click",this,!1)},iTSK2FinanceOpenMail.prototype.clickEvent=function(e){iTunes.openURL("message://234234")},its.kit.createController("iTSAddMoneyOptions",{binding:"#MHAddMoneyPage"}),iTSAddMoneyOptions.prototype.init=function(){this.cardTypeId=document.querySelector("#card_type_id"),this.submitButton=document.querySelector("#hiddenBottomRightButtonId, #hiddenFirstButtonId, #navNextButton");
if(this.element){its.sf.Metrics.setTargetInfo(e,e.id,"option",its.sf.Metrics.ActionType.SELECT,null,{}),this.options=document.querySelectorAll("div.option");
if(this.options)for(j=0;
j<this.options.length;
j++){var e=this.options[j];
e.selectionListener=this.listen(e,"iTSOptionpicker.event.optionSelected",this.paymentTypeChangedEvent.bind(this)),its.sf.Metrics.setTargetInfo(e,e.id,"option",its.sf.Metrics.ActionType.SELECT,null,{})}this.clickable=document.querySelectorAll("#hiddenBottomRightButtonId, #hiddenFirstButtonId, #navNextButton, #navBackButton, div.option");
for(k=0;
k<this.clickable.length;
k++){var t=this.clickable[k];
its.sf.Metrics.setTargetInfo(t,t.id,t.nodeName.toLowerCase(),its.sf.Metrics.ActionType.CLICK,null,{})}}},iTSAddMoneyOptions.prototype.paymentTypeChangedEvent=function(e){var t=e.target,n=this.cardTypeId?this.cardTypeId.value:document.querySelector("#card_type_id").value;
its.sf.Metrics.setTargetInfo(this.submitButton,this.submitButton.id,"button",its.sf.Metrics.ActionType.CLICK,null,{paymentType:n})},iTSAddMoneyOptions.prototype.handleClickEvent=function(e){},its.kit.createController("iTSEditBillingInfoSesame",{binding:".sesame-fields #sesame-id-input"}),iTSEditBillingInfoSesame.prototype.init=function(){this.upcc=document.querySelector("div#UPCC"),this.visa=document.querySelector("div#VISA"),this.amex=document.querySelector("div#AMEX"),this.mast=document.querySelector("div#MAST"),this.peas=document.querySelector("div#PEAS"),this.apwc=document.querySelector("div#APWC"),this.creditCardDetails=document.querySelector("div#credit-card-details"),this.cardExpiration=document.querySelector("div#credit-card-expiration"),this.sesameFields=document.querySelector("div#sesame-fields"),this.sesameIdInput=document.querySelector("input#sesame-id-input"),this.sesameIdInput&&(this.shouldMask=this.sesameIdInput.hasClassName("shouldMask"),this.idIsPhone=this.sesameIdInput.hasClassName("idIsPhone"),this.idIsEmail=this.sesameIdInput.hasClassName("idIsEmail")),this.nationalIdDiv=document.querySelector("div#national-id"),this.nationalIdInput=document.querySelector("input#national-id-input"),this.emailRegex=document.querySelector("#email_regex").value,this.phoneRegex=document.querySelector("#phone_regex").value,this.selectedCardLogo=document.querySelector(".selected-card-logo"),this.selectedCardLogoSesame=document.querySelector(".selected-card-logo-sesame"),this.phone=document.querySelector("div.field.phone"),this.phoneNumberField=document.querySelector("input#phoneNumberField"),this.mobilePhoneDiv=document.querySelector("div.cup-mobile"),this.mobilePhoneTitle=document.querySelector("div#mobile-title"),this.mobilePhoneTitleSesame=document.querySelector("div#mobile-title-sesame"),this.countryCode=document.querySelector("#country-code"),this.mobileInputs=document.querySelector("div#mobile-inputs"),this.cupMessage=document.querySelector("#cup-message"),this.cupMobileMessage=document.querySelector("#cup-mobile-message"),this.sesameMobileMessage=document.querySelector("#sesame-mobile-message"),this.mobileNumberField=document.querySelector("input#mobileNumberField"),this.mobileNumberFieldLabel=document.querySelector("label.mobilePhone"),this.optionPicker=document.querySelector(".option-picker.payment-type"),this.card_type_id=document.querySelector("#card_type_id"),this.country_dial_div=document.querySelector("#country-dial-div"),this.selectedCardType="",this.ccEditor=document.querySelector("#MHCCEditorGeneric"),this.isEditing=this.ccEditor&&this.ccEditor.classList.contains("edit"),this.submitButton=document.querySelector("#hiddenBottomRightButtonId, #hiddenFirstButtonId, #navNextButton");
if(this.optionPicker){this.options=this.optionPicker.querySelectorAll("div.option");
for(i=0;
i<this.options.length;
i++){var e=this.options[i];
e.subscriptionChangedListener=this.listen(e,"iTSOptionpicker.event.optionSelected",this.paymentMethodChangedEvent.bind(this)),e.hasClassName("selected")&&(this.selectedCardType=e.id)}}this.element.addEventListener("input",bind(this,this.sesameIdClickHandler),!1);
var t=this.selectedCardType==="APWC",n=this.selectedCardType==="UPCC",r=this.selectedCardType==="PEAS";
t&&(this.phone&&this.phone.setAttribute("style","display: none;"),this.phoneNumberField&&this.phoneNumberField.removeClassName("required"),this.mobileNumberFieldLabel.setAttribute("style","display: none;"),logoUrl=this.apwc.getAttribute("logo-url"),this.updateSelectedCardLogo(logoUrl,this.apwc.id)),this.update(this.selectedCardType,t,n,r),this.idIsPhone?(this.nationalIdInput.hasClassName("required")||this.nationalIdInput.addClassName("required"),this.showMobileFields(!0,!1),this.mobileNumberField.removeClassName("required"),this.nationalIdDiv.setAttribute("style","display: block;")):this.idIsEmail&&(this.mobileNumberField.hasClassName("required")||this.mobileNumberField.addClassName("required"),this.nationalIdDiv.setAttribute("style","display: none;"),this.nationalIdInput.removeClassName("required"),this.showMobileFields(!0,!0)),this.pageError=document.querySelector("p.error");
if(this.pageError&&this.pageError.innerHTML)try{var s=this.pageError.innerHTML,o=/\[([^\]]*)\]/,u=/\(([^\)]*)\)/,a=/\[([^\)]*)\)/,f=o.exec(s)[0];
f=f.substring(1,f.length-1);
var l=u.exec(s)[0];
l=l.substring(1,l.length-1);
var c='<a href="javascript:void(0)" onclick="iTunes.openURL(\''+l+'\');event.preventDefault();" style="color: #0080fc; text-decoration: none;">'+f+"</a>",h=s.replace(a,c);
this.pageError.innerHTML=h}catch(p){}this.form=document.querySelector("form"),this.form&&(this.form.onsubmit=this.formOnSubmit,this.form.headerLabels=this.form.querySelectorAll("div.header-label"),this.form.headerLabels&&this.form.headerLabels.each(function(e){var t=e.querySelector("div.field.error"),n=e.querySelector("h2.header-label");
t&&n?n.hasClassName("error")||n.addClassName("error"):n&&n.removeClassName("error")}))},iTSEditBillingInfoSesame.prototype.paymentMethodChangedEvent=function(e){var t=e.value==="APWC",n=e.value==="UPCC",r=e.value==="PEAS";
this.update(e.value,t,n,r),t?(this.phone&&this.phone.setAttribute("style","display: none;"),this.phoneNumberField&&this.phoneNumberField.removeClassName("required"),this.mobileNumberFieldLabel.setAttribute("style","display: none;"),this.nationalIdInput&&this.nationalIdInput.value.length==0&&(this.nationalIdDiv.setAttribute("style","display: none;"),this.nationalIdInput.removeClassName("required")),logoUrl=this.apwc.getAttribute("logo-url"),this.updateSelectedCardLogo(logoUrl,this.apwc.id)):this.updateSelectedCardLogo()},iTSEditBillingInfoSesame.prototype.updateSelectedCardLogo=function(e,t){if(!this.selectedCardLogoSesame)return;e?(this.selectedCardLogoSesame.style.backgroundImage="url('"+e+"')",this.selectedCardLogoSesame.className="selected-card-logo "+t):(this.selectedCardLogoSesame.style.backgroundImage="none",this.selectedCardLogoSesame.className="selected-card-logo-sesame")},iTSEditBillingInfoSesame.prototype.update=function(e,t,n,r){t?this.showSesameFields(!0,n,r):this.showSesameFields(!1,n,r)},iTSEditBillingInfoSesame.prototype.showMobileFields=function(e,t){t?(this.mobileInputs.setAttribute("style","display: block;"),e?(this.cupMessage&&this.cupMessage.setAttribute("style","display: none;"),this.cupMobileMessage&&this.cupMobileMessage.setAttribute("style","display: none;"),this.sesameMobileMessage&&this.sesameMobileMessage.setAttribute("style","display: block;"),this.mobilePhoneTitle.setAttribute("style","display: none;"),this.mobilePhoneTitleSesame&&this.mobilePhoneTitleSesame.setAttribute("style","display: block;"),this.country_dial_div.setAttribute("style","display: block;")):(this.cupMessage&&this.cupMessage.setAttribute("style","display: block;"),this.cupMobileMessage&&this.cupMobileMessage.setAttribute("style","display: block;"),this.sesameMobileMessage&&this.sesameMobileMessage.setAttribute("style","display: none;"),this.mobilePhoneTitle.setAttribute("style","display: block;"),this.mobilePhoneTitleSesame&&this.mobilePhoneTitleSesame.setAttribute("style","display: none;"),this.country_dial_div.setAttribute("style","display: none;"))):(this.mobileInputs.setAttribute("style","display: none;"),this.cupMessage&&this.cupMessage.setAttribute("style","display: none;"),this.cupMobileMessage&&this.cupMobileMessage.setAttribute("style","display: none;"),this.sesameMobileMessage&&this.sesameMobileMessage.setAttribute("style","display: none;"),this.mobilePhoneTitle.setAttribute("style","display: none;"),this.mobilePhoneTitleSesame&&this.mobilePhoneTitleSesame.setAttribute("style","display: none;"),this.country_dial_div.setAttribute("style","display: none;"))},iTSEditBillingInfoSesame.prototype.showSesameFields=function(e,t,n){if(e){this.sesameFields.setAttribute("style","display: block;");
var r=this.sesameIdInput.value+"";
r&&r.match(this.phoneRegex)?(this.nationalIdDiv.setAttribute("style","display: block;"),this.nationalIdInput.hasClassName("required")||this.nationalIdInput.addClassName("required")):(this.nationalIdDiv.setAttribute("style","display: none;"),this.nationalIdInput.removeClassName("required")),this.creditCardDetails.setAttribute("style","display: none;"),this.cardExpiration&&this.cardExpiration.setAttribute("style","display: none;"),r&&r.toLowerCase().match(this.emailRegex)?this.showMobileFields(!0,!0):this.showMobileFields(!0,!1),this.sesameIdInput.hasClassName("required")||this.sesameIdInput.addClassName("required")}else this.sesameFields.setAttribute("style","display: none;"),this.sesameIdInput.removeClassName("required"),this.nationalIdInput&&this.nationalIdInput.removeClassName("required"),t?(this.creditCardDetails.setAttribute("style","display: block;"),this.cardExpiration&&this.cardExpiration.setAttribute("style","display: block;"),this.showMobileFields(!1,!0)):n?(this.creditCardDetails.setAttribute("style","display: none;"),this.cardExpiration&&this.cardExpiration.setAttribute("style","display: none;"),this.showMobileFields(!1,!1)):(this.creditCardDetails.setAttribute("style","display: block;"),this.cardExpiration&&this.cardExpiration.setAttribute("style","display: block;"),this.showMobileFields(!1,!1))},iTSEditBillingInfoSesame.prototype.sesameIdClickHandler=function(e){var t=this.sesameIdInput.value+"";
if(!t||t=="")return;t.match(this.phoneRegex)?(this.nationalIdInput.hasClassName("required")||this.nationalIdInput.addClassName("required"),this.showMobileFields(!0,!1),this.mobileNumberField.removeClassName("required"),this.nationalIdDiv.setAttribute("style","display: block;"),this.countryCode.selectedIndex=0,this.mobileNumberField.value=""):t.toLowerCase().match(this.emailRegex)&&(this.mobileNumberField.hasClassName("required")||this.mobileNumberField.addClassName("required"),this.nationalIdDiv.setAttribute("style","display: none;"),this.nationalIdInput.removeClassName("required"),this.showMobileFields(!0,!0),this.nationalIdInput.value="")},iTSEditBillingInfoSesame.prototype.formOnSubmit=function(e){!e.target.validated&&this.headerLabels&&this.headerLabels.each(function(e){var t=e.querySelector("div.field.error"),n=e.querySelector("h2.header-label");
t&&n?n.hasClassName("error")||n.addClassName("error"):n&&n.removeClassName("error")})},its.dv7.theme={},function(){iTunes&&iTunes.clientIdentifier=="WiFi-Music"||typeof iTunes.clientIdentifier=="undefined"?(its.dv7.theme.app="bootstrap",its.string.compareNumerically(its.client.version(),"7.1")>=0?(its.dv7.theme.lightColor=iTunes.device&&iTunes.device.accessibilityDarkenSystemColors?"rgb(40,89,253)":"rgb(0,128,252)",its.dv7.theme.darkColor="rgb(0,160,252)",its.dv7.theme.packageName=iTunes.device&&iTunes.device.accessibilityDarkenSystemColors?"bootstrap_ax":"bootstrap_blue"):(its.dv7.theme.lightColor="rgb(57,170,220)",its.dv7.theme.darkColor="rgb(90,200,250)",its.dv7.theme.packageName="bootstrap")):iTunes&&iTunes.clientIdentifier=="Podcasts"?(its.dv7.theme.app="podcasts",its.dv7.theme.lightColor=iTunes.device&&iTunes.device.accessibilityDarkenSystemColors?"rgb(91,38,170)":"rgb(114,36,216)",its.dv7.theme.darkColor="rgb(114,36,216)",its.dv7.theme.packageName=iTunes.device&&iTunes.device.accessibilityDarkenSystemColors?"podcasts_ax":"podcasts"):iTunes&&iTunes.clientIdentifier=="eBooks"?(its.dv7.theme.app="ibooks",its.dv7.theme.lightColor=iTunes.device&&iTunes.device.accessibilityDarkenSystemColors?"rgb(40,89,253)":"rgb(0,128,252)",its.dv7.theme.darkColor="rgb(0,128,252)",its.dv7.theme.packageName=iTunes.device&&iTunes.device.accessibilityDarkenSystemColors?"ibooks_ax":"ibooks"):(its.dv7.theme.app="itunesu",its.dv7.theme.lightColor=iTunes&&iTunes.device&&iTunes.device.accessibilityDarkenSystemColors?"rgb(40,89,253)":"rgb(0,128,252)",its.dv7.theme.darkColor="rgb(39,151,255)",its.dv7.theme.packageName=iTunes&&iTunes.device&&iTunes.device.accessibilityDarkenSystemColors?"itunesu_ax":"itunesu")}(),its.kit.createController("iTSCarmPaymentDetails",{binding:"#carm-container",controller:{submitEvent:function(e){return this.getComponents()[0].submitEvent(e)}},component:{init:function(){this.done=!1,this.attemptId=0,this.log="",this.carrierBillingOption=document.querySelector(".CBXX.option"),this.thisPhone=document.querySelector("#div-this-phone"),this.differentPhone=document.querySelector("#div-different-phone"),this.mobilePhoneNumber=document.querySelector("#div-mobile-phone-number"),this.currentPhoneNumber=document.querySelector("#div-current-phone"),this.mobilePhoneField=document.querySelector("#mobile-phone-number"),this.carrierBillingOption.paymentChangedListener=this.listen(this.carrierBillingOption,"iTSOptionpicker.event.optionSelected",this.carrierBillingClicked.bind(this)),this.carrierId=null,this.carrierBaseKey=null,this.thisPhone&&this.listen(this.thisPhone,"iTSOptionpicker.event.optionSelected",this.thisPhoneClicked.bind(this)),this.differentPhone&&this.listen(this.differentPhone,"iTSOptionpicker.event.optionSelected",this.differentPhoneClicked.bind(this)),this.currentPhoneNumber&&this.listen(this.currentPhoneNumber,"iTSOptionpicker.event.optionSelected",this.currentPhoneClicked.bind(this)),this.mobilePhoneField&&this.listen(this.mobilePhoneField,"input",this.handleMobilePhoneInput.bind(this)),this.isEditing=document.querySelector("#MHCCEditorGeneric.edit"),this.optInType=document.querySelector("#optin-type"),this.reset(),this.httpRoundTripInMs=0,this.httpRoundTripSucceeded=!1,this.httpResponse="",this.httpOptinCompletedInMs=0,this.httpOptinSucceeded=!1,this.silentSmsOptinCompletedInMs=0,this.silentSmsOptinSucceeded=!1,this.isSupportedNetwork=!1;
if(iTunes&&iTunes.telephony){this.mcc=iTunes.telephony.mobileCountryCode,this.mnc=iTunes.telephony.mobileNetworkCode,this.originalCarrierInstructionText=document.querySelector("#carm-container .notification")?document.querySelector("#carm-container .notification").innerHTML:null;
var e=document.querySelector("#carm-container").getAttribute("network-map");
try{this.networkMap=e&&JSON.parse(e),this.isSupportedNetwork=this.checkNetworkEligibility()}catch(t){}this.debug(this.attemptId,"initial telephony lookup of resulted in: mcc="+this.mcc+" mnc="+this.mnc+" and networkMap="+this.networkMap)}this.supportsConsentFlow=this.carrierNetworkMap&&this.carrierNetworkMap.tclink,this.selectedPaymentType()==="CBXX"?(switchToCarmDetails(),this.carrierBillingClicked()):this.selectedPaymentType()==="NONE"?switchToNonePaymentType():switchToCreditCardDetails()},checkNetworkEligibility:function(){if(this.mcc&&this.mnc&&this.networkMap){var e=this.networkMap.length;
for(var t=0;
t<e;
t++){var n=this.networkMap[t].networks;
if(n!=null)for(var r=0;
r<n.length;
r++)if(n[r]!=null&&n[r][this.mcc]==this.mnc)return this.carrierNetworkMap=this.networkMap[t],!0}}return!1},updateInstructions:function(){this.carrierInstructions=document.querySelector("#carm-container .notification");
if(this.supportsConsentFlow){if(!this.carrierInstructions){var e=!0;
this.carrierInstructions=document.createElement("p"),this.carrierInstructions.classList.add("notification"),this.carrierInstructions.setAttribute("style","text-align:left;margin:0;"),this.id="carrier-instructions"}var t={carrierName:this.carrierNetworkMap.name},n='<a target="_blank" rel="noopener noreferrer" style="color:#0073ff;" href="'+this.carrierNetworkMap.tcurl+'">'+its.loc("JS.MZCommerce.CarrierBilling.CarrierTerms.url.name",t)+"</a>",r={url:n},i=its.loc("JS.MZCommerce.CarrierBilling.CarrierTerms",r);
this.carrierInstructions.innerHTML=i,e&&document.querySelector("#carm-details").insertAdjacentElement("afterEnd",this.carrierInstructions)}else typeof this.originalCarrierInstructionText!="undefined"&&this.carrierInstructions.innerHTML!==this.originalCarrierInstructionText&&(this.carrierInstructions.innerHTML=this.originalCarrierInstructionText)},submitEvent:function(e){if(!document.querySelector("#CBXX"))return!0;
var t=e.target.clickedInput;
return["hiddenBottomRightButtonId","hiddenFirstButtonId","navNextButton"].indexOf(t.id)<0||this.done===!0?!0:document.querySelector("#CBXX").hasClassName("selected")?document.querySelector("#div-mobile-phone-number").style["display"]!="none"?document.querySelector("#mobile-phone-number").value===""?(this.showError(its.loc("JS.MZCommerce.CarrierBilling.MobileNumberRequired")),!1):!0:this.done?(this.done=!1,!0):document.querySelector("#div-this-phone").hasClassName("selected")?(this.disableNavButtons(),this.kickoffSilentAuth(),!1):(document.querySelector("#div-this-phone")?this.showError(its.loc("JS.MZCommerce.CarrierBilling.ChooseBillingPhoneOption")):this.showError(its.loc("JS.MZCommerce.CarrierBilling.MobileNumberRequired")),!1):!0},handleMobilePhoneInput:function(e){this.optInType.value="otp",!e&&window.event&&(e=window.event);
var t=e.keyCode?e.keyCode:e.charCode,n=String.fromCharCode(t);
(e.ctrlKey||!e.metaKey||!e.altKey||!e.shiftKey||t>40||!n.match(/[1234567890]/))&&e.preventDefault()},kickoffSilentAuth:function(){var e=this.reset();
this.debug(e,"mcc = "+this.mcc+", mnc = "+this.mnc);
if(!this.mcc||!this.mnc){this.silentAuthFailed(e,"mcc and/or mnc not defined");
return}var t=document.querySelector("#carm-container").getAttribute("carm-configure-url"),n=10;
this.debug(e,"get silent auth configure: url = "+t+", timeout = "+n+" sec"),iTSInclude.makeHttpRequest({url:t,method:"POST",timeout:n*1e3,formParams:{mcc:this.mcc,mnc:this.mnc},successCallback:function(t){try{this.debug(e,"configure response: "+t.responseText),this.parseConfig(t.responseText),this.debug(e,"http url: "+this.httpUrl),this.debug(e,"sms message: "+this.smsMessage),this.doHeaderEnrichment(e)}catch(n){this.silentAuthFailed(e,"failed to parse configure: "+JSON.stringify(n),its.loc("JS.MZApplication.GeneralError_explanation")),this.enableNavButtons()}}.bind(this),failureCallback:function(t){this.enableNavButtons(),this.silentAuthFailed(e,"failed to obtain silent auth configure",its.loc("JS.MZApplication.GeneralError_explanation"))}.bind(this),timeoutCallback:null})},doHeaderEnrichment:function(e){this.debug(e,"http request: enter");
if(!this.httpUrl){this.debug(e,"httpUrl not defined, switch to sms"),this.doSilentSms(e);
return}this.debug(e,"httpUrl defined, preparing configure");
var t={useJscBridge:!0,acceptStatus204:!0,url:this.httpUrl,dontChangeUrl:!0,method:"GET",timeout:this.httpTimeout,successCallback:function(t){var n=this.logHttpRoundTripInfo(t,!0),r=t.responseText||"not available";
this.debug(e,"http request succeeded, scheduling validation."),this.debug(e,"http status code: "+t.status+", response: "+r.substring(0,256)),this.debug(e,"schedule http validation with httpPollDelay1st = "+this.httpPollDelay1st),this.doSetTimeout(e,"validateHeaderEnrichment/1st",this.validateHeaderEnrichment,this.httpPollDelay1st),this.debug(e,"http validation scheduled")}.bind(this),failureCallback:function(t){var n=this.logHttpRoundTripInfo(t,!1);
this.debug(e,"http request failed, switching to sms"),this.debug(e,"http status code: "+t.status+", response: "+(t.responseText||"not available")),this.doSilentSms(e)}.bind(this),timeoutCallback:null};
this.debug(e,"force using cellular network"),iTunes&&typeof iTunes.requireCellular!="undefined"&&iTunes.requireCellular(t.url),this.tsHeaderEnrichmentStart=Date.now(),this.debug(e,"initiating http request..."),iTSInclude.makeHttpRequest(t),this.debug(e,"http request initiated: "+(new Date).toLocaleTimeString())},validateHeaderEnrichment:function(e){if(this.httpValidateCount>0&&Date.now()-this.tsHeaderEnrichmentStart>=this.httpOptinTimeout){this.debug(e,"http validation has timed out, switching to sms"),this.doSilentSms(e);
return}var t={url:this.httpPollUrl,method:"GET",timeout:this.pollTimeout,successCallback:function(t){this.debug(e,"validate http request: response received. response = "+t.responseText);
try{var n=JSON.parse(t.responseText);
if(n.isPendingConfirm){this.debug(e,"validate http request: isPendingConfirm = TRUE"),this.debug(e,"silent auth DONE after validating http request"),this.optInType.value="http",this.done=!0,this.httpOptinCompletedInMs=Date.now()-this.tsHeaderEnrichmentStart,this.httpOptinSucceeded=!0,this.submitStatsData(e);
var r=document.querySelector("#hiddenBottomRightButtonId, #hiddenFirstButtonId, #navNextButton");
r?r.click():document.forms[0].submit();
return}this.debug(e,"validate http request: isPendingConfirm = FALSE"),this.setTimeout(e,"validateHeaderEnrichment",this.validateHeaderEnrichment,this.httpPollDelay,this.tsHeaderEnrichmentStart,this.httpOptinTimeout)||(this.debug(e,"validate http request: next poll will timeout, skip http and switching to sms"),this.doSilentSms(e))}catch(i){this.debug(e,"validate error, probably parsing exception, switching to sms"),this.done=!1,this.doSilentSms(e)}}.bind(this),failureCallback:function(t){this.debug(e,"validate http request: failed");
if(this.httpValidateCount>=10||!this.setTimeout(e,"validateHeaderEnrichment",this.validateHeaderEnrichment,this.httpPollDelay,this.tsHeaderEnrichmentStart,this.httpOptinTimeout))this.debug(e,"validate http: already failed 10 times or next validation call will timeout, switching to sms"),this.doSilentSms(e);
this.done=!1}.bind(this),timeoutCallback:null};
this.httpValidateCount++,this.debug(e,"about to validate http request, count = "+this.httpValidateCount),iTSInclude.makeHttpRequest(t),this.debug(e,"http validation request initiated")},logHttpRoundTripInfo:function(e,t){this.httpRoundTripInMs=Date.now()-this.tsHeaderEnrichmentStart,this.httpRoundTripSucceeded=t,this.httpResponse="status: "+e.status+", response: "+e.responseText},doSilentSms:function(e){this.debug(e,"send sms: enter"),this.httpOptinCompletedInMs=Date.now()-this.tsHeaderEnrichmentStart,this.tsSilentSmsStart=Date.now();
if(!this.fallbackToSilentSms){this.silentAuthFailed(e,"send sms: do not fall back to silent sms");
return}if(!this.shortCode||!this.smsMessage){this.silentAuthFailed(e,"send sms: configure not defined");
return}if(this.smsRequestSent)this.debug(e,"not sending sms because it's already sent");
else{if(!iTunes.telephony.sendSMS(this.smsMessage,this.shortCode)){this.silentAuthFailed(e,"cannot send sms");
return}this.smsRequestSent=!0,this.debug(e,"sms was sent")}if(this.doSetTimeout(e,"validateSilentSms/1st",this.validateSilentSms,this.smsPollDelay1st)){this.silentAuthFailed(e,"sms: cannot schedule next validation, will timeout");
return}this.debug(e,"initial sms validation was scheduled")},validateSilentSms:function(e){if(this.smsValidateCount>0&&Date.now()-this.tsSilentSmsStart>=this.smsOptinTimeout){this.silentAuthFailed(e,"validate sms: will timeout, fail");
return}var t={url:this.smsPollUrl,method:"GET",timeout:this.pollTimeout,successCallback:function(t){try{this.debug(e,"validate sms: response received, response = "+t.responseText);
var n=JSON.parse(t.responseText);
if(n.isPendingConfirm){this.debug(e,"validate sms: isPendingConfirm = TRUE, silent auth DONE after validating sms"),this.optInType.value="sms",this.done=!0,this.silentSmsOptinCompletedInMs=Date.now()-this.tsSilentSmsStart,this.silentSmsOptinSucceeded=!0,this.submitStatsData(e);
var r=document.querySelector("#hiddenBottomRightButtonId, #hiddenFirstButtonId, #navNextButton");
r?r.click():document.forms[0].submit();
return}this.debug(e,"validate sms: isPendingConfirm = FALSE"),(this.smsValidateCount>=10||!this.setTimeout(e,"validateSilentSms",this.validateSilentSms,this.smsPollDelay,this.tsSilentSmsStart,this.smsOptinTimeout))&&this.silentAuthFailed(e,"cannot schedule next sms validation because it'll timeout")}catch(i){this.enableNavButtons(),this.done=!1,this.silentAuthFailed(e,"failed to parse sms validation response, exception: "+JSON.stringify(i))}}.bind(this),failureCallback:function(t){this.debug(e,"validate sms request failed");
if(this.smsValidateCount>=10||!this.setTimeout(e,"validateSilentSms",this.validateSilentSms,this.smsPollDelay,this.tsSilentSmsStart,this.smsOptinTimeout))this.enableNavButtons(),this.done=!1,this.silentAuthFailed(e,"cannot schedule next sms validation: already failed 10 times or next poll will timeout")}.bind(this),timeoutCallback:null};
this.smsValidateCount++,this.debug(e,"about to validate sms: count = "+this.smsValidateCount),iTSInclude.makeHttpRequest(t),this.debug(e,"sms validation request initiated")},parseConfig:function(e){var t=JSON.parse(e);
this.httpOptinTimeout=this.getIntWithDefault(t.httpOptinTimeout,2e4),this.smsOptinTimeout=this.getIntWithDefault(t.smsOptinTimeout,3e4),this.httpUrl=t.httpUrl,this.httpTimeout=this.getIntWithDefault(t.httpTimeout,1e4),this.fallbackToSilentSms=t.fallbackToSilentSms,this.shortCode=t.shortCode,this.smsMessage=t.smsMessage,this.pollTimeout=this.getIntWithDefault(t.pollTimeout,1e4),this.httpPollUrl=t.httpPollUrl,this.httpPollDelay1st=this.getIntWithDefault(t.httpPollDelay1st,0),this.httpPollDelay=this.getIntWithDefault(t.httpPollDelay,5e3),this.smsPollUrl=t.smsPollUrl,this.smsPollDelay1st=this.getIntWithDefault(t.smsPollDelay1st,4e3),this.smsPollDelay=this.getIntWithDefault(t.smsPollDelay,5e3),this.statsUrl=t.statsUrl},carrierBillingClicked:function(e){if(iTunes&&iTunes.viewController||nativeiTunes&&nativeiTunes.viewController){this.backButton=iTunes.viewController&&iTunes.viewController.toolbarItems[0]?iTunes.viewController.toolbarItems[0]:nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.leftItem,this.backButtonAction=this.backButton.action,this.nextButton=iTunes.viewController&&iTunes.viewController.toolbarItems[2]?iTunes.viewController.toolbarItems[2]:nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.rightItem,this.nextButtonAction=this.nextButton.action;
if(its&&its.client&&navigator.userAgent.indexOf("com.apple.Preferences")>=0&&!its.client.isClientGreaterThanOrEqualToSpecifiedVersion("9.3")){var t=iTunes.createDialog();
if(t){var n=its.loc("JS.MZCommerce.CantUpdateMobileBilling_explanation");
if(typeof iTunes.viewController=="undefined"){t.setBody(n);
var r=iTunes.createButton();
r.setTitle(its.loc("Ok")),r.setAction(null),t.setButtons(Array(r)),t.show()}else{t.body=n;
var r=iTunes.createButton(its.loc("Ok"),null);
t.buttons=Array(r),t.show()}}}}this.isEditing?this.currentPhoneNumber?(this.currentPhoneNumber.style.display="-webkit-box",this.currentPhoneNumber.classList.add("selected"),this.currentPhoneNumber.setAttribute("aria-checked","true"),this.currentPhoneClicked()):this.thisPhone?this.isSupportedNetwork?(this.thisPhone.style.display="-webkit-box",this.thisPhone.classList.add("selected"),this.thisPhone.setAttribute("aria-checked","true"),this.thisPhoneClicked()):(this.thisPhone.style.display="none",this.currentPhoneNumber&&(this.currentPhoneNumber.style.display="none"),this.differentPhone.style.display="none",this.differentPhoneClicked()):this.differentPhone&&(this.differentPhone.style.display="none",this.differentPhoneClicked()):this.isSupportedNetwork?this.thisPhone?(this.thisPhone.style.display="-webkit-box",this.differentPhone&&(this.differentPhone.style.display="-webkit-box"),this.mobilePhoneField.value===""?(this.thisPhoneClicked(e),this.thisPhone.classList.add("selected"),this.thisPhone.setAttribute("aria-checked","true")):(this.differentPhoneClicked(),this.differentPhone.classList.add("selected"),this.differentPhone.setAttribute("aria-checked","true"))):this.differentPhone&&(this.differentPhone.style.display="none",this.mobilePhoneField.focus()):(this.thisPhone&&(this.thisPhone.style.display="none"),this.differentPhone&&(this.differentPhone.style.display="none"),this.currentPhoneNumber&&(this.currentPhoneNumber.style.display="none"),this.differentPhoneClicked())},thisPhoneClicked:function(e){this.updateInstructions(),document.activeElement!==this.mobilePhoneField&&this.mobilePhoneField.blur(),this.mobilePhoneNumber&&this.mobilePhoneNumber.style.display!=="none"&&(this.mobilePhoneNumber.style.display="none"),this.optInType&&(this.optInType.value="thisphone"),this.mobilePhoneNumber&&this.mobilePhoneNumber.classList.remove("required"),this.differentPhone.classList.contains("selected")&&(this.differentPhone.classList.remove("selected"),this.differentPhone.removeAttribute("aria-checked"))},differentPhoneClicked:function(e){this.updateInstructions(),this.mobilePhoneNumber&&(this.mobilePhoneNumber.classList.add("required"),this.mobilePhoneNumber.style.display==="none"&&(this.mobilePhoneNumber.style.display="block"),this.mobilePhoneField.focus()),this.optInType&&(this.optInType.value="otp"),this.thisPhone&&this.thisPhone.classList.contains("selected")&&(this.thisPhone.classList.remove("selected"),this.thisPhone.removeAttribute("aria-checked")),this.currentPhoneNumber&&this.currentPhoneNumber.classList.contains("selected")&&(this.currentPhoneNumber.classList.remove("selected"),this.currentPhoneNumber.removeAttribute("aria-checked"))},currentPhoneClicked:function(e){this.mobilePhoneField.blur(),this.mobilePhoneNumber.style.display="none",this.optInType&&(this.optInType.value="dontchange"),this.mobilePhoneNumber&&this.mobilePhoneNumber.classList.remove("required"),this.differentPhone.classList.contains("selected")&&(this.differentPhone.classList.remove("selected"),this.differentPhone.removeAttribute("aria-checked"))},selectedPaymentType:function(){return document.querySelector("#paymentType .selected").id},setTimeout:function(e,t,n,r,i,s){return Date.now()-i+r>=s?!1:(this.doSetTimeout(e,t,n,r),!0)},doSetTimeout:function(e,t,n,r){r=this.getIntWithDefault(r,5e3),this.debug(e,"setTimeout("+t+"): delay = "+r);
var i=n.bind(this);
window.setTimeout(function(){i(e)},r)},getIntWithDefault:function(e,t){return typeof e!="undefined"&&e!=null?e:t},silentAuthFailed:function(e,t,n){var r=n||its.loc("JS.MZApplication.GeneralError_explanation");
this.showError(r),this.enableNavButtons(),this.done=!1,this.debug(e,"silent optin failed, debug message: "+t+", user message: "+r),this.silentSmsOptinCompletedInMs=Date.now()-this.tsSilentSmsStart,this.silentSmsOptinSucceeded=!1,this.submitStatsData(e)},submitStatsData:function(e){var t=document.querySelector("#phoneAreaCodeField"),n=document.querySelector("#phoneNumberField"),r=t&&t.value?t.value.trim():"000",i=n&&n.value?n.value.trim():"0000000";
this.debug(e,"contact phone: "+r+i);
var s={},o,u;
o="http-roundtrip-in-ms."+(this.httpRoundTripSucceeded?"succeeded":"failed"),s[o]=this.httpRoundTripInMs,o="http-optin-completed-in-ms."+(this.httpOptinSucceeded?"succeeded":"failed"),s[o]=this.httpOptinCompletedInMs,this.httpOptinSucceeded?s["signup-this-phone-completed-in-ms.succeeded"]=this.httpOptinCompletedInMs:(o="silent-sms-optin-completed-in-ms."+(this.silentSmsOptinSucceeded?"succeeded":"failed"),s[o]=this.silentSmsOptinCompletedInMs,o="signup-this-phone-completed-in-ms."+(this.silentSmsOptinSucceeded?"succeeded":"failed"),s[o]=this.httpOptinCompletedInMs+this.silentSmsOptinCompletedInMs);
var a={};
a["http-response"]=this.httpResponse,a["debug-log"]=this.log;
var f={url:this.statsUrl,method:"POST",timeout:this.pollTimeout,jsonParams:{prefix:"carm",sessionId:this.logSessionId,"stats.time":s,logs:a},successCallback:null,failureCallback:null,timeoutCallback:null};
iTSInclude.makeHttpRequest(f)},reset:function(){var e=this.attemptId++;
return this.smsRequestSent=!1,this.httpValidateCount=0,this.smsValidateCount=0,this.log=this.log.slice(-2e4)+"\n==============================================\n",this.tsLastDebug=Date.now(),e},debug:function(e,t){this.log+="\n+"+(Date.now()-this.tsLastDebug)+" ms => ("+e+") "+t,this.tsLastDebug=Date.now()},disableNavButtons:function(){this.nextButton&&this.nextButton.enabled&&(this.nextButton.enabled=!1)},enableNavButtons:function(){this.nextButton&&this.nextButton.enabled==0&&(this.nextButton.enabled=1,this.nextButton.action=this.nextButtonAction),this.backButton&&this.backButton.enabled==0&&(this.backButton.enabled=1,this.backButton.action=this.backButtonAction)},showError:function(e){var t=document.querySelector("p.error.carm");
t?t.innerText=e:(t=document.createElement("p"),t.classList.add("error"),t.classList.add("carm"),t.innerText=e,document.querySelector("#carm-container h2").insertAdjacentElement("afterEnd",t)),this.enableNavButtons()}}}),its.kit.createController("iTSCarrierBillingSMSEnterCode",{binding:"#carm-enter-code-page",component:{init:function(){this.ajaxFailMessage=its.loc("JS.MZCommerce.CarrierBilling.AjaxFailMessage"),iTunes&&iTunes.viewController?(this.nextButton=iTunes.viewController.toolbarItems[2]?iTunes.viewController.toolbarItems[2]:nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.rightItem,this.nextButtonAction=this.nextButton.action,this.nextButton.enabled=!1):typeof iTunes.viewController=="undefined"&&nativeiTunes&&nativeiTunes.viewController&&(this.useButtonAccessors=!0,this.nextButton=nativeiTunes.viewController.navigationController.navigationBar.topNavigationItem.rightItem,this.nextButtonAction=this.nextButton.action,this.nextButton.setEnabled(!1)),this.mincodelength=4,this.maxcodelength=4,this.resendLink=document.querySelector("#resend-code"),this.input=document.querySelector("#sms-code, #optField"),this.input&&(this.input.focus(),this.listen(this.input,"keyup",this.handleKeyPress.bind(this))),this.resendLink&&this.listen(this.resendLink,"touchstart",this.resendOtpLinkClick.bind(this)),this.countResendOtp=0,this.countValidateOtp=0,this.maxResendOtp=3,this.resendLink.innerText=its.loc("JS.MHCarrierBillingBuySmsVerification.SendingCode"),this.resendCodeDisabled=!0,this.sendCodeTimer=window.setTimeout(this.handleSendCodeState.bind(this),1e4)},handleSendCodeState:function(){this.resendCodeDisabled=!1,this.resendLink.innerText=its.loc("JS.MHCarrierBillingBuySmsVerification.SendSMSCodeAgain")},handleKeyPress:function(e){var t=this.input.value;
this.resendCodeDisabled&&this.handleSendCodeState(),this.input.value.length>=this.mincodelength?this.nextButton&&(this.useButtonAccessors?this.nextButton.setEnabled(1):this.nextButton.enabled=1):this.nextButton&&this.nextButton.enabled&&(this.useButtonAccessors?this.nextButton.setEnabled(!1):this.nextButton.enabled=!1)},okToResendOtp:function(){return!this.resendCodeDisabled&&this.countResendOtp<this.maxResendOtp},resendOtpLinkClick:function(e){if(!this.okToResendOtp()){this.showErrorMessage(its.loc("JS.MZCommerce.CarrierBilling.TooManyOTPResends")),this.showResendOtpLink(),e.preventDefault();
return}this.countResendOtp++;
var t=this.resendLink.getAttribute("resend-otp-url"),n={url:t,acceptStatus204:!0,method:"GET",successCallback:function(e){var t;
try{t=JSON.parse(e.responseText)}catch(n){t=null}var r=t?t.error:this.ajaxFailMessage;
r&&this.showErrorMessage(r)}.bind(this),failureCallback:function(e){this.showErrorMessage(this.ajaxFailMessage)}.bind(this),timeoutCallback:function(e){this.showErrorMessage(this.ajaxFailMessage)}.bind(this),timeout:5e3};
this.resendLink.innerText=its.loc("JS.MHCarrierBillingBuySmsVerification.SendingCode"),this.resendCodeDisabled=!0,this.sendCodeTimer=window.setTimeout(this.handleSendCodeState.bind(this),2e4),iTSInclude.makeHttpRequest(n)},showErrorMessage:function(e,t){if(iTunes){var n=iTunes.createDialog();
if(n&&typeof iTunes.viewController=="undefined"){n.setTitle(e),n.setBody(t);
var r=iTunes.createButton();
r.setTitle(its.loc("Ok")),r.setAction(null),n.setButtons(Array(r)),n.show()}else if(n){n.title=e,n.body=t;
var r=iTunes.createButton(its.loc("Ok"),null);
n.buttons=Array(r),n.show()}}this.handleSendCodeState().bind(this)}}}),Autoclear.prototype.configureBlock=function(e){var t=e.querySelectorAll("form");
for(var n=0;
n<t.length;
n++)this.configureForm(t[n]);
var r=e.querySelectorAll("input.autoclear");
for(var n=0;
n<r.length;
n++)this.configureField(r[n]);
e.nodeName=="INPUT"&&this.configureField(e)},Autoclear.prototype.configureForm=function(e){e.autoclear=function(){var e=this.querySelectorAll("input.autoclear.defaultValue");
for(var t=0;
t<e.length;
t++)e[t].autoclear()},e.unautoclear=function(){var e=this.querySelectorAll("input.autoclear");
for(var t=0;
t<e.length;
t++)e[t].unautoclear()},e.addEventListener("submit",e.autoclear,!1),e.captureEvents&&e.captureEvents(Event.SUBMIT)},Autoclear.prototype.configureField=function(e){e.autoclear=function(){return this.value==this.title&&(this.value="",this.autoclearedPasswordField&&(this.type="password"),this.className=this.className.replace(" defaultValue","")),!0},e.addEventListener("focus",e.autoclear,!1),e.captureEvents&&e.captureEvents(Event.FOCUS),e.unautoclear=function(){return this.value==""&&(this.type=="password"&&(this.autoclearedPasswordField=!0,this.type="text"),this.value=this.title,this.className.match("defaultValue")||(this.className+=" defaultValue")),!0},e.addEventListener("blur",e.unautoclear,!1),e.captureEvents&&e.captureEvents(Event.BLUR);
if(e.type=="password"||e.title.match(/username|login|email/i))e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off");
e.unautoclear()},window.addEventListener("load",function(){new Autoclear(document)},!0),its.kit.createController("iTSHSADevicePicker",{binding:"#selectDevicePage",component:{init:function(){iTunes&&iTunes.viewController&&iTunes.viewController.showsLibraryButton&&(iTunes.viewController.showsLibraryButton=!1),this.listen(this.element,"iTSOptionpicker.event.optionSelected","handleOptionSelection"),this.listen(window.document.forms[0],"submit","handleSubmit"),this.listen(window,"unload","handleUnload"),this.input=this.element.querySelector("#deviceInput"),this.leftNavItems=null,iTunes.viewController.showsLibraryButton=!1,defer(this,function(){if(iTunes&&iTunes.viewController&&iTunes.viewController.navigationItem){var e=iTunes.viewController.navigationItem;
iTunes.viewController.showsLibraryButton=!1,this.submitButton=e.rightItem,this.cancelButton=e.leftItem}},0)},handleOptionSelection:function(e){e&&e.value!=null&&(this.input.value=e.value)},handleSubmit:function(e){},handleUnload:function(e){}}}),its.kit.createController("iTSHSAEnterCode",{binding:"#enterCodePage",component:{init:function(){iTunes&&iTunes.viewController&&iTunes.viewController.showsLibraryButton&&(iTunes.viewController.showsLibraryButton=!1),this.maxcodelength=4,this.protectedchar=unescape("%u2022"),this.placeholderchar=unescape("%u2014"),this.passcodeRegion=this.element.querySelector("#passcode"),this.digits=this.element.querySelectorAll(".passcode-digit-field"),this.input=this.element.querySelector("#codeInput"),this.form=document.forms[0],this.listen(this.form,"submit","handleSubmit"),this.enableFormSubmit=!1,this.inlineError=this.element.querySelector("p.error"),this.hiddenButtons=this.form.querySelectorAll(".hidden-button input[type='submit']");
for(var e=0;
e<this.hiddenButtons.length;
e++)this.listen(this.hiddenButtons[e],"click","handleSubmit");
this.listen(this.input,"focus","handleInputFocus"),its.client.screenReaderRunning()&&(this.input.removeAttribute("aria-hidden"),this.input.setAttribute("type","text"),this.input.removeClassName("hidden-code"),this.input.addClassName("exposed"),this.input.setAttribute("tabindex","1"),this.input.setAttribute("aria-labelledby","fieldLabel"),this.passcodeRegion.setAttribute("aria-hidden","true"),this.passcodeRegion.setAttribute("style","display: none"),this.input.focus()),this.update();
for(var t=0;
t<this.digits.length;
t++)this.listen(this.digits[t],"touchstart","handleDigitFocus"),this.listen(this.digits[t],"click","handleDigitFocus");
this.listen(this.input,"keypress","handleKeyPress"),this.listen(this.input,"keydown","handleKeyPress"),this.listen(this.input,"keyup","handleKeyPress"),this.listen(this.input,"input","handleInput"),defer(this,function(){iTunes&&iTunes.viewController&&(iTunes.viewController.showsLibraryButton=!1,iTunes.viewController.shouldShowFormAccessory=!1),this.input.focus()}),this.listen(window,"unload","handleUnload")},update:function(){var e=this.input.value,t=e[0]||"",n=e[1]||"",r=e[2]||"",i=e[3]||"";
this.digit1||(this.digit1=this.digits[0].firstElementChild),this.digit2||(this.digit2=this.digits[1].firstElementChild),this.digit3||(this.digit3=this.digits[2].firstElementChild),this.digit4||(this.digit4=this.digits[3].firstElementChild),this.digit1.innerText=t,this.digit2.innerText=n,this.digit3.innerText=r,this.digit4.innerText=i},handleDigitFocus:function(e){document.activeElement!==this.input&&this.input.focus()},handleInputFocus:function(e){this.input.value.length>0&&(this.input.selectionStart=this.input.value.length,this.input.selectionEnd=this.input.value.length)},handleInput:function(e){this.emitsInputEvent=!0,this.update(),this.input.value.length==this.maxcodelength&&(console.log("calling submit code on input handler"),this.submitCode())},handleKeyPress:function(e){var t=e.keyCode?e.keyCode:e.charCode,n=/^\d+$/.test(String.fromCharCode(t));
e.type!=="keydown"&&(e.type==="keypress"?t!=8&&(t==13||!n)&&this.input.value.length!=4&&e.preventDefault():e.type==="keyup"&&(this.emitsInputEvent||(this.update(),this.input.value.length==this.maxcodelength&&this.submitCode())))},handleSubmit:function(e){e&&((!e.target||e.target.id!="hiddenSecondButtonId"&&e.target.id!="hiddenFirstButtonId")&&e.preventDefault(),!this.enableFormSubmit&&e.type==="submit"&&this.input.value.length==this.maxcodelength&&(console.log("submitting code from submit handler"),this.submitCode()))},handleUnload:function(e){return""},submitCode:function(e){e&&e.preventDefault();
if(this.input.value.length==this.maxcodelength&&!this.submitInProgress){var t=this,n={code:this.input.value,"response-content-type":"application/json"};
this.submitInProgress=!0,this.passcodeRegion.removeClassName("error");
var r=this.element.querySelector("#submitCodeLink").href,i={method:"post",url:r,successCallback:function(e){t.successHandler(e)},failureCallback:function(e){t.failureHandler(e)},timeoutCallback:function(e){t.failureHandler(e)},timeout:3e5,formParams:n};
iTSInclude.makeHttpRequest(i)}},successHandler:function(e){var t=e.responseText,n=null;
this.submitInProgress=!1;
if(t.indexOf("{")==0){if(typeof JSON!="undefined"&&typeof JSON.parse!="undefined")n=JSON.parse(t);
else{n={};
var r=t.indexOf("status");
n.status=r!=-1?t.substring(r+9,t.indexOf(",",r)):"";
var i=t.indexOf("errorM");
n.errorMessage=i!=-1?t.substring(i+16,t.indexOf(",",i)-1):"";
var s=t.indexOf("accountLocked");
n.accountLocked=s!=-1?t.substring(s+16,t.indexOf("}",s)):""}if(n!=null)if(n.status===!0||n.status=="true"){var o=n.accountLocked===!0||n.accountLocked=="true"?this.element.querySelector("#accountLocked"):this.element.querySelector("#finishVerification");
o&&(window.location.href=o.href)}else this.inlineError.innerHTML=n.errorMessage,this.passcodeRegion.addClassName("error"),this.input.value="",this.update()}else this.enableFormSubmit=!0,this.form.submit()},failureHandler:function(e){this.submitInProgress=!1,this.inlineError.innerHTML=its.loc("JS.FinanceJSON.GenericServerError"),this.passcodeRegion.addClassName("error")}}}),its.kit.onDomReady(function(){if(typeof FinanceUIIsModern!="undefined"&&FinanceUIIsModern===!0&&its.dv7.theme.app!==its.dv7.theme.packageName){var t=document.querySelectorAll("link");
if(t.length>0)for(var n=0;
n<t.length;
n++){var r=t[n].href.replace(its.dv7.theme.app,its.dv7.theme.packageName);
t[n].setAttribute("href",r)}}}),its.kit.createController("iTSAccountSettings",{binding:"#MXAccountSummary",component:{init:function(){this.iTunesPassButton=this.element.querySelector("#iTunesPassButtonLink"),this.iTunesPassButton&&iTunes.passbookLibrary&&(this.iTunesPassButtonLabel=this.element.querySelector("#iTunesPassButtonLabel"),this.iTunesPassButton.addEventListener("click",this,!1),this.updateiTunesPassButtonState(),iTunes.addEventListener("didreappear",bind(this,this.updateiTunesPassButtonState),!1)),this.iTunesDisconnectButton=this.element.querySelector("#iTunesDisconnectButton"),this.iTunesDisconnectButtonField=this.element.querySelector("#iTunesDisconnectButton div.field"),this.iTunesDisconnectButton&&this.iTunesDisconnectButton.addEventListener("click",bind(this,this.showDisconnectConfirmDialog),!1)},showDisconnectConfirmDialog:function(e){var t=its.loc("JS.DisconnectConfirm.Message"),n=its.loc("JS.DisconnectConfirm.Explanation"),r=iTunes.confirm(n,t,its.loc("OK"),its.loc("Cancel"));
if(!r)return e.preventDefault(),e.stopPropagation(),this.iTunesDisconnectButtonField.removeClassName("pressed"),!1},getExistingiTunesPass:function(){if(iTunes.primaryAccount!=null){var e=iTunes.primaryAccount.ITunesPassSerialNumber;
return iTunes.passbookLibrary.getPass("pass.com.apple.itunes.storecredit",e)}return null},viewiTunesPassbookPass:function(){var e=this.getExistingiTunesPass();
e&&iTunes.openURL(e.passURL)},addiTunesPassbookPass:function(){if(iTunes.viewController.addPassbookPassWithURL){var e=this.iTunesPassButton.getAttribute("info-link");
iTunes.viewController.addPassbookPassWithURL(e)}},handleEvent:function(e){switch(e.type){case"click":if(e.target.id=="iTunesPassButtonLabel"||e.target.id=="iTunesPassButtonLink"||e.target.id=="iTunesPassButton")return e.preventDefault(),e.stopPropagation(),this.iTunesPassButtonState==="viewpass"?(this.iTunesPassButtonState="disabled",this.viewiTunesPassbookPass()):this.iTunesPassButtonState==="addpass"&&(this.iTunesPassButtonState="disabled",this.addiTunesPassbookPass()),!1}},updateiTunesPassButtonState:function(){this.getExistingiTunesPass()?(this.iTunesPassButtonLabel.innerText=its.loc("JS.AccountSummary.Passbook.ViewPass"),this.iTunesPassButtonState="viewpass"):(this.iTunesPassButtonLabel.innerText=its.loc("JS.AccountSummary.Passbook.AddPass"),this.iTunesPassButtonState="addpass")}}}),its.kit.createController("iTSMatchRenewalSwitch",{binding:"#matchAutoRenewToggle",component:{init:function(){this.listen(this.element,"click","toggleClicked"),this.expiresOnText=its.loc("JS.expiresOn"),this.renewsOnText=its.loc("JS.renewsOn"),this.renewalTextElement=document.querySelector("#matchAutorenewLabel .renewalDate")},toggleClicked:function(e){e.preventDefault(),this.element.hasClassName("checked")?iTSInclude.makeHttpRequest({url:this.element.getAttribute("turnOffAutoRenewUrl"),timeout:6e4,successCallback:bind(this,this.turnOffRenewalSuccessHandler),failureCallback:bind(this,this.renewalFailureHandler)}):iTSInclude.makeHttpRequest({url:this.element.getAttribute("turnOnAutoRenewUrl"),timeout:6e4,successCallback:bind(this,this.turnOnRenewalSuccessHandler),failureCallback:bind(this,this.renewalFailureHandler)}),this.element.style.opacity=.5},turnOffRenewalSuccessHandler:function(e){var t=JSON.parse(e.responseText);
this.element.style.opacity=1,t.status==0&&t.autoRenewOn===!1?(this.element.removeClassName("checked"),this.renewalTextElement.innerText=this.expiresOnText):this.showError()},turnOnRenewalSuccessHandler:function(e){this.element.style.opacity=1;
var t=JSON.parse(e.responseText);
t.status==0&&t.autoRenewOn===!0?(this.element.addClassName("checked"),this.renewalTextElement.innerText=this.renewsOnText):this.showError()},renewalFailureHandler:function(e){this.element.style.opacity=1,this.showError()},showError:function(){its.client.alert(its.loc("JS.ExceptionThrown.Mobile_message"))}}}),its.kit.createController("iTSAccountNavigationButtons",{binding:"body#MXAccountSummary div.field.multi-cell.more-button",component:{init:function(){typeof iTunes!="undefined"&&typeof nativeiTunes.viewController!="undefined"&&this.listen(this.element,"click","disableNavigationButtons")},disableNavigationButtons:function(e){var t=nativeiTunes.viewController.navigationItem;
if(t){var n=t.leftItem;
n&&(n.action=null,n.enabled=!1);
var r=t.rightItem;
r&&(r.action=null,r.enabled=!1)}}}}),its.kit.createController("iTSEditBillingInfoCCNumber",{binding:".cup #creditCardNumberField, .buy-store-credit #creditCardNumberField"}),iTSEditBillingInfoCCNumber.prototype.init=function(){this.upcc=document.querySelector("div#UPCC"),this.visa=document.querySelector("div#VISA"),this.amex=document.querySelector("div#AMEX"),this.mast=document.querySelector("div#MAST"),this.peas=document.querySelector("div#PEAS"),this.ccNum=document.querySelector("input#creditCardNumberField"),this.selectedCardLogo=document.querySelector(".selected-card-logo"),this.phone=document.querySelector("div.field.phone"),this.phoneNumberField=document.querySelector("input#phoneNumberField"),this.expiration=document.querySelector("div.field.expiration"),this.cvn=document.querySelector("div.field.creditVerificationNumber"),this.mobilePhone=document.querySelector("div#mobile-title"),this.mobileInputs=document.querySelector("div#mobile-inputs"),this.mobileNumberField=document.querySelector("input#mobileNumberField"),this.optionPicker=document.querySelector(".option-picker.payment-type"),this.bankField=document.querySelector("#bankField"),this.card_type_id=document.querySelector("#card_type_id"),this.selectedCardType="",this.cupMessage=document.querySelector("#cup-message"),this.cupMobileMessage=document.querySelector("#cup-mobile-message");
if(this.optionPicker){this.options=this.optionPicker.querySelectorAll("div.option");
for(n=0;
n<this.options.length;
n++){var e=this.options[n];
e.subscriptionChangedListener=this.listen(e,"iTSOptionpicker.event.optionSelected","paymentMethodChangedEvent"),e.hasClassName("selected")&&(this.selectedCardType=e.id)}}this.element.hasClassName("cup-auto-detection-disabled")||this.element.addEventListener("input",bind(this,this.ccNumberClickHanlder),!1),this.update(this.selectedCardType,this.shouldShowCreditExpCvm(this.card_type_id),this.shouldShowCUPFields(this.card_type_id)),this.useClientKddrStd=!0,this.kddrStd=document.querySelector("#kddr-std"),this.kddrStd?(this.kddrStd=this.kddrStd.value.replace(/([0-9]):/g,'"$1":'),this.trie=JSON.parse(this.kddrStd),delete this.kddrStd):(this.getCardTypeUrl=document.querySelector("#getCardTypeUrl").value,this.useClientKddrStd=!1);
if(!this.selectedCardType&&this.optionPicker&&this.optionPicker.iTSOptionPicker&&this.optionPicker.iTSOptionPicker.unselectOption){var t=document.querySelectorAll("input[type=text].clearoncardchange, input[type=password].clearoncardchange");
for(var n=0;
n<t.length;
n++)t[n].removeClassName("clearoncardchange");
this.optionPicker.iTSOptionPicker.selectOption(this.upcc);
for(var n=0;
n<t.length;
n++)t[n].addClassName("clearoncardchange")}},iTSEditBillingInfoCCNumber.prototype.shouldShowCUPFields=function(e){return e&&(e.value==18||e.value==19)},iTSEditBillingInfoCCNumber.prototype.shouldShowCreditExpCvm=function(e){return!e||e.value!=19},iTSEditBillingInfoCCNumber.prototype.showCupFields=function(e){e?(this.mobileInputs.setAttribute("style","display: block;"),this.mobilePhone.setAttribute("style","display: block;"),this.setMobilePhoneRequired(!0),this.cupMessage&&this.cupMessage.setAttribute("style","display: block;"),this.cupMobileMessage&&this.cupMobileMessage.setAttribute("style","display: block;")):(this.mobileInputs.setAttribute("style","display: none;"),this.mobilePhone.setAttribute("style","display: none;"),this.setMobilePhoneRequired(!1),this.cupMessage&&this.cupMessage.setAttribute("style","display: none;"),this.cupMobileMessage&&this.cupMobileMessage.setAttribute("style","display: none;"))},iTSEditBillingInfoCCNumber.prototype.showCreditCardFields=function(e){e?(this.expiration.setAttribute("style","display: block;"),this.cvn&&this.cvn.setAttribute("style","display: -webkit-box;")):(this.expiration.setAttribute("style","display: none;"),this.cvn&&this.cvn.setAttribute("style","display: none;"))},iTSEditBillingInfoCCNumber.prototype.paymentMethodChangedEvent=function(e){var t=e.value==="UPCC";
this.update(e.value,!t,t),this.updateSelectedCardLogo()},iTSEditBillingInfoCCNumber.prototype.updateRequiredFields=function(e){if(!this.bankField)return;e==="PEAS"?this.bankField.hasClassName("required")||this.bankField.addClassName("required"):this.bankField.removeClassName("required")},iTSEditBillingInfoCCNumber.prototype.update=function(e,t,n){t?this.showCreditCardFields(!0):this.showCreditCardFields(!1),n?this.showCupFields(!0):this.showCupFields(!1),this.updateRequiredFields(e)},iTSEditBillingInfoCCNumber.prototype.setMobilePhoneRequired=function(e){e?(this.mobileNumberField.hasClassName("required")||this.mobileNumberField.addClassName("required"),this.phone&&this.phoneNumberField&&(this.phone.setAttribute("style","display: none;"),this.phoneNumberField.removeClassName("required"))):(this.mobileNumberField.removeClassName("required"),this.phone&&this.phoneNumberField&&(this.phone.setAttribute("style","display: -webkit-box;"),this.phoneNumberField.hasClassName("required")||this.phoneNumberField.addClassName("required")))},iTSEditBillingInfoCCNumber.prototype.selectPaymentMethod=function(e){e?this.optionPicker&&this.optionPicker.iTSOptionPicker&&this.optionPicker.iTSOptionPicker.selectOption&&(e.paymentWasAutoSelected=!0,this.optionPicker.iTSOptionPicker.selectOption(e),logoUrl=e.getAttribute("logo-url"),this.updateSelectedCardLogo(logoUrl,e.id)):(this.optionPicker&&this.optionPicker.iTSOptionPicker&&this.optionPicker.iTSOptionPicker.selectOption&&(this.upcc.paymentWasAutoSelected=!0,this.optionPicker.iTSOptionPicker.selectOption(this.upcc)),this.updateSelectedCardLogo())},iTSEditBillingInfoCCNumber.prototype.updateSelectedCardLogo=function(e,t){if(!this.selectedCardLogo)return;e?(this.selectedCardLogo.style.backgroundImage="url('"+e+"')",this.selectedCardLogo.className="selected-card-logo "+t):this.selectedCardLogo.style.backgroundImage="none"},iTSEditBillingInfoCCNumber.prototype.ccNumberClickHanlder=function(e){var t=this.ccNum.value+"";
if(!t||t=="")return;if(this.useClientKddrStd){if(this.trie){var n=this.findRange(t,this.trie);
if(n===0)this.selectPaymentMethod(this.upcc),this.update("UPCC",!1,!0),this.card_type_id.value=19;
else if(n===1)this.selectPaymentMethod(this.upcc),this.update("UPCC",!0,!0),this.card_type_id.value=18;
else if(t.indexOf("4")==0)this.selectPaymentMethod(this.visa),this.update("VISA",!0),this.card_type_id.value=1;
else if(t.indexOf("50")==0||t.indexOf("51")==0||t.indexOf("52")==0||t.indexOf("53")==0||t.indexOf("54")==0||t.indexOf("55")==0)this.selectPaymentMethod(this.mast),this.update("MAST",!0),this.card_type_id.value=4;
else if(t.indexOf("34")==0||t.indexOf("37")==0)this.selectPaymentMethod(this.amex),this.update("AMEX",!0),this.card_type_id.value=2;
else if(!t||t==""||n===-1)this.selectPaymentMethod(),this.update("",!1,!0),this.card_type_id.value=null}else if(!t||t=="")this.selectPaymentMethod(),this.update("",!1,!0)}else{if(t&&t.length>8&&t.length<12)return;if(t&&t.length<5)t.indexOf("4")==0?(this.selectPaymentMethod(this.visa),this.update("VISA",!0),this.card_type_id.value=1):t.indexOf("50")==0||t.indexOf("51")==0||t.indexOf("52")==0||t.indexOf("53")==0||t.indexOf("54")==0||t.indexOf("55")==0?(this.selectPaymentMethod(this.mast),this.update("MAST",!0),this.card_type_id.value=4):t.indexOf("34")==0||t.indexOf("37")==0?(this.selectPaymentMethod(this.amex),this.update("AMEX",!0),this.card_type_id.value=2):(this.selectPaymentMethod(this.upcc),this.update("UPCC",!0,!0),this.card_type_id.value=null);
else if(this.getCardTypeUrl){var r={};
r.ccNumber=t;
var i={url:this.getCardTypeUrl,method:"post",successCallback:function(e){var t=JSON.parse(e.responseText);
t.status===0?t.cardType&&(this.findResult=t.cardType,this.findResult==="19"?(this.selectPaymentMethod(this.upcc),this.update("UPCC",!1,!0),this.card_type_id.value=19):this.findResult==="18"?(this.selectPaymentMethod(this.upcc),this.update("UPCC",!0,!0),this.card_type_id.value=18):this.findResult==="1"?(this.selectPaymentMethod(this.visa),this.update("VISA",!0),this.card_type_id.value=1):this.findResult==="4"?(this.selectPaymentMethod(this.mast),this.update("MAST",!0),this.card_type_id.value=4):this.findResult==="2"?(this.selectPaymentMethod(this.amex),this.update("AMEX",!0),this.card_type_id.value=2):this.findResult==="0"&&(console.log("getCardTypeUrl: result is 0"),this.selectPaymentMethod(this.upcc),this.update("UPCC",!0,!0),this.card_type_id.value=null)):(console.log("getCardTypeUrl: status is not 0"),this.selectPaymentMethod(this.upcc),this.update("UPCC",!0,!0),this.card_type_id.value=null)}.bind(this),failureCallback:function(e){console.log("getCardTypeUrl: call failed."),this.selectPaymentMethod(this.upcc),this.update("UPCC",!0,!0),this.card_type_id.value=null}.bind(this),timeout:5e3,formParams:r};
iTSInclude.makeHttpRequest(i)}}},iTSEditBillingInfoCCNumber.prototype.findRange=function(e,t){if(!e||e.length===0)return-1;
var n=e.substring(0,1),r=t[n];
return typeof r=="number"?r:r===undefined?-1:this.findRange(e.slice(1),t[n])},its.kit.createController("iTSCarrierBillingSMSEnterCodePage",{binding:"#carm-buy-enter-code-page"}),iTSCarrierBillingSMSEnterCodePage.prototype.init=function(){iTunes.navigationBar.rightItem.enabled=!1,this.mincodelength=4,this.maxcodelength=4,this.resendLink=document.querySelector("#resend-code"),this.input=document.querySelector("#sms-code"),this.input&&(this.input.focus(),this.listen(this.input,"keyup","handleKeyPress")),this.resendLink&&(this.listen(this.resendLink,"click","resendClick"),afterOneMinute=!1,setTimeout(function(){afterOneMinute=!0},6e4))},iTSCarrierBillingSMSEnterCodePage.prototype.handleKeyPress=function(){var e=this.input.value;
this.input.value.length>=this.mincodelength?iTunes.navigationBar.rightItem.enabled=!0:this.submitButton.hasClassName("disabled")||(iTunes.navigationBar.rightItem.enabled=!1)},iTSCarrierBillingSMSEnterCodePage.prototype.resendClick=function(){if(!afterOneMinute){event.preventDefault();
var e=iTunes.createDialog();
e.title=its.loc("JS.DTHCCEditorCup.CodeAlreadySent_message"),e.body=its.loc("JS.DTHCCEditorCup.CodeAlreadySent_explanation");
var t=iTunes.createButton(its.loc("Ok"),null);
return e.buttons=Array(t),e.show(),!1}return!0},its.kit.createController("iTSK2FinanceOpenMail",{binding:"a.open-mail"}),iTSK2FinanceOpenMail.prototype.init=function(){this.element.addEventListener("click",this,!1)},iTSK2FinanceOpenMail.prototype.clickEvent=function(e){iTunes.openURL("message://234234")},its.kit.createController("iTSDeviceRedeem",{binding:"body.codeRedemption.entry",component:{init:function(){if(typeof iTunes!="undefined"&&typeof iTunes.navigationBar!="undefined"){this.redeemInput=this.element.querySelector("input#codeField"),this.redeemInput&&this.listen(this.redeemInput,"keyup","keyupEvent");
var e=iTunes.createButton(its.loc("MZFinance.RedeemButton"),this.redeemCode);
e.style="done",iTunes.navigationBar.rightItem=e;
if(typeof redeemPageShowCancelButton!="undefined"&&redeemPageShowCancelButton||iTunes.navigationBar.leftItem.title!==null&&iTunes.navigationBar.leftItem.action==null){var t=iTunes.createButton(its.loc("Cancel"),this.cancelRedeemCode);
iTunes.navigationBar.leftItem=t}this.setRedeemButtonState()}},redeemCode:function(){var e=document.getElementById("redeemButton"),t=document.createEvent("Event");
t.initEvent("click",!0,!0),e.dispatchEvent(t)},cancelRedeemCode:function(){its.client.dismissCurrentPage()},setRedeemButtonState:function(){var e=this.redeemInput.value;
if(e!==""&&e.length>0){if(iTunes.navigationBar.rightItem.enabled==0){var t=iTunes.createButton(its.loc("MZFinance.RedeemButton"),this.redeemCode);
t.style="done",iTunes.navigationBar.rightItem=t,iTunes.navigationBar.rightItem.enabled=!0}}else if(iTunes.navigationBar.rightItem.enabled==1){var t=iTunes.createButton(its.loc("MZFinance.RedeemButton"),this.redeemCode);
t.style="plain",iTunes.navigationBar.rightItem=t,iTunes.navigationBar.rightItem.enabled=!1}},keyupEvent:function(e){var t=event.keyCode?event.keyCode:event.charCode;
t!==13&&this.setRedeemButtonState()}}})
